INFO 05-30 10:38:46 [__init__.py:239] Automatically detected platform cuda.
config: {'data': {'tokenizer': None, 'train_files': '~/data/rlhf/gsm8k/train.parquet', 'val_files': '~/data/rlhf/gsm8k/test.parquet', 'prompt_key': 'prompt', 'reward_fn_key': 'data_source', 'max_prompt_length': None, 'max_response_length': None, 'train_batch_size': 128, 'val_batch_size': None, 'return_raw_input_ids': False, 'return_raw_chat': False, 'shuffle': True, 'filter_overlong_prompts': False, 'filter_overlong_prompts_workers': 1, 'truncation': 'error', 'image_key': 'images', 'video_key': 'videos', 'custom_cls': {'path': None, 'name': None}}, 'actor_rollout_ref': {'hybrid_engine': True, 'model': {'path': '${model_path}', 'external_lib': None, 'override_config': {}, 'enable_gradient_checkpointing': True, 'use_remove_padding': False, 'use_liger': False, 'lora_rank': '${lora.rank}', 'lora_alpha': '${lora.alpha}', 'target_modules': '${lora.target_modules}'}, 'actor': {'strategy': 'fsdp', 'ppo_mini_batch_size': '${ppo_mini_batch_size}', 'ppo_micro_batch_size': None, 'ppo_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'use_dynamic_bsz': False, 'ppo_max_token_len_per_gpu': 16384, 'grad_clip': 1.0, 'clip_ratio': 0.2, 'clip_ratio_low': 0.2, 'clip_ratio_high': 0.2, 'clip_ratio_c': 3.0, 'loss_agg_mode': 'token-mean', 'entropy_coeff': 0.001, 'use_kl_loss': True, 'use_torch_compile': True, 'kl_loss_coef': 0.001, 'kl_loss_type': 'kl', 'ppo_epochs': 1, 'shuffle': False, 'ulysses_sequence_parallel_size': 1, 'checkpoint': {'contents': ['model', 'optimizer', 'extra']}, 'optim': {'lr': 1e-06, 'lr_warmup_steps': -1, 'lr_warmup_steps_ratio': 0.0, 'min_lr_ratio': None, 'warmup_style': 'constant', 'total_training_steps': -1, 'weight_decay': 0.01, 'betas': [0.9, 0.999]}, 'fsdp_config': {'wrap_policy': {'min_num_params': 0}, 'param_offload': False, 'optimizer_offload': False, 'offload_policy': False, 'reshard_after_forward': True, 'fsdp_size': -1}, 'micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'use_ref': True, 'grpo_advantage_length_weight': '${grpo_advantage_length_weight}'}, 'ref': {'strategy': 'fsdp', 'fsdp_config': {'param_offload': False, 'reshard_after_forward': True, 'wrap_policy': {'min_num_params': 0}}, 'use_torch_compile': '${actor_rollout_ref.actor.use_torch_compile}', 'log_prob_micro_batch_size': None, 'log_prob_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'log_prob_use_dynamic_bsz': '${actor_rollout_ref.actor.use_dynamic_bsz}', 'log_prob_max_token_len_per_gpu': '${actor_rollout_ref.actor.ppo_max_token_len_per_gpu}', 'ulysses_sequence_parallel_size': '${actor_rollout_ref.actor.ulysses_sequence_parallel_size}'}, 'rollout': {'name': 'vllm', 'mode': 'sync', 'chat_scheduler': None, 'temperature': 1, 'top_k': -1, 'top_p': 1, 'use_fire_sampling': False, 'prompt_length': 1, 'response_length': 128, 'dtype': 'bfloat16', 'gpu_memory_utilization': 0.5, 'ignore_eos': False, 'enforce_eager': True, 'free_cache_engine': True, 'load_format': 'dummy_dtensor', 'tensor_model_parallel_size': 1, 'max_num_batched_tokens': 8192, 'max_model_len': 2048, 'max_num_seqs': 1024, 'log_prob_micro_batch_size': None, 'log_prob_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'log_prob_use_dynamic_bsz': '${actor_rollout_ref.actor.use_dynamic_bsz}', 'log_prob_max_token_len_per_gpu': '${actor_rollout_ref.actor.ppo_max_token_len_per_gpu}', 'disable_log_stats': True, 'enable_chunked_prefill': True, 'do_sample': True, 'n': 1, 'engine_kwargs': {'swap_space': None}, 'val_kwargs': {'top_k': -1, 'top_p': 1.0, 'temperature': 0.5, 'n': 1, 'do_sample': True}, 'multi_turn': {'enable': False, 'max_turns': None, 'tool_config_path': None, 'format': 'chatml'}, 'rollout_filter_ratio': 1, 'rollout_filter_type': 'std', 'tp_size_check': True}}, 'critic': {'rollout_n': '${actor_rollout_ref.rollout.n}', 'strategy': 'fsdp', 'optim': {'lr': 1e-05, 'lr_warmup_steps_ratio': 0.0, 'min_lr_ratio': None, 'warmup_style': 'constant', 'total_training_steps': -1, 'weight_decay': 0.01, 'betas': [0.9, 0.999]}, 'model': {'path': '${model_path}', 'tokenizer_path': '${actor_rollout_ref.model.path}', 'override_config': {}, 'external_lib': '${actor_rollout_ref.model.external_lib}', 'enable_gradient_checkpointing': True, 'use_remove_padding': False, 'fsdp_config': {'param_offload': False, 'optimizer_offload': False, 'offload_policy': False, 'reshard_after_forward': True, 'wrap_policy': {'min_num_params': 0}, 'fsdp_size': -1}, 'lora_rank': '${lora.rank}', 'lora_alpha': '${lora.alpha}', 'target_modules': '${lora.target_modules}'}, 'ppo_mini_batch_size': '${ppo_mini_batch_size}', 'ppo_micro_batch_size': None, 'ppo_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'forward_micro_batch_size': '${critic.ppo_micro_batch_size}', 'forward_micro_batch_size_per_gpu': '${critic.ppo_micro_batch_size_per_gpu}', 'use_dynamic_bsz': '${actor_rollout_ref.actor.use_dynamic_bsz}', 'ppo_max_token_len_per_gpu': 32768, 'forward_max_token_len_per_gpu': '${critic.ppo_max_token_len_per_gpu}', 'ulysses_sequence_parallel_size': 1, 'ppo_epochs': '${actor_rollout_ref.actor.ppo_epochs}', 'shuffle': '${actor_rollout_ref.actor.shuffle}', 'grad_clip': 1.0, 'cliprange_value': 0.5, 'checkpoint': {'contents': ['model', 'optimizer', 'extra']}}, 'reward_model': {'enable': False, 'strategy': 'fsdp', 'model': {'input_tokenizer': '${actor_rollout_ref.model.path}', 'path': '~/models/FsfairX-LLaMA3-RM-v0.1', 'external_lib': '${actor_rollout_ref.model.external_lib}', 'use_remove_padding': False, 'fsdp_config': {'wrap_policy': {'min_num_params': 0}, 'param_offload': False, 'reshard_after_forward': True, 'fsdp_size': -1}}, 'micro_batch_size': None, 'micro_batch_size_per_gpu': None, 'max_length': None, 'ulysses_sequence_parallel_size': 1, 'use_dynamic_bsz': '${critic.use_dynamic_bsz}', 'forward_max_token_len_per_gpu': '${critic.forward_max_token_len_per_gpu}', 'reward_manager': 'naive', 'launch_reward_fn_async': False}, 'custom_reward_function': {'path': None, 'name': 'compute_score'}, 'algorithm': {'gamma': 1.0, 'lam': 1.0, 'adv_estimator': 'grpo', 'norm_adv_by_std_in_grpo': True, 'use_kl_in_reward': False, 'kl_penalty': 'kl', 'kl_ctrl': {'type': 'fixed', 'kl_coef': 0.001, 'horizon': 10000, 'target_kl': 0.1}, 'high_level_gamma': 0.95, 'bi_level_gae': False}, 'trainer': {'balance_batch': True, 'total_epochs': 30, 'total_training_steps': 200, 'project_name': 'ragen_latest', 'experiment_name': 'bandit-grpo', 'logger': ['console', 'wandb'], 'log_val_generations': 0, 'rollout_data_dir': None, 'validation_data_dir': None, 'nnodes': 1, 'n_gpus_per_node': 1, 'save_freq': -1, 'resume_mode': 'auto', 'resume_from_path': None, 'val_before_train': True, 'test_freq': 10, 'critic_warmup': 0, 'default_hdfs_dir': None, 'del_local_ckpt_after_load': False, 'default_local_dir': 'checkpoints/${trainer.project_name}/${trainer.experiment_name}', 'max_actor_ckpt_to_keep': None, 'max_critic_ckpt_to_keep': None, 'ray_wait_register_center_timeout': 300, 'validation_steps': 1, 'generations_to_log_to_wandb': {'train': 128, 'val': 20}}, 'ray_init': {'num_cpus': None}, 'custom_envs': {'SimpleSokoban': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'dim_x': 6, 'dim_y': 6, 'num_boxes': 1, 'max_steps': 100}}, 'LargerSokoban': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'dim_x': 8, 'dim_y': 8, 'num_boxes': 2, 'max_steps': 100, 'search_depth': 10}}, 'SokobanDifferentGridVocab': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'search_depth': 30, 'dim_x': 6, 'dim_y': 6, 'num_boxes': 1, 'max_steps': 100, 'grid_lookup': {0: 'W', 1: '.', 2: 'G', 3: 'C', 4: 'B', 5: 'A', 6: '@'}, 'grid_vocab': {'W': 'wall', '.': 'empty', 'G': 'target', 'C': 'box on target', 'B': 'box', 'A': 'player', '@': 'player on target'}}}, 'VisualSimpleSokoban': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'dim_x': 6, 'dim_y': 6, 'num_boxes': 1, 'max_steps': 100, 'render_mode': 'rgb_array'}}, 'Countdown': {'env_type': 'countdown', 'max_actions_per_traj': 1, 'env_instruction': "You are solving the Countdown puzzle. You should use the num list to create an equation that equals the target. Example answer format: <think> To find an equation using [3, 5, 2] to get 4. Let's check 2 + 5 = 7, 7 - 3 = 4. So the answer is 2 + 5 - 3 = 4. </think><answer>2 + 5 - 3</answer>", 'max_tokens': 100, 'env_config': None}, 'Bandit': {'env_type': 'bandit', 'max_actions_per_traj': 1, 'env_instruction': '', 'max_tokens': 100, 'env_config': {'lo_arm_name': 'Phoenix', 'hi_arm_name': 'Dragon'}}, 'BanditTest': {'env_type': 'bandit', 'max_actions_per_traj': 1, 'env_instruction': '', 'max_tokens': 100, 'env_config': {'lo_arm_name': 'Trader', 'hi_arm_name': 'Librarian'}}, 'FrozenLake': {'env_type': 'frozen_lake', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the FrozenLake puzzle. Forbid the whole and go to the target. You may move to the unintended direction due to the slippery ice. Example answer format: <think>To forbid the hole and go to the target, I should go left then go up.</think><answer>Left || Up</answer>', 'max_tokens': 100, 'env_config': None}, 'MetamathQA': {'env_type': 'metamathqa', 'max_actions_per_traj': 1, 'env_instruction': 'You are solving Math problems. ', 'max_tokens': 100, 'env_config': None}, 'WebShop': {'env_type': 'webshop', 'max_actions_per_traj': 9, 'env_instruction': 'You are browsing an online shop. Based on the instruction, buy a product that close to the production description. You need to search, read the search results, pick a product, choose the size and color and buy. You should only choose action from the available actions list provided later.  Example process: I need a gingko light and 20x20 pillow cover that is hand painted. First search[gingko light 20x20 pillow cover hand painted], answer format: <answer>search[blanket with fleece throw]</answer>. Valid answer is search[<keywords>] or click[<clickable>].', 'max_tokens': 200, 'env_config': {'dataset': 'small'}}}, 'system': {'CUDA_VISIBLE_DEVICES': 1}, 'micro_batch_size_per_gpu': 1, 'ppo_mini_batch_size': 8, 'model_path': 'Qwen/Qwen2.5-0.5B-Instruct', 'enable_response_mask': True, 'grpo_advantage_length_weight': False, 'lora': {'rank': 0, 'alpha': 16, 'target_modules': 'all-linear'}, 'agent_proxy': {'max_turn': 1, 'action_sep': '||', 'max_actions_per_turn': 1, 'use_turn_scores': False, 'enable_think': True, 'reward_normalization': {'grouping': 'state', 'method': 'mean_std'}}, 'es_manager': {'format_penalty': -0.1, 'train': {'env_groups': 8, 'group_size': 16, 'env_configs': {'tags': ['Bandit'], 'n_groups': [8]}}, 'val': {'env_groups': 512, 'group_size': 1, 'env_configs': {'tags': ['Bandit', 'BanditTest'], 'n_groups': [256, 256]}}}, 'ctx_manager': {'generation': {'gen_config': {'response_length': '${actor_rollout_ref.rollout.response_length}', 'temperature': '${actor_rollout_ref.rollout.temperature}', 'top_p': '${actor_rollout_ref.rollout.top_p}', 'top_k': '${actor_rollout_ref.rollout.top_k}', 'kwargs': None}}}}
CUDA_VISIBLE_DEVICES: 1
[36m(TaskRunner pid=851128)[0m [DEBUG] using ref policy
[36m(TaskRunner pid=851128)[0m using dummy reward manager
[36m(TaskRunner pid=851128)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=851128)[0m Total training steps: 200
[36m(TaskRunner pid=851128)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=855040)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=855040)[0m   "architectures": [
[36m(WorkerDict pid=855040)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=855040)[0m   ],
[36m(WorkerDict pid=855040)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=855040)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=855040)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=855040)[0m   "hidden_size": 896,
[36m(WorkerDict pid=855040)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=855040)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=855040)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=855040)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=855040)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=855040)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=855040)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=855040)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=855040)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=855040)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=855040)[0m   "rope_scaling": null,
[36m(WorkerDict pid=855040)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=855040)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=855040)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=855040)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=855040)[0m   "transformers_version": "4.52.3",
[36m(WorkerDict pid=855040)[0m   "use_cache": true,
[36m(WorkerDict pid=855040)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=855040)[0m   "vocab_size": 151936
[36m(WorkerDict pid=855040)[0m }
[36m(WorkerDict pid=855040)[0m 
[36m(WorkerDict pid=855040)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=855040)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=855040)[0m wrap_policy: functools.partial(<function _or_policy at 0x7eed57682ca0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7eed57682b60>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=855040)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=855040)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=855040)[0m   "architectures": [
[36m(WorkerDict pid=855040)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=855040)[0m   ],
[36m(WorkerDict pid=855040)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=855040)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=855040)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=855040)[0m   "hidden_size": 896,
[36m(WorkerDict pid=855040)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=855040)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=855040)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=855040)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=855040)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=855040)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=855040)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=855040)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=855040)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=855040)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=855040)[0m   "rope_scaling": null,
[36m(WorkerDict pid=855040)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=855040)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=855040)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=855040)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=855040)[0m   "transformers_version": "4.52.3",
[36m(WorkerDict pid=855040)[0m   "use_cache": true,
[36m(WorkerDict pid=855040)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=855040)[0m   "vocab_size": 151936
[36m(WorkerDict pid=855040)[0m }
[36m(WorkerDict pid=855040)[0m 
[36m(WorkerDict pid=855040)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=855040)[0m wrap_policy: functools.partial(<function _or_policy at 0x7eed57682ca0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7eed57682b60>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=855040)[0m Total steps: 200, num_warmup_steps: 0
[36m(WorkerDict pid=855040)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=855040)[0m WARNING 05-30 10:39:17 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=855040)[0m WARNING 05-30 10:39:18 [utils.py:2321] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7eebc2eeb860>
[36m(WorkerDict pid=855040)[0m WARNING 05-30 10:39:18 [topk_topp_sampler.py:63] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
[36m(WorkerDict pid=855040)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 128, 'detokenize': False, 'temperature': 1, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(TaskRunner pid=851128)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=851128)[0m Checkpoint tracker file does not exist: %s /scr/jwiseman/RAGEN/checkpoints/ragen_latest/bandit-grpo/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=851128)[0m Training from scratch
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 2.838287353515625 seconds
[36m(TaskRunner pid=851128)[0m ("Initial validation metrics: {'val-env/Bandit/success': 0.08203125, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/num_actions': 0.82421875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/action_is_effective': 0.82421875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/action_is_valid': 0.82421875, 'val-env/BanditTest/success': "
[36m(TaskRunner pid=851128)[0m  "0.44140625, 'val-env/BanditTest/num_actions': 0.81640625, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/action_is_effective': 0.81640625, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/action_is_valid': 0.81640625, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/success': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/num_actions': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/action_is_effective': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/action_is_valid': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/success': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/num_actions': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/action_is_effective': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/action_is_valid': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/response_length': 67.9453125, 'val-core/unknown/reward/mean@512': "
[36m(TaskRunner pid=851128)[0m  "0.09257812556461431, 'val-aux/unknown/reward/std@512': 0.2312998127689849, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@2/mean': 0.20390000104159117, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@2/std': 0.31631438443837934, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@2/mean': 0.010000000104308128, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@2/std': 0.09979980064267782, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@4/mean': 0.2893000011369586, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@4/std': 0.37004798279351214, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@4/mean': -0.038700000576674935, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@4/std': 0.07383976003814952, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@8/mean': 0.43390000093728304, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@8/std': 0.4347652117799703, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@8/mean': -0.07660000114142895, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@8/std': 0.04745987849887465, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@16/mean': 0.6544000005722046, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@16/std': 0.4377221028981054, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@16/mean': -0.09410000140219926, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@16/std': 0.023983119420584093, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@32/mean': 0.8569000002369285, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@32/std': 0.3291084770122728, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@32/mean': -0.10000000149011612, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@32/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@64/mean': 0.9802000000327825, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@64/std': 0.13201499892924892, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@64/mean': -0.10000000149011612, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@64/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@128/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@128/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@128/mean': -0.10000000149011612, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@128/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@256/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@256/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@256/mean': -0.10000000149011612, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@256/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-core/unknown/reward/best@512/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@512/mean': -0.10000000149011612}")
[36m(TaskRunner pid=851128)[0m step:0 - val-env/Bandit/success:0.082 - val-env/Bandit/num_actions:0.824 - val-env/Bandit/action_is_effective:0.824 - val-env/Bandit/action_is_valid:0.824 - val-env/BanditTest/success:0.441 - val-env/BanditTest/num_actions:0.816 - val-env/BanditTest/action_is_effective:0.816 - val-env/BanditTest/action_is_valid:0.816 - val-env/Bandit/non-zero/success:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:67.945 - val-core/unknown/reward/mean@512:0.093 - val-aux/unknown/reward/std@512:0.231 - val-aux/unknown/reward/best@2/mean:0.204 - val-aux/unknown/reward/best@2/std:0.316 - val-aux/unknown/reward/worst@2/mean:0.010 - val-aux/unknown/reward/worst@2/std:0.100 - val-aux/unknown/reward/best@4/mean:0.289 - val-aux/unknown/reward/best@4/std:0.370 - val-aux/unknown/reward/worst@4/mean:-0.039 - val-aux/unknown/reward/worst@4/std:0.074 - val-aux/unknown/reward/best@8/mean:0.434 - val-aux/unknown/reward/best@8/std:0.435 - val-aux/unknown/reward/worst@8/mean:-0.077 - val-aux/unknown/reward/worst@8/std:0.047 - val-aux/unknown/reward/best@16/mean:0.654 - val-aux/unknown/reward/best@16/std:0.438 - val-aux/unknown/reward/worst@16/mean:-0.094 - val-aux/unknown/reward/worst@16/std:0.024 - val-aux/unknown/reward/best@32/mean:0.857 - val-aux/unknown/reward/best@32/std:0.329 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.980 - val-aux/unknown/reward/best@64/std:0.132 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:1 - train/Bandit/success:0.062 - train/Bandit/num_actions:0.453 - train/Bandit/action_is_effective:0.453 - train/Bandit/action_is_valid:0.453 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:79.836 - global_seqlen/min:36331.000 - global_seqlen/max:36331.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36331.000 - global_seqlen/balanced_max:36331.000 - global_seqlen/mean:36331.000 - actor/kl_loss:-0.001 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.711 - actor/grad_norm:29.576 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.148 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:3.500 - critic/score/min:-1.098 - critic/rewards/mean:0.000 - critic/rewards/max:3.500 - critic/rewards/min:-1.098 - critic/advantages/mean:-0.040 - critic/advantages/max:3.500 - critic/advantages/min:-1.098 - critic/returns/mean:-0.040 - critic/returns/max:3.500 - critic/returns/min:-1.098 - response_length/mean:283.758 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.109 - prompt_length/mean:0.078 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.078 - timing_s/gen:1.369 - timing_s/old_log_prob:5.275 - timing_s/ref:8.826 - timing_s/adv:0.007 - timing_s/update_actor:21.175 - timing_s/step:36.655 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.583 - perf/total_num_tokens:36331.000 - perf/time_per_step:36.655 - perf/throughput:991.170 - timing_s/total:36.656
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:2 - train/Bandit/success:0.078 - train/Bandit/num_actions:0.422 - train/Bandit/action_is_effective:0.422 - train/Bandit/action_is_valid:0.422 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:83.438 - global_seqlen/min:36792.000 - global_seqlen/max:36792.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36792.000 - global_seqlen/balanced_max:36792.000 - global_seqlen/mean:36792.000 - actor/kl_loss:0.038 - actor/kl_coef:0.001 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.040 - actor/ppo_kl:-0.016 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:1.753 - actor/grad_norm:14.970 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.261 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:1.837 - critic/score/min:-1.271 - critic/rewards/mean:-0.000 - critic/rewards/max:1.837 - critic/rewards/min:-1.271 - critic/advantages/mean:-0.026 - critic/advantages/max:1.837 - critic/advantages/min:-1.271 - critic/returns/mean:-0.026 - critic/returns/max:1.837 - critic/returns/min:-1.271 - response_length/mean:287.359 - response_length/max:338.000 - response_length/min:226.000 - response_length/clip_ratio:0.117 - prompt_length/mean:0.078 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.078 - timing_s/gen:1.556 - timing_s/old_log_prob:4.776 - timing_s/ref:7.220 - timing_s/adv:0.006 - timing_s/update_actor:20.980 - timing_s/step:34.542 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.196 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.570 - perf/total_num_tokens:36792.000 - perf/time_per_step:34.542 - perf/throughput:1065.153 - timing_s/total:71.201
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:3 - train/Bandit/success:0.156 - train/Bandit/num_actions:0.586 - train/Bandit/action_is_effective:0.586 - train/Bandit/action_is_valid:0.586 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:84.547 - global_seqlen/min:36934.000 - global_seqlen/max:36934.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36934.000 - global_seqlen/balanced_max:36934.000 - global_seqlen/mean:36934.000 - actor/kl_loss:0.125 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.034 - actor/ppo_kl:-0.005 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.716 - actor/grad_norm:16.086 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.310 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:2.483 - critic/score/min:-2.016 - critic/rewards/mean:0.000 - critic/rewards/max:2.483 - critic/rewards/min:-2.016 - critic/advantages/mean:-0.024 - critic/advantages/max:2.483 - critic/advantages/min:-2.016 - critic/returns/mean:-0.024 - critic/returns/max:2.483 - critic/returns/min:-2.016 - response_length/mean:288.500 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.117 - prompt_length/mean:0.047 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.047 - timing_s/gen:1.561 - timing_s/old_log_prob:4.823 - timing_s/ref:7.320 - timing_s/adv:0.003 - timing_s/update_actor:21.119 - timing_s/step:34.829 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.198 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.572 - perf/total_num_tokens:36934.000 - perf/time_per_step:34.829 - perf/throughput:1060.425 - timing_s/total:106.033
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:4 - train/Bandit/success:0.195 - train/Bandit/num_actions:0.695 - train/Bandit/action_is_effective:0.695 - train/Bandit/action_is_valid:0.695 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:78.320 - global_seqlen/min:36137.000 - global_seqlen/max:36137.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36137.000 - global_seqlen/balanced_max:36137.000 - global_seqlen/mean:36137.000 - actor/kl_loss:0.086 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.031 - actor/ppo_kl:-0.006 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.602 - actor/grad_norm:13.529 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.349 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:1.705 - critic/score/min:-2.562 - critic/rewards/mean:-0.000 - critic/rewards/max:1.705 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.032 - critic/advantages/max:1.705 - critic/advantages/min:-2.562 - critic/returns/mean:-0.032 - critic/returns/max:1.705 - critic/returns/min:-2.562 - response_length/mean:282.281 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.086 - prompt_length/mean:0.039 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.039 - timing_s/gen:1.580 - timing_s/old_log_prob:4.796 - timing_s/ref:7.323 - timing_s/adv:0.006 - timing_s/update_actor:21.053 - timing_s/step:34.763 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.203 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.583 - perf/total_num_tokens:36137.000 - perf/time_per_step:34.763 - perf/throughput:1039.519 - timing_s/total:140.799
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:5 - train/Bandit/success:0.266 - train/Bandit/num_actions:0.852 - train/Bandit/action_is_effective:0.852 - train/Bandit/action_is_valid:0.852 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:71.281 - global_seqlen/min:35236.000 - global_seqlen/max:35236.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35236.000 - global_seqlen/balanced_max:35236.000 - global_seqlen/mean:35236.000 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.037 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.506 - actor/grad_norm:7.678 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.339 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:1.650 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:1.650 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.018 - critic/advantages/max:1.650 - critic/advantages/min:-3.750 - critic/returns/mean:-0.018 - critic/returns/max:1.650 - critic/returns/min:-3.750 - response_length/mean:275.266 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.521 - timing_s/old_log_prob:4.841 - timing_s/ref:7.323 - timing_s/adv:0.006 - timing_s/update_actor:21.148 - timing_s/step:34.843 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.208 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.600 - perf/total_num_tokens:35236.000 - perf/time_per_step:34.843 - perf/throughput:1011.293 - timing_s/total:175.645
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:6 - train/Bandit/success:0.023 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:57.398 - global_seqlen/min:33459.000 - global_seqlen/max:33459.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33459.000 - global_seqlen/balanced_max:33459.000 - global_seqlen/mean:33459.000 - actor/kl_loss:0.560 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.056 - actor/ppo_kl:-0.037 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:1.306 - actor/grad_norm:12.001 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.383 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.026 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.026 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:261.383 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.732 - timing_s/old_log_prob:4.937 - timing_s/ref:7.309 - timing_s/adv:0.006 - timing_s/update_actor:21.200 - timing_s/step:35.188 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/ref:0.218 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.634 - perf/total_num_tokens:33459.000 - perf/time_per_step:35.188 - perf/throughput:950.863 - timing_s/total:210.836
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:7 - train/Bandit/success:0.141 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:55.750 - global_seqlen/min:33248.000 - global_seqlen/max:33248.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33248.000 - global_seqlen/balanced_max:33248.000 - global_seqlen/mean:33248.000 - actor/kl_loss:0.323 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.030 - actor/ppo_kl:-0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.269 - actor/grad_norm:28.842 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.421 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:2.562 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:2.562 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.000 - critic/advantages/max:2.562 - critic/advantages/min:-3.750 - critic/returns/mean:-0.000 - critic/returns/max:2.562 - critic/returns/min:-3.750 - response_length/mean:259.742 - response_length/max:330.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.374 - timing_s/old_log_prob:4.782 - timing_s/ref:7.316 - timing_s/adv:0.006 - timing_s/update_actor:20.924 - timing_s/step:34.405 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.220 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.629 - perf/total_num_tokens:33248.000 - perf/time_per_step:34.405 - perf/throughput:966.376 - timing_s/total:245.243
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:8 - train/Bandit/success:0.055 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:49.016 - global_seqlen/min:32386.000 - global_seqlen/max:32386.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32386.000 - global_seqlen/balanced_max:32386.000 - global_seqlen/mean:32386.000 - actor/kl_loss:0.661 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.023 - actor/ppo_kl:-0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.142 - actor/grad_norm:0.088 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.445 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.519 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.519 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.015 - critic/advantages/max:0.519 - critic/advantages/min:-3.750 - critic/returns/mean:-0.015 - critic/returns/max:0.519 - critic/returns/min:-3.750 - response_length/mean:253.008 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.438 - timing_s/old_log_prob:4.782 - timing_s/ref:7.306 - timing_s/adv:0.006 - timing_s/update_actor:20.931 - timing_s/step:34.467 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.226 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.646 - perf/total_num_tokens:32386.000 - perf/time_per_step:34.467 - perf/throughput:939.625 - timing_s/total:279.713
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:9 - train/Bandit/success:0.047 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:46.312 - global_seqlen/min:32040.000 - global_seqlen/max:32040.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32040.000 - global_seqlen/balanced_max:32040.000 - global_seqlen/mean:32040.000 - actor/kl_loss:0.102 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.012 - actor/ppo_kl:-0.009 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.067 - actor/grad_norm:0.100 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.455 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:3.598 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:3.598 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:3.598 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:3.598 - critic/returns/min:-3.750 - response_length/mean:250.305 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.430 - timing_s/old_log_prob:4.867 - timing_s/ref:7.304 - timing_s/adv:0.006 - timing_s/update_actor:21.093 - timing_s/step:34.704 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.658 - perf/total_num_tokens:32040.000 - perf/time_per_step:34.704 - perf/throughput:923.227 - timing_s/total:314.420
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.2198424339294434 seconds
[36m(TaskRunner pid=851128)[0m step:10 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.297 - global_seqlen/min:30246.000 - global_seqlen/max:30246.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30246.000 - global_seqlen/balanced_max:30246.000 - global_seqlen/mean:30246.000 - actor/kl_loss:0.189 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.015 - actor/ppo_kl:-0.031 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.800 - actor/grad_norm:23.701 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.507 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.609 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:18.252 - val-core/unknown/reward/mean@512:0.140 - val-aux/unknown/reward/std@512:0.240 - val-aux/unknown/reward/best@2/mean:0.204 - val-aux/unknown/reward/best@2/std:0.297 - val-aux/unknown/reward/worst@2/mean:0.065 - val-aux/unknown/reward/worst@2/std:0.088 - val-aux/unknown/reward/best@4/mean:0.328 - val-aux/unknown/reward/best@4/std:0.392 - val-aux/unknown/reward/worst@4/mean:0.035 - val-aux/unknown/reward/worst@4/std:0.048 - val-aux/unknown/reward/best@8/mean:0.489 - val-aux/unknown/reward/best@8/std:0.446 - val-aux/unknown/reward/worst@8/mean:0.012 - val-aux/unknown/reward/worst@8/std:0.032 - val-aux/unknown/reward/best@16/mean:0.715 - val-aux/unknown/reward/best@16/std:0.419 - val-aux/unknown/reward/worst@16/mean:0.001 - val-aux/unknown/reward/worst@16/std:0.012 - val-aux/unknown/reward/best@32/mean:0.901 - val-aux/unknown/reward/best@32/std:0.282 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.003 - val-aux/unknown/reward/best@64/mean:0.992 - val-aux/unknown/reward/best@64/std:0.085 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:-0.000 - critic/score/max:0.345 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.345 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.007 - critic/advantages/max:0.345 - critic/advantages/min:-3.750 - critic/returns/mean:-0.007 - critic/returns/max:0.345 - critic/returns/min:-3.750 - response_length/mean:236.289 - response_length/max:330.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.325 - timing_s/old_log_prob:4.783 - timing_s/ref:7.347 - timing_s/adv:0.007 - timing_s/update_actor:21.131 - timing_s/testing:1.532 - timing_s/step:36.127 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.699 - perf/total_num_tokens:30246.000 - perf/time_per_step:36.127 - perf/throughput:837.216 - timing_s/total:350.550
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:11 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.648 - global_seqlen/min:30035.000 - global_seqlen/max:30035.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30035.000 - global_seqlen/balanced_max:30035.000 - global_seqlen/mean:30035.000 - actor/kl_loss:0.451 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.059 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.822 - actor/grad_norm:0.105 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.508 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.016 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.016 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:234.641 - response_length/max:321.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.120 - timing_s/old_log_prob:4.751 - timing_s/ref:7.281 - timing_s/adv:0.006 - timing_s/update_actor:20.862 - timing_s/step:34.023 - timing_per_token_ms/gen:0.037 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.695 - perf/total_num_tokens:30035.000 - perf/time_per_step:34.023 - perf/throughput:882.791 - timing_s/total:384.574
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:12 - train/Bandit/success:0.031 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:26.680 - global_seqlen/min:29527.000 - global_seqlen/max:29527.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29527.000 - global_seqlen/balanced_max:29527.000 - global_seqlen/mean:29527.000 - actor/kl_loss:1.160 - actor/kl_coef:0.001 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.054 - actor/ppo_kl:-0.099 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.677 - actor/grad_norm:13.895 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.551 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.019 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.019 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:230.672 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.377 - timing_s/old_log_prob:4.826 - timing_s/ref:7.343 - timing_s/adv:0.006 - timing_s/update_actor:21.186 - timing_s/step:34.743 - timing_per_token_ms/gen:0.047 - timing_per_token_ms/ref:0.249 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.717 - perf/total_num_tokens:29527.000 - perf/time_per_step:34.743 - perf/throughput:849.878 - timing_s/total:419.320
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:13 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:26.812 - global_seqlen/min:29544.000 - global_seqlen/max:29544.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29544.000 - global_seqlen/balanced_max:29544.000 - global_seqlen/mean:29544.000 - actor/kl_loss:1.242 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.711 - actor/grad_norm:0.106 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.543 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.014 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.014 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:230.805 - response_length/max:336.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.331 - timing_s/old_log_prob:4.822 - timing_s/ref:7.315 - timing_s/adv:0.006 - timing_s/update_actor:21.011 - timing_s/step:34.488 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.711 - perf/total_num_tokens:29544.000 - perf/time_per_step:34.488 - perf/throughput:856.640 - timing_s/total:453.811
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:14 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:25.859 - global_seqlen/min:29422.000 - global_seqlen/max:29422.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29422.000 - global_seqlen/balanced_max:29422.000 - global_seqlen/mean:29422.000 - actor/kl_loss:0.361 - actor/kl_coef:0.001 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.018 - actor/ppo_kl:-0.079 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.803 - actor/grad_norm:0.098 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.550 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:229.852 - response_length/max:278.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.340 - timing_s/old_log_prob:4.762 - timing_s/ref:7.322 - timing_s/adv:0.006 - timing_s/update_actor:20.777 - timing_s/step:34.211 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.249 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.706 - perf/total_num_tokens:29422.000 - perf/time_per_step:34.211 - perf/throughput:860.020 - timing_s/total:488.025
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:15 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:26.070 - global_seqlen/min:29449.000 - global_seqlen/max:29449.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29449.000 - global_seqlen/balanced_max:29449.000 - global_seqlen/mean:29449.000 - actor/kl_loss:0.470 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.097 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.930 - actor/grad_norm:0.113 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.564 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:230.062 - response_length/max:282.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:0.991 - timing_s/old_log_prob:4.751 - timing_s/ref:7.276 - timing_s/adv:0.003 - timing_s/update_actor:20.896 - timing_s/step:33.921 - timing_per_token_ms/gen:0.034 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.710 - perf/total_num_tokens:29449.000 - perf/time_per_step:33.921 - perf/throughput:868.172 - timing_s/total:521.948
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:16 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.922 - global_seqlen/min:29814.000 - global_seqlen/max:29814.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29814.000 - global_seqlen/balanced_max:29814.000 - global_seqlen/mean:29814.000 - actor/kl_loss:1.210 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.010 - actor/ppo_kl:-0.018 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.928 - actor/grad_norm:0.126 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.596 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:232.914 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.352 - timing_s/old_log_prob:4.814 - timing_s/ref:7.330 - timing_s/adv:0.006 - timing_s/update_actor:20.910 - timing_s/step:34.417 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.701 - perf/total_num_tokens:29814.000 - perf/time_per_step:34.417 - perf/throughput:866.253 - timing_s/total:556.367
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:17 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:25.773 - global_seqlen/min:29411.000 - global_seqlen/max:29411.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29411.000 - global_seqlen/balanced_max:29411.000 - global_seqlen/mean:29411.000 - actor/kl_loss:0.890 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.134 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.947 - actor/grad_norm:0.161 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.640 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:229.766 - response_length/max:308.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.371 - timing_s/old_log_prob:4.813 - timing_s/ref:7.343 - timing_s/adv:0.006 - timing_s/update_actor:20.996 - timing_s/step:34.534 - timing_per_token_ms/gen:0.047 - timing_per_token_ms/ref:0.250 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.714 - perf/total_num_tokens:29411.000 - perf/time_per_step:34.534 - perf/throughput:851.659 - timing_s/total:590.904
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:18 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.680 - global_seqlen/min:30551.000 - global_seqlen/max:30551.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30551.000 - global_seqlen/balanced_max:30551.000 - global_seqlen/mean:30551.000 - actor/kl_loss:0.459 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.012 - actor/ppo_kl:-0.037 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.210 - actor/grad_norm:0.084 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.654 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.444 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.444 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.014 - critic/advantages/max:0.444 - critic/advantages/min:-3.750 - critic/returns/mean:-0.014 - critic/returns/max:0.444 - critic/returns/min:-3.750 - response_length/mean:238.672 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.436 - timing_s/old_log_prob:4.877 - timing_s/ref:7.341 - timing_s/adv:0.006 - timing_s/update_actor:21.310 - timing_s/step:34.974 - timing_per_token_ms/gen:0.047 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.698 - perf/total_num_tokens:30551.000 - perf/time_per_step:34.974 - perf/throughput:873.532 - timing_s/total:625.881
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:19 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.453 - global_seqlen/min:30522.000 - global_seqlen/max:30522.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30522.000 - global_seqlen/balanced_max:30522.000 - global_seqlen/mean:30522.000 - actor/kl_loss:0.419 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.039 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.408 - actor/grad_norm:0.071 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.664 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:238.445 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.415 - timing_s/old_log_prob:4.838 - timing_s/ref:7.319 - timing_s/adv:0.007 - timing_s/update_actor:21.427 - timing_s/step:35.010 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.702 - perf/total_num_tokens:30522.000 - perf/time_per_step:35.010 - perf/throughput:871.803 - timing_s/total:660.894
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.8907527923583984 seconds
[36m(TaskRunner pid=851128)[0m step:20 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.133 - global_seqlen/min:30353.000 - global_seqlen/max:30353.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30353.000 - global_seqlen/balanced_max:30353.000 - global_seqlen/mean:30353.000 - actor/kl_loss:0.276 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.029 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.499 - actor/grad_norm:0.081 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.673 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.762 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:22.971 - val-core/unknown/reward/mean@512:0.154 - val-aux/unknown/reward/std@512:0.273 - val-aux/unknown/reward/best@2/mean:0.250 - val-aux/unknown/reward/best@2/std:0.347 - val-aux/unknown/reward/worst@2/mean:0.059 - val-aux/unknown/reward/worst@2/std:0.098 - val-aux/unknown/reward/best@4/mean:0.380 - val-aux/unknown/reward/best@4/std:0.417 - val-aux/unknown/reward/worst@4/mean:0.026 - val-aux/unknown/reward/worst@4/std:0.044 - val-aux/unknown/reward/best@8/mean:0.564 - val-aux/unknown/reward/best@8/std:0.450 - val-aux/unknown/reward/worst@8/mean:0.006 - val-aux/unknown/reward/worst@8/std:0.024 - val-aux/unknown/reward/best@16/mean:0.797 - val-aux/unknown/reward/best@16/std:0.376 - val-aux/unknown/reward/worst@16/mean:0.001 - val-aux/unknown/reward/worst@16/std:0.009 - val-aux/unknown/reward/best@32/mean:0.956 - val-aux/unknown/reward/best@32/std:0.194 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.999 - val-aux/unknown/reward/best@64/std:0.028 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:237.125 - response_length/max:323.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.364 - timing_s/old_log_prob:4.858 - timing_s/ref:7.324 - timing_s/adv:0.003 - timing_s/update_actor:21.071 - timing_s/testing:2.235 - timing_s/step:36.858 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.694 - perf/total_num_tokens:30353.000 - perf/time_per_step:36.858 - perf/throughput:823.502 - timing_s/total:697.755
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:21 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:36.797 - global_seqlen/min:30822.000 - global_seqlen/max:30822.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30822.000 - global_seqlen/balanced_max:30822.000 - global_seqlen/mean:30822.000 - actor/kl_loss:0.228 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.013 - actor/ppo_kl:0.050 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.844 - actor/grad_norm:21.950 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.699 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.345 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.345 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.345 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.345 - critic/returns/min:-3.750 - response_length/mean:240.789 - response_length/max:338.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.250 - timing_s/old_log_prob:4.808 - timing_s/ref:7.408 - timing_s/adv:0.006 - timing_s/update_actor:21.159 - timing_s/step:34.635 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.686 - perf/total_num_tokens:30822.000 - perf/time_per_step:34.635 - perf/throughput:889.914 - timing_s/total:732.392
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:22 - train/Bandit/success:0.023 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.898 - global_seqlen/min:30067.000 - global_seqlen/max:30067.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30067.000 - global_seqlen/balanced_max:30067.000 - global_seqlen/mean:30067.000 - actor/kl_loss:0.497 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.014 - actor/ppo_kl:-0.005 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.728 - actor/grad_norm:42.466 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.698 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:3.664 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:3.664 - critic/rewards/min:-3.750 - critic/advantages/mean:0.003 - critic/advantages/max:3.664 - critic/advantages/min:-3.750 - critic/returns/mean:0.003 - critic/returns/max:3.664 - critic/returns/min:-3.750 - response_length/mean:234.891 - response_length/max:283.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.357 - timing_s/old_log_prob:4.723 - timing_s/ref:7.308 - timing_s/adv:0.006 - timing_s/update_actor:20.841 - timing_s/step:34.240 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.693 - perf/total_num_tokens:30067.000 - perf/time_per_step:34.240 - perf/throughput:878.120 - timing_s/total:766.635
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:23 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.219 - global_seqlen/min:30108.000 - global_seqlen/max:30108.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30108.000 - global_seqlen/balanced_max:30108.000 - global_seqlen/mean:30108.000 - actor/kl_loss:0.311 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.022 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.856 - actor/grad_norm:0.079 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.747 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:235.211 - response_length/max:281.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.011 - timing_s/old_log_prob:4.719 - timing_s/ref:7.314 - timing_s/adv:0.007 - timing_s/update_actor:20.908 - timing_s/step:33.962 - timing_per_token_ms/gen:0.034 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.694 - perf/total_num_tokens:30108.000 - perf/time_per_step:33.962 - perf/throughput:886.513 - timing_s/total:800.600
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:24 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.586 - global_seqlen/min:31051.000 - global_seqlen/max:31051.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31051.000 - global_seqlen/balanced_max:31051.000 - global_seqlen/mean:31051.000 - actor/kl_loss:0.497 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.016 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.314 - actor/grad_norm:5.698 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.752 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:242.578 - response_length/max:313.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.252 - timing_s/old_log_prob:4.764 - timing_s/ref:7.363 - timing_s/adv:0.006 - timing_s/update_actor:20.928 - timing_s/step:34.317 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.674 - perf/total_num_tokens:31051.000 - perf/time_per_step:34.317 - perf/throughput:904.817 - timing_s/total:834.920
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:25 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.875 - global_seqlen/min:30960.000 - global_seqlen/max:30960.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30960.000 - global_seqlen/balanced_max:30960.000 - global_seqlen/mean:30960.000 - actor/kl_loss:0.596 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.029 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.461 - actor/grad_norm:0.112 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.757 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:241.867 - response_length/max:337.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.380 - timing_s/old_log_prob:4.815 - timing_s/ref:7.288 - timing_s/adv:0.006 - timing_s/update_actor:21.108 - timing_s/step:34.601 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.235 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.682 - perf/total_num_tokens:30960.000 - perf/time_per_step:34.601 - perf/throughput:894.768 - timing_s/total:869.524
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:26 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.266 - global_seqlen/min:30882.000 - global_seqlen/max:30882.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30882.000 - global_seqlen/balanced_max:30882.000 - global_seqlen/mean:30882.000 - actor/kl_loss:0.620 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.024 - actor/ppo_kl:-0.015 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.666 - actor/grad_norm:0.087 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.782 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.345 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.345 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.021 - critic/advantages/max:0.345 - critic/advantages/min:-3.750 - critic/returns/mean:-0.021 - critic/returns/max:0.345 - critic/returns/min:-3.750 - response_length/mean:241.258 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.367 - timing_s/old_log_prob:4.954 - timing_s/ref:7.313 - timing_s/adv:0.007 - timing_s/update_actor:21.094 - timing_s/step:34.738 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.683 - perf/total_num_tokens:30882.000 - perf/time_per_step:34.738 - perf/throughput:888.995 - timing_s/total:904.265
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:27 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.367 - global_seqlen/min:30127.000 - global_seqlen/max:30127.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30127.000 - global_seqlen/balanced_max:30127.000 - global_seqlen/mean:30127.000 - actor/kl_loss:0.819 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.019 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.482 - actor/grad_norm:58.143 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.778 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:235.359 - response_length/max:336.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.355 - timing_s/old_log_prob:4.826 - timing_s/ref:7.312 - timing_s/adv:0.003 - timing_s/update_actor:21.521 - timing_s/step:35.020 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.714 - perf/total_num_tokens:30127.000 - perf/time_per_step:35.020 - perf/throughput:860.290 - timing_s/total:939.287
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:28 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.953 - train/Bandit/action_is_effective:0.953 - train/Bandit/action_is_valid:0.953 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.211 - global_seqlen/min:30235.000 - global_seqlen/max:30235.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30235.000 - global_seqlen/balanced_max:30235.000 - global_seqlen/mean:30235.000 - actor/kl_loss:0.683 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.064 - actor/ppo_kl:-0.039 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.747 - actor/grad_norm:0.077 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.792 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:236.203 - response_length/max:277.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:0.990 - timing_s/old_log_prob:4.790 - timing_s/ref:7.250 - timing_s/adv:0.003 - timing_s/update_actor:21.259 - timing_s/step:34.295 - timing_per_token_ms/gen:0.033 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.703 - perf/total_num_tokens:30235.000 - perf/time_per_step:34.295 - perf/throughput:881.611 - timing_s/total:973.586
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:29 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.305 - global_seqlen/min:29991.000 - global_seqlen/max:29991.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29991.000 - global_seqlen/balanced_max:29991.000 - global_seqlen/mean:29991.000 - actor/kl_loss:0.580 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.553 - actor/grad_norm:0.086 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.814 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:234.297 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.382 - timing_s/old_log_prob:4.865 - timing_s/ref:7.310 - timing_s/adv:0.006 - timing_s/update_actor:21.596 - timing_s/step:35.162 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.720 - perf/total_num_tokens:29991.000 - perf/time_per_step:35.162 - perf/throughput:852.930 - timing_s/total:1008.751
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.7785186767578125 seconds
[36m(TaskRunner pid=851128)[0m step:30 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.438 - global_seqlen/min:30008.000 - global_seqlen/max:30008.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30008.000 - global_seqlen/balanced_max:30008.000 - global_seqlen/mean:30008.000 - actor/kl_loss:0.745 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.009 - actor/ppo_kl:0.009 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.760 - actor/grad_norm:0.107 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.826 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.609 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:25.938 - val-core/unknown/reward/mean@512:0.148 - val-aux/unknown/reward/std@512:0.252 - val-aux/unknown/reward/best@2/mean:0.238 - val-aux/unknown/reward/best@2/std:0.331 - val-aux/unknown/reward/worst@2/mean:0.061 - val-aux/unknown/reward/worst@2/std:0.071 - val-aux/unknown/reward/best@4/mean:0.354 - val-aux/unknown/reward/best@4/std:0.405 - val-aux/unknown/reward/worst@4/mean:0.032 - val-aux/unknown/reward/worst@4/std:0.047 - val-aux/unknown/reward/best@8/mean:0.530 - val-aux/unknown/reward/best@8/std:0.450 - val-aux/unknown/reward/worst@8/mean:0.011 - val-aux/unknown/reward/worst@8/std:0.031 - val-aux/unknown/reward/best@16/mean:0.755 - val-aux/unknown/reward/best@16/std:0.400 - val-aux/unknown/reward/worst@16/mean:0.002 - val-aux/unknown/reward/worst@16/std:0.013 - val-aux/unknown/reward/best@32/mean:0.940 - val-aux/unknown/reward/best@32/std:0.225 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.995 - val-aux/unknown/reward/best@64/std:0.070 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.332 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.332 - critic/advantages/mean:-0.021 - critic/advantages/max:0.366 - critic/advantages/min:-3.332 - critic/returns/mean:-0.021 - critic/returns/max:0.366 - critic/returns/min:-3.332 - response_length/mean:234.422 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.357 - timing_s/old_log_prob:4.808 - timing_s/ref:7.316 - timing_s/adv:0.004 - timing_s/update_actor:21.300 - timing_s/testing:2.096 - timing_s/step:36.884 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.710 - perf/total_num_tokens:30008.000 - perf/time_per_step:36.884 - perf/throughput:813.571 - timing_s/total:1045.637
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:31 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:26.898 - global_seqlen/min:29555.000 - global_seqlen/max:29555.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29555.000 - global_seqlen/balanced_max:29555.000 - global_seqlen/mean:29555.000 - actor/kl_loss:0.769 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.006 - actor/ppo_kl:0.097 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:2.986 - actor/grad_norm:0.117 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.816 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:230.891 - response_length/max:276.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:0.839 - timing_s/old_log_prob:4.703 - timing_s/ref:7.312 - timing_s/adv:0.003 - timing_s/update_actor:20.306 - timing_s/step:33.165 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.687 - perf/total_num_tokens:29555.000 - perf/time_per_step:33.165 - perf/throughput:891.147 - timing_s/total:1078.805
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:32 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.164 - global_seqlen/min:29717.000 - global_seqlen/max:29717.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29717.000 - global_seqlen/balanced_max:29717.000 - global_seqlen/mean:29717.000 - actor/kl_loss:-0.000 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.283 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:3.546 - actor/grad_norm:0.146 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.858 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:232.156 - response_length/max:292.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.371 - timing_s/old_log_prob:4.732 - timing_s/ref:7.307 - timing_s/adv:0.005 - timing_s/update_actor:20.817 - timing_s/step:34.236 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.700 - perf/total_num_tokens:29717.000 - perf/time_per_step:34.236 - perf/throughput:868.012 - timing_s/total:1113.043
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:33 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.672 - global_seqlen/min:30422.000 - global_seqlen/max:30422.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30422.000 - global_seqlen/balanced_max:30422.000 - global_seqlen/mean:30422.000 - actor/kl_loss:-0.171 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.041 - actor/ppo_kl:0.267 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.385 - actor/grad_norm:0.123 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.839 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.022 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.022 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:237.664 - response_length/max:340.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.362 - timing_s/old_log_prob:4.837 - timing_s/ref:7.319 - timing_s/adv:0.006 - timing_s/update_actor:21.075 - timing_s/step:34.602 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.693 - perf/total_num_tokens:30422.000 - perf/time_per_step:34.602 - perf/throughput:879.198 - timing_s/total:1147.648
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:34 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.398 - global_seqlen/min:31027.000 - global_seqlen/max:31027.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31027.000 - global_seqlen/balanced_max:31027.000 - global_seqlen/mean:31027.000 - actor/kl_loss:0.220 - actor/kl_coef:0.001 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.105 - actor/ppo_kl:-0.019 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.534 - actor/grad_norm:34.666 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.867 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.039 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.039 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:242.391 - response_length/max:339.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.418 - timing_s/old_log_prob:4.849 - timing_s/ref:7.322 - timing_s/adv:0.006 - timing_s/update_actor:20.313 - timing_s/step:33.914 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.655 - perf/total_num_tokens:31027.000 - perf/time_per_step:33.914 - perf/throughput:914.880 - timing_s/total:1181.565
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:35 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:36.758 - global_seqlen/min:30817.000 - global_seqlen/max:30817.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30817.000 - global_seqlen/balanced_max:30817.000 - global_seqlen/mean:30817.000 - actor/kl_loss:-0.273 - actor/kl_coef:0.001 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.036 - actor/ppo_kl:-0.086 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:4.562 - actor/grad_norm:0.111 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.875 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:240.750 - response_length/max:337.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.369 - timing_s/old_log_prob:4.823 - timing_s/ref:7.262 - timing_s/adv:0.006 - timing_s/update_actor:20.533 - timing_s/step:33.996 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.666 - perf/total_num_tokens:30817.000 - perf/time_per_step:33.996 - perf/throughput:906.496 - timing_s/total:1215.563
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:36 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.031 - global_seqlen/min:30212.000 - global_seqlen/max:30212.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30212.000 - global_seqlen/balanced_max:30212.000 - global_seqlen/mean:30212.000 - actor/kl_loss:0.021 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.014 - actor/ppo_kl:0.017 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.588 - actor/grad_norm:0.119 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.885 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.002 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.002 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:236.023 - response_length/max:289.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.085 - timing_s/old_log_prob:4.742 - timing_s/ref:7.324 - timing_s/adv:0.006 - timing_s/update_actor:20.901 - timing_s/step:34.061 - timing_per_token_ms/gen:0.036 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.692 - perf/total_num_tokens:30212.000 - perf/time_per_step:34.061 - perf/throughput:887.003 - timing_s/total:1249.627
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:37 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.938 - train/Bandit/action_is_effective:0.938 - train/Bandit/action_is_valid:0.938 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.695 - global_seqlen/min:30937.000 - global_seqlen/max:30937.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30937.000 - global_seqlen/balanced_max:30937.000 - global_seqlen/mean:30937.000 - actor/kl_loss:0.368 - actor/kl_coef:0.001 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.082 - actor/ppo_kl:-0.135 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:4.724 - actor/grad_norm:0.107 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.907 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.056 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.056 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:241.688 - response_length/max:343.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.340 - timing_s/old_log_prob:4.848 - timing_s/ref:7.357 - timing_s/adv:0.003 - timing_s/update_actor:21.588 - timing_s/step:35.140 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.238 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.698 - perf/total_num_tokens:30937.000 - perf/time_per_step:35.140 - perf/throughput:880.391 - timing_s/total:1284.769
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:38 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.883 - global_seqlen/min:30065.000 - global_seqlen/max:30065.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30065.000 - global_seqlen/balanced_max:30065.000 - global_seqlen/mean:30065.000 - actor/kl_loss:-0.395 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.012 - actor/ppo_kl:0.188 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.548 - actor/grad_norm:0.118 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.904 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.003 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.003 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:234.875 - response_length/max:320.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.346 - timing_s/old_log_prob:4.834 - timing_s/ref:7.335 - timing_s/adv:0.006 - timing_s/update_actor:20.721 - timing_s/step:34.246 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.689 - perf/total_num_tokens:30065.000 - perf/time_per_step:34.246 - perf/throughput:877.904 - timing_s/total:1319.017
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:39 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.930 - train/Bandit/action_is_effective:0.930 - train/Bandit/action_is_valid:0.930 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.047 - global_seqlen/min:30214.000 - global_seqlen/max:30214.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30214.000 - global_seqlen/balanced_max:30214.000 - global_seqlen/mean:30214.000 - actor/kl_loss:0.248 - actor/kl_coef:0.001 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.082 - actor/ppo_kl:-0.035 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.938 - actor/grad_norm:21.019 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.923 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.017 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.017 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:236.039 - response_length/max:339.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.356 - timing_s/old_log_prob:5.048 - timing_s/ref:7.307 - timing_s/adv:0.006 - timing_s/update_actor:21.112 - timing_s/step:34.834 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.699 - perf/total_num_tokens:30214.000 - perf/time_per_step:34.834 - perf/throughput:867.383 - timing_s/total:1353.854
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.6854586601257324 seconds
[36m(TaskRunner pid=851128)[0m step:40 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.242 - global_seqlen/min:30111.000 - global_seqlen/max:30111.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30111.000 - global_seqlen/balanced_max:30111.000 - global_seqlen/mean:30111.000 - actor/kl_loss:0.551 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.027 - actor/ppo_kl:-0.285 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.674 - actor/grad_norm:0.144 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.918 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.996 - val-env/Bandit/action_is_effective:0.996 - val-env/Bandit/action_is_valid:0.996 - val-env/BanditTest/success:0.590 - val-env/BanditTest/num_actions:0.996 - val-env/BanditTest/action_is_effective:0.996 - val-env/BanditTest/action_is_valid:0.996 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:18.596 - val-core/unknown/reward/mean@512:0.150 - val-aux/unknown/reward/std@512:0.254 - val-aux/unknown/reward/best@2/mean:0.235 - val-aux/unknown/reward/best@2/std:0.329 - val-aux/unknown/reward/worst@2/mean:0.067 - val-aux/unknown/reward/worst@2/std:0.094 - val-aux/unknown/reward/best@4/mean:0.341 - val-aux/unknown/reward/best@4/std:0.399 - val-aux/unknown/reward/worst@4/mean:0.034 - val-aux/unknown/reward/worst@4/std:0.051 - val-aux/unknown/reward/best@8/mean:0.509 - val-aux/unknown/reward/best@8/std:0.448 - val-aux/unknown/reward/worst@8/mean:0.009 - val-aux/unknown/reward/worst@8/std:0.040 - val-aux/unknown/reward/best@16/mean:0.749 - val-aux/unknown/reward/best@16/std:0.404 - val-aux/unknown/reward/worst@16/mean:-0.007 - val-aux/unknown/reward/worst@16/std:0.029 - val-aux/unknown/reward/best@32/mean:0.933 - val-aux/unknown/reward/best@32/std:0.237 - val-aux/unknown/reward/worst@32/mean:-0.013 - val-aux/unknown/reward/worst@32/std:0.034 - val-aux/unknown/reward/best@64/mean:0.997 - val-aux/unknown/reward/best@64/std:0.049 - val-aux/unknown/reward/worst@64/mean:-0.023 - val-aux/unknown/reward/worst@64/std:0.042 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.040 - val-aux/unknown/reward/worst@128/std:0.049 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.064 - val-aux/unknown/reward/worst@256/std:0.048 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:235.234 - response_length/max:302.000 - response_length/min:220.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.373 - timing_s/old_log_prob:4.710 - timing_s/ref:7.316 - timing_s/adv:0.006 - timing_s/update_actor:20.871 - timing_s/testing:2.019 - timing_s/step:36.298 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.693 - perf/total_num_tokens:30111.000 - perf/time_per_step:36.298 - perf/throughput:829.548 - timing_s/total:1390.154
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:41 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.789 - global_seqlen/min:29669.000 - global_seqlen/max:29669.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29669.000 - global_seqlen/balanced_max:29669.000 - global_seqlen/mean:29669.000 - actor/kl_loss:0.723 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.022 - actor/ppo_kl:0.232 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:4.931 - actor/grad_norm:0.095 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.933 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:231.781 - response_length/max:319.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.239 - timing_s/old_log_prob:4.795 - timing_s/ref:7.348 - timing_s/adv:0.006 - timing_s/update_actor:21.093 - timing_s/step:34.484 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.711 - perf/total_num_tokens:29669.000 - perf/time_per_step:34.484 - perf/throughput:860.369 - timing_s/total:1424.640
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:42 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.844 - global_seqlen/min:30572.000 - global_seqlen/max:30572.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30572.000 - global_seqlen/balanced_max:30572.000 - global_seqlen/mean:30572.000 - actor/kl_loss:0.066 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.041 - actor/ppo_kl:-0.019 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:5.443 - actor/grad_norm:19.007 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.957 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.036 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.036 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:238.836 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.594 - timing_s/old_log_prob:4.820 - timing_s/ref:7.271 - timing_s/adv:0.006 - timing_s/update_actor:21.036 - timing_s/step:34.730 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/ref:0.238 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.688 - perf/total_num_tokens:30572.000 - perf/time_per_step:34.730 - perf/throughput:880.267 - timing_s/total:1459.374
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:43 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.484 - global_seqlen/min:30910.000 - global_seqlen/max:30910.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30910.000 - global_seqlen/balanced_max:30910.000 - global_seqlen/mean:30910.000 - actor/kl_loss:0.592 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.068 - actor/ppo_kl:-0.087 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:5.655 - actor/grad_norm:0.094 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.952 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.044 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.044 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:241.469 - response_length/max:341.000 - response_length/min:221.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.375 - timing_s/old_log_prob:4.842 - timing_s/ref:7.354 - timing_s/adv:0.003 - timing_s/update_actor:21.175 - timing_s/step:34.752 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.238 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.685 - perf/total_num_tokens:30910.000 - perf/time_per_step:34.752 - perf/throughput:889.433 - timing_s/total:1494.129
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:44 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.227 - global_seqlen/min:30109.000 - global_seqlen/max:30109.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30109.000 - global_seqlen/balanced_max:30109.000 - global_seqlen/mean:30109.000 - actor/kl_loss:0.445 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.014 - actor/ppo_kl:0.097 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:5.526 - actor/grad_norm:5.856 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.943 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:235.219 - response_length/max:320.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.493 - timing_s/old_log_prob:4.818 - timing_s/ref:7.311 - timing_s/adv:0.003 - timing_s/update_actor:21.002 - timing_s/step:34.629 - timing_per_token_ms/gen:0.050 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.698 - perf/total_num_tokens:30109.000 - perf/time_per_step:34.629 - perf/throughput:869.462 - timing_s/total:1528.761
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:45 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:41.383 - global_seqlen/min:31409.000 - global_seqlen/max:31409.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31409.000 - global_seqlen/balanced_max:31409.000 - global_seqlen/mean:31409.000 - actor/kl_loss:0.308 - actor/kl_coef:0.001 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.093 - actor/ppo_kl:-0.020 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.061 - actor/grad_norm:17.126 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.973 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.038 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.038 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:245.367 - response_length/max:342.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.409 - timing_s/old_log_prob:4.826 - timing_s/ref:7.308 - timing_s/adv:0.006 - timing_s/update_actor:21.080 - timing_s/step:34.634 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.671 - perf/total_num_tokens:31409.000 - perf/time_per_step:34.634 - perf/throughput:906.889 - timing_s/total:1563.398
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:46 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.531 - global_seqlen/min:30660.000 - global_seqlen/max:30660.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30660.000 - global_seqlen/balanced_max:30660.000 - global_seqlen/mean:30660.000 - actor/kl_loss:0.859 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.055 - actor/ppo_kl:-0.046 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:5.872 - actor/grad_norm:18.091 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:404.994 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.024 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.024 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:239.523 - response_length/max:343.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.394 - timing_s/old_log_prob:4.876 - timing_s/ref:7.273 - timing_s/adv:0.006 - timing_s/update_actor:21.063 - timing_s/step:34.615 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.687 - perf/total_num_tokens:30660.000 - perf/time_per_step:34.615 - perf/throughput:885.744 - timing_s/total:1598.015
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:47 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.375 - global_seqlen/min:31024.000 - global_seqlen/max:31024.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31024.000 - global_seqlen/balanced_max:31024.000 - global_seqlen/mean:31024.000 - actor/kl_loss:0.849 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.031 - actor/ppo_kl:-0.087 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:5.938 - actor/grad_norm:0.089 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.004 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.026 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.026 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:242.367 - response_length/max:352.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.400 - timing_s/old_log_prob:4.853 - timing_s/ref:7.323 - timing_s/adv:0.006 - timing_s/update_actor:21.170 - timing_s/step:34.756 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.682 - perf/total_num_tokens:31024.000 - perf/time_per_step:34.756 - perf/throughput:892.620 - timing_s/total:1632.774
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:48 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.367 - global_seqlen/min:30895.000 - global_seqlen/max:30895.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30895.000 - global_seqlen/balanced_max:30895.000 - global_seqlen/mean:30895.000 - actor/kl_loss:1.121 - actor/kl_coef:0.001 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.088 - actor/ppo_kl:0.051 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.186 - actor/grad_norm:4.427 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.032 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.040 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.040 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:241.359 - response_length/max:340.000 - response_length/min:220.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.352 - timing_s/old_log_prob:4.841 - timing_s/ref:7.348 - timing_s/adv:0.006 - timing_s/update_actor:21.109 - timing_s/step:34.659 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.238 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.683 - perf/total_num_tokens:30895.000 - perf/time_per_step:34.659 - perf/throughput:891.389 - timing_s/total:1667.436
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:49 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.352 - global_seqlen/min:31021.000 - global_seqlen/max:31021.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31021.000 - global_seqlen/balanced_max:31021.000 - global_seqlen/mean:31021.000 - actor/kl_loss:0.860 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.021 - actor/ppo_kl:-0.026 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.011 - actor/grad_norm:0.081 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.009 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:242.344 - response_length/max:341.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.389 - timing_s/old_log_prob:4.855 - timing_s/ref:7.319 - timing_s/adv:0.003 - timing_s/update_actor:20.584 - timing_s/step:34.153 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.664 - perf/total_num_tokens:31021.000 - perf/time_per_step:34.153 - perf/throughput:908.301 - timing_s/total:1701.592
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.7912757396697998 seconds
[36m(TaskRunner pid=851128)[0m step:50 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:39.180 - global_seqlen/min:31127.000 - global_seqlen/max:31127.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31127.000 - global_seqlen/balanced_max:31127.000 - global_seqlen/mean:31127.000 - actor/kl_loss:1.200 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.049 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.247 - actor/grad_norm:0.075 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.039 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.996 - val-env/Bandit/action_is_effective:0.996 - val-env/Bandit/action_is_valid:0.996 - val-env/BanditTest/success:0.328 - val-env/BanditTest/num_actions:0.992 - val-env/BanditTest/action_is_effective:0.992 - val-env/BanditTest/action_is_valid:0.992 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:19.191 - val-core/unknown/reward/mean@512:0.131 - val-aux/unknown/reward/std@512:0.200 - val-aux/unknown/reward/best@2/mean:0.177 - val-aux/unknown/reward/best@2/std:0.256 - val-aux/unknown/reward/worst@2/mean:0.081 - val-aux/unknown/reward/worst@2/std:0.068 - val-aux/unknown/reward/best@4/mean:0.255 - val-aux/unknown/reward/best@4/std:0.340 - val-aux/unknown/reward/worst@4/mean:0.058 - val-aux/unknown/reward/worst@4/std:0.055 - val-aux/unknown/reward/best@8/mean:0.389 - val-aux/unknown/reward/best@8/std:0.420 - val-aux/unknown/reward/worst@8/mean:0.031 - val-aux/unknown/reward/worst@8/std:0.057 - val-aux/unknown/reward/best@16/mean:0.588 - val-aux/unknown/reward/best@16/std:0.448 - val-aux/unknown/reward/worst@16/mean:0.005 - val-aux/unknown/reward/worst@16/std:0.048 - val-aux/unknown/reward/best@32/mean:0.807 - val-aux/unknown/reward/best@32/std:0.369 - val-aux/unknown/reward/worst@32/mean:-0.015 - val-aux/unknown/reward/worst@32/std:0.039 - val-aux/unknown/reward/best@64/mean:0.969 - val-aux/unknown/reward/best@64/std:0.165 - val-aux/unknown/reward/worst@64/mean:-0.032 - val-aux/unknown/reward/worst@64/std:0.047 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.053 - val-aux/unknown/reward/worst@128/std:0.050 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.079 - val-aux/unknown/reward/worst@256/std:0.041 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:243.172 - response_length/max:333.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.371 - timing_s/old_log_prob:4.872 - timing_s/ref:7.367 - timing_s/adv:0.006 - timing_s/update_actor:21.057 - timing_s/testing:2.106 - timing_s/step:36.785 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.676 - perf/total_num_tokens:31127.000 - perf/time_per_step:36.785 - perf/throughput:846.195 - timing_s/total:1738.378
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:51 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:50.406 - global_seqlen/min:32564.000 - global_seqlen/max:32564.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32564.000 - global_seqlen/balanced_max:32564.000 - global_seqlen/mean:32564.000 - actor/kl_loss:1.073 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.057 - actor/ppo_kl:-0.030 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.949 - actor/grad_norm:0.082 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.042 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.035 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.035 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:254.398 - response_length/max:346.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.303 - timing_s/old_log_prob:4.838 - timing_s/ref:7.335 - timing_s/adv:0.003 - timing_s/update_actor:21.270 - timing_s/step:34.752 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.653 - perf/total_num_tokens:32564.000 - perf/time_per_step:34.752 - perf/throughput:937.050 - timing_s/total:1773.132
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:52 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.492 - global_seqlen/min:31935.000 - global_seqlen/max:31935.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31935.000 - global_seqlen/balanced_max:31935.000 - global_seqlen/mean:31935.000 - actor/kl_loss:0.450 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.007 - actor/ppo_kl:0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.782 - actor/grad_norm:0.067 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.046 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.484 - response_length/max:345.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.413 - timing_s/old_log_prob:4.843 - timing_s/ref:7.335 - timing_s/adv:0.006 - timing_s/update_actor:21.178 - timing_s/step:34.780 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.663 - perf/total_num_tokens:31935.000 - perf/time_per_step:34.780 - perf/throughput:918.202 - timing_s/total:1807.915
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:53 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.000 - global_seqlen/min:31872.000 - global_seqlen/max:31872.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31872.000 - global_seqlen/balanced_max:31872.000 - global_seqlen/mean:31872.000 - actor/kl_loss:1.287 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.046 - actor/ppo_kl:-0.105 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.695 - actor/grad_norm:0.077 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.077 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.031 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.031 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:248.992 - response_length/max:342.000 - response_length/min:220.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.625 - timing_s/old_log_prob:4.795 - timing_s/ref:7.334 - timing_s/adv:0.006 - timing_s/update_actor:20.856 - timing_s/step:34.619 - timing_per_token_ms/gen:0.051 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.654 - perf/total_num_tokens:31872.000 - perf/time_per_step:34.619 - perf/throughput:920.659 - timing_s/total:1842.537
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:54 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:39.414 - global_seqlen/min:31157.000 - global_seqlen/max:31157.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31157.000 - global_seqlen/balanced_max:31157.000 - global_seqlen/mean:31157.000 - actor/kl_loss:1.286 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.009 - actor/ppo_kl:-0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.375 - actor/grad_norm:0.079 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.090 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:243.406 - response_length/max:324.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.498 - timing_s/old_log_prob:4.782 - timing_s/ref:7.289 - timing_s/adv:0.005 - timing_s/update_actor:20.679 - timing_s/step:34.256 - timing_per_token_ms/gen:0.048 - timing_per_token_ms/ref:0.234 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.664 - perf/total_num_tokens:31157.000 - perf/time_per_step:34.256 - perf/throughput:909.543 - timing_s/total:1876.795
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:55 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.906 - global_seqlen/min:30708.000 - global_seqlen/max:30708.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30708.000 - global_seqlen/balanced_max:30708.000 - global_seqlen/mean:30708.000 - actor/kl_loss:0.771 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.068 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.270 - actor/grad_norm:0.073 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.093 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:239.898 - response_length/max:311.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.178 - timing_s/old_log_prob:4.795 - timing_s/ref:7.330 - timing_s/adv:0.006 - timing_s/update_actor:20.886 - timing_s/step:34.198 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.239 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.680 - perf/total_num_tokens:30708.000 - perf/time_per_step:34.198 - perf/throughput:897.934 - timing_s/total:1910.997
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:56 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.641 - global_seqlen/min:31058.000 - global_seqlen/max:31058.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31058.000 - global_seqlen/balanced_max:31058.000 - global_seqlen/mean:31058.000 - actor/kl_loss:1.642 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.007 - actor/ppo_kl:0.067 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.753 - actor/grad_norm:0.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.102 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.003 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.003 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:242.625 - response_length/max:305.000 - response_length/min:219.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.184 - timing_s/old_log_prob:4.763 - timing_s/ref:7.316 - timing_s/adv:0.006 - timing_s/update_actor:21.221 - timing_s/step:34.493 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.683 - perf/total_num_tokens:31058.000 - perf/time_per_step:34.493 - perf/throughput:900.413 - timing_s/total:1945.492
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:57 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:44.961 - global_seqlen/min:31867.000 - global_seqlen/max:31867.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31867.000 - global_seqlen/balanced_max:31867.000 - global_seqlen/mean:31867.000 - actor/kl_loss:0.577 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.027 - actor/ppo_kl:-0.037 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.152 - actor/grad_norm:0.064 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.111 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.023 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.023 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:248.938 - response_length/max:340.000 - response_length/min:221.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.424 - timing_s/old_log_prob:4.868 - timing_s/ref:7.301 - timing_s/adv:0.006 - timing_s/update_actor:21.162 - timing_s/step:34.765 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.664 - perf/total_num_tokens:31867.000 - perf/time_per_step:34.765 - perf/throughput:916.636 - timing_s/total:1980.260
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:58 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:43.031 - global_seqlen/min:31620.000 - global_seqlen/max:31620.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31620.000 - global_seqlen/balanced_max:31620.000 - global_seqlen/mean:31620.000 - actor/kl_loss:1.516 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.038 - actor/ppo_kl:-0.056 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.977 - actor/grad_norm:0.071 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.118 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.015 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.015 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:247.023 - response_length/max:343.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.419 - timing_s/old_log_prob:4.823 - timing_s/ref:7.294 - timing_s/adv:0.006 - timing_s/update_actor:21.268 - timing_s/step:34.814 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.231 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.673 - perf/total_num_tokens:31620.000 - perf/time_per_step:34.814 - perf/throughput:908.248 - timing_s/total:2015.078
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:59 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:42.758 - global_seqlen/min:31585.000 - global_seqlen/max:31585.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31585.000 - global_seqlen/balanced_max:31585.000 - global_seqlen/mean:31585.000 - actor/kl_loss:1.149 - actor/kl_coef:0.001 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.026 - actor/ppo_kl:-0.050 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:7.065 - actor/grad_norm:0.082 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.126 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.345 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.345 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.022 - critic/advantages/max:0.345 - critic/advantages/min:-3.750 - critic/returns/mean:-0.022 - critic/returns/max:0.345 - critic/returns/min:-3.750 - response_length/mean:246.750 - response_length/max:341.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.443 - timing_s/old_log_prob:4.889 - timing_s/ref:7.346 - timing_s/adv:0.006 - timing_s/update_actor:20.938 - timing_s/step:34.628 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.663 - perf/total_num_tokens:31585.000 - perf/time_per_step:34.628 - perf/throughput:912.126 - timing_s/total:2049.708
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.014066457748413 seconds
[36m(TaskRunner pid=851128)[0m step:60 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:39.312 - global_seqlen/min:31144.000 - global_seqlen/max:31144.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31144.000 - global_seqlen/balanced_max:31144.000 - global_seqlen/mean:31144.000 - actor/kl_loss:1.285 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.025 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.808 - actor/grad_norm:0.065 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.125 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.484 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:17.764 - val-core/unknown/reward/mean@512:0.136 - val-aux/unknown/reward/std@512:0.223 - val-aux/unknown/reward/best@2/mean:0.192 - val-aux/unknown/reward/best@2/std:0.279 - val-aux/unknown/reward/worst@2/mean:0.074 - val-aux/unknown/reward/worst@2/std:0.080 - val-aux/unknown/reward/best@4/mean:0.300 - val-aux/unknown/reward/best@4/std:0.374 - val-aux/unknown/reward/worst@4/mean:0.046 - val-aux/unknown/reward/worst@4/std:0.050 - val-aux/unknown/reward/best@8/mean:0.451 - val-aux/unknown/reward/best@8/std:0.439 - val-aux/unknown/reward/worst@8/mean:0.019 - val-aux/unknown/reward/worst@8/std:0.039 - val-aux/unknown/reward/best@16/mean:0.666 - val-aux/unknown/reward/best@16/std:0.435 - val-aux/unknown/reward/worst@16/mean:0.004 - val-aux/unknown/reward/worst@16/std:0.020 - val-aux/unknown/reward/best@32/mean:0.865 - val-aux/unknown/reward/best@32/std:0.321 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.003 - val-aux/unknown/reward/best@64/mean:0.984 - val-aux/unknown/reward/best@64/std:0.120 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:243.305 - response_length/max:328.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.253 - timing_s/old_log_prob:4.769 - timing_s/ref:7.296 - timing_s/adv:0.003 - timing_s/update_actor:20.646 - timing_s/testing:1.338 - timing_s/step:35.307 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.234 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.663 - perf/total_num_tokens:31144.000 - perf/time_per_step:35.307 - perf/throughput:882.092 - timing_s/total:2085.017
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:61 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:39.695 - global_seqlen/min:31193.000 - global_seqlen/max:31193.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31193.000 - global_seqlen/balanced_max:31193.000 - global_seqlen/mean:31193.000 - actor/kl_loss:1.126 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.079 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.037 - actor/grad_norm:0.064 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.132 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:243.688 - response_length/max:325.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.157 - timing_s/old_log_prob:4.787 - timing_s/ref:7.338 - timing_s/adv:0.006 - timing_s/update_actor:20.983 - timing_s/step:34.274 - timing_per_token_ms/gen:0.037 - timing_per_token_ms/ref:0.235 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.673 - perf/total_num_tokens:31193.000 - perf/time_per_step:34.274 - perf/throughput:910.095 - timing_s/total:2119.294
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:62 - train/Bandit/success:0.023 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.867 - global_seqlen/min:32751.000 - global_seqlen/max:32751.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32751.000 - global_seqlen/balanced_max:32751.000 - global_seqlen/mean:32751.000 - actor/kl_loss:1.601 - actor/kl_coef:0.001 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.049 - actor/ppo_kl:0.097 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.676 - actor/grad_norm:0.117 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.134 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:3.750 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:3.750 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.020 - critic/advantages/max:3.750 - critic/advantages/min:-3.750 - critic/returns/mean:-0.020 - critic/returns/max:3.750 - critic/returns/min:-3.750 - response_length/mean:255.859 - response_length/max:349.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.409 - timing_s/old_log_prob:4.854 - timing_s/ref:7.318 - timing_s/adv:0.004 - timing_s/update_actor:21.040 - timing_s/step:34.627 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.223 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.642 - perf/total_num_tokens:32751.000 - perf/time_per_step:34.627 - perf/throughput:945.825 - timing_s/total:2153.924
[36m(TaskRunner pid=851128)[0m 
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:63 - train/Bandit/success:0.023 - train/Bandit/num_actions:0.195 - train/Bandit/action_is_effective:0.195 - train/Bandit/action_is_valid:0.195 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:53.406 - global_seqlen/min:32948.000 - global_seqlen/max:32948.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32948.000 - global_seqlen/balanced_max:32948.000 - global_seqlen/mean:32948.000 - actor/kl_loss:0.961 - actor/kl_coef:0.001 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.146 - actor/ppo_kl:0.490 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.105 - actor/grad_norm:14.056 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.095 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:3.750 - critic/score/min:-0.750 - critic/rewards/mean:0.000 - critic/rewards/max:3.750 - critic/rewards/min:-0.750 - critic/advantages/mean:0.001 - critic/advantages/max:3.750 - critic/advantages/min:-0.750 - critic/returns/mean:0.001 - critic/returns/max:3.750 - critic/returns/min:-0.750 - response_length/mean:257.398 - response_length/max:345.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.461 - timing_s/old_log_prob:4.833 - timing_s/ref:7.306 - timing_s/adv:0.003 - timing_s/update_actor:21.423 - timing_s/step:35.027 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.222 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.650 - perf/total_num_tokens:32948.000 - perf/time_per_step:35.027 - perf/throughput:940.632 - timing_s/total:2188.970
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:64 - train/Bandit/success:0.141 - train/Bandit/num_actions:0.875 - train/Bandit/action_is_effective:0.875 - train/Bandit/action_is_valid:0.875 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:47.641 - global_seqlen/min:32210.000 - global_seqlen/max:32210.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32210.000 - global_seqlen/balanced_max:32210.000 - global_seqlen/mean:32210.000 - actor/kl_loss:1.235 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.070 - actor/ppo_kl:-0.072 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:7.555 - actor/grad_norm:21.379 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.113 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.965 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.965 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.019 - critic/advantages/max:0.965 - critic/advantages/min:-3.750 - critic/returns/mean:-0.019 - critic/returns/max:0.965 - critic/returns/min:-3.750 - response_length/mean:251.633 - response_length/max:346.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.443 - timing_s/old_log_prob:4.844 - timing_s/ref:7.315 - timing_s/adv:0.006 - timing_s/update_actor:21.217 - timing_s/step:34.828 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.227 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.659 - perf/total_num_tokens:32210.000 - perf/time_per_step:34.828 - perf/throughput:924.826 - timing_s/total:2223.801
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:65 - train/Bandit/success:0.367 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:44.562 - global_seqlen/min:31816.000 - global_seqlen/max:31816.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31816.000 - global_seqlen/balanced_max:31816.000 - global_seqlen/mean:31816.000 - actor/kl_loss:1.544 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.049 - actor/ppo_kl:-0.035 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.252 - actor/grad_norm:0.067 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.117 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.023 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.023 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:248.547 - response_length/max:339.000 - response_length/min:219.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.425 - timing_s/old_log_prob:4.825 - timing_s/ref:7.323 - timing_s/adv:0.006 - timing_s/update_actor:21.404 - timing_s/step:34.988 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.673 - perf/total_num_tokens:31816.000 - perf/time_per_step:34.988 - perf/throughput:909.342 - timing_s/total:2258.792
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:66 - train/Bandit/success:0.469 - train/Bandit/num_actions:0.953 - train/Bandit/action_is_effective:0.953 - train/Bandit/action_is_valid:0.953 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:47.141 - global_seqlen/min:32146.000 - global_seqlen/max:32146.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32146.000 - global_seqlen/balanced_max:32146.000 - global_seqlen/mean:32146.000 - actor/kl_loss:1.502 - actor/kl_coef:0.001 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.054 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.241 - actor/grad_norm:3.097 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.120 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:3.750 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:3.750 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.047 - critic/advantages/max:3.750 - critic/advantages/min:-3.750 - critic/returns/mean:-0.047 - critic/returns/max:3.750 - critic/returns/min:-3.750 - response_length/mean:251.133 - response_length/max:347.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.441 - timing_s/old_log_prob:4.867 - timing_s/ref:7.325 - timing_s/adv:0.006 - timing_s/update_actor:21.016 - timing_s/step:34.660 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.654 - perf/total_num_tokens:32146.000 - perf/time_per_step:34.660 - perf/throughput:927.471 - timing_s/total:2293.455
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:67 - train/Bandit/success:0.234 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.102 - global_seqlen/min:30861.000 - global_seqlen/max:30861.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30861.000 - global_seqlen/balanced_max:30861.000 - global_seqlen/mean:30861.000 - actor/kl_loss:1.118 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.023 - actor/ppo_kl:0.042 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.893 - actor/grad_norm:8.539 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.137 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:3.750 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:3.750 - critic/rewards/min:-3.750 - critic/advantages/mean:0.003 - critic/advantages/max:3.750 - critic/advantages/min:-3.750 - critic/returns/mean:0.003 - critic/returns/max:3.750 - critic/returns/min:-3.750 - response_length/mean:241.094 - response_length/max:307.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.192 - timing_s/old_log_prob:4.798 - timing_s/ref:7.311 - timing_s/adv:0.006 - timing_s/update_actor:20.482 - timing_s/step:33.793 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.664 - perf/total_num_tokens:30861.000 - perf/time_per_step:33.793 - perf/throughput:913.235 - timing_s/total:2327.252
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:68 - train/Bandit/success:0.438 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:44.477 - global_seqlen/min:31805.000 - global_seqlen/max:31805.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31805.000 - global_seqlen/balanced_max:31805.000 - global_seqlen/mean:31805.000 - actor/kl_loss:1.452 - actor/kl_coef:0.001 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.042 - actor/ppo_kl:-0.019 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.430 - actor/grad_norm:0.070 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.156 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:1.494 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:1.494 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.014 - critic/advantages/max:1.494 - critic/advantages/min:-3.750 - critic/returns/mean:-0.014 - critic/returns/max:1.494 - critic/returns/min:-3.750 - response_length/mean:248.469 - response_length/max:339.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.392 - timing_s/old_log_prob:4.783 - timing_s/ref:7.353 - timing_s/adv:0.006 - timing_s/update_actor:21.417 - timing_s/step:34.954 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.231 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.673 - perf/total_num_tokens:31805.000 - perf/time_per_step:34.954 - perf/throughput:909.901 - timing_s/total:2362.209
[36m(TaskRunner pid=851128)[0m 
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:69 - train/Bandit/success:0.602 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.305 - global_seqlen/min:31015.000 - global_seqlen/max:31015.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31015.000 - global_seqlen/balanced_max:31015.000 - global_seqlen/mean:31015.000 - actor/kl_loss:1.260 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.013 - actor/ppo_kl:0.039 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.979 - actor/grad_norm:0.066 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.139 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:2.739 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:2.739 - critic/rewards/min:-3.750 - critic/advantages/mean:0.001 - critic/advantages/max:2.739 - critic/advantages/min:-3.750 - critic/returns/mean:0.001 - critic/returns/max:2.739 - critic/returns/min:-3.750 - response_length/mean:242.297 - response_length/max:321.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.225 - timing_s/old_log_prob:4.771 - timing_s/ref:7.315 - timing_s/adv:0.006 - timing_s/update_actor:20.614 - timing_s/step:33.935 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.665 - perf/total_num_tokens:31015.000 - perf/time_per_step:33.935 - perf/throughput:913.955 - timing_s/total:2396.147
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.9153399467468262 seconds
[36m(TaskRunner pid=851128)[0m step:70 - train/Bandit/success:0.125 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:42.086 - global_seqlen/min:31499.000 - global_seqlen/max:31499.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31499.000 - global_seqlen/balanced_max:31499.000 - global_seqlen/mean:31499.000 - actor/kl_loss:1.499 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.041 - actor/ppo_kl:-0.075 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.972 - actor/grad_norm:0.073 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.139 - actor/lr:0.000 - val-env/Bandit/success:0.438 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.492 - val-env/BanditTest/num_actions:0.996 - val-env/BanditTest/action_is_effective:0.996 - val-env/BanditTest/action_is_valid:0.996 - val-env/Bandit/non-zero/success:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:18.674 - val-core/unknown/reward/mean@512:0.153 - val-aux/unknown/reward/std@512:0.286 - val-aux/unknown/reward/best@2/mean:0.257 - val-aux/unknown/reward/best@2/std:0.360 - val-aux/unknown/reward/worst@2/mean:0.050 - val-aux/unknown/reward/worst@2/std:0.120 - val-aux/unknown/reward/best@4/mean:0.421 - val-aux/unknown/reward/best@4/std:0.434 - val-aux/unknown/reward/worst@4/mean:0.015 - val-aux/unknown/reward/worst@4/std:0.039 - val-aux/unknown/reward/best@8/mean:0.614 - val-aux/unknown/reward/best@8/std:0.445 - val-aux/unknown/reward/worst@8/mean:0.001 - val-aux/unknown/reward/worst@8/std:0.021 - val-aux/unknown/reward/best@16/mean:0.834 - val-aux/unknown/reward/best@16/std:0.349 - val-aux/unknown/reward/worst@16/mean:-0.003 - val-aux/unknown/reward/worst@16/std:0.017 - val-aux/unknown/reward/best@32/mean:0.960 - val-aux/unknown/reward/best@32/std:0.185 - val-aux/unknown/reward/worst@32/mean:-0.007 - val-aux/unknown/reward/worst@32/std:0.025 - val-aux/unknown/reward/best@64/mean:0.999 - val-aux/unknown/reward/best@64/std:0.028 - val-aux/unknown/reward/worst@64/mean:-0.013 - val-aux/unknown/reward/worst@64/std:0.034 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.024 - val-aux/unknown/reward/worst@128/std:0.043 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.043 - val-aux/unknown/reward/worst@256/std:0.049 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.025 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.025 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:246.078 - response_length/max:344.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.438 - timing_s/old_log_prob:4.902 - timing_s/ref:7.352 - timing_s/adv:0.006 - timing_s/update_actor:21.164 - timing_s/testing:2.223 - timing_s/step:37.089 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.672 - perf/total_num_tokens:31499.000 - perf/time_per_step:37.089 - perf/throughput:849.280 - timing_s/total:2433.239
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:71 - train/Bandit/success:0.844 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.039 - global_seqlen/min:30981.000 - global_seqlen/max:30981.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30981.000 - global_seqlen/balanced_max:30981.000 - global_seqlen/mean:30981.000 - actor/kl_loss:1.398 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.063 - actor/ppo_kl:0.109 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.825 - actor/grad_norm:0.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.177 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:3.750 - critic/score/min:-0.250 - critic/rewards/mean:-0.000 - critic/rewards/max:3.750 - critic/rewards/min:-0.250 - critic/advantages/mean:-0.007 - critic/advantages/max:3.750 - critic/advantages/min:-0.250 - critic/returns/mean:-0.007 - critic/returns/max:3.750 - critic/returns/min:-0.250 - response_length/mean:242.031 - response_length/max:326.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.179 - timing_s/old_log_prob:4.811 - timing_s/ref:7.309 - timing_s/adv:0.006 - timing_s/update_actor:20.574 - timing_s/step:33.883 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.664 - perf/total_num_tokens:30981.000 - perf/time_per_step:33.883 - perf/throughput:914.359 - timing_s/total:2467.124
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:72 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.320 - global_seqlen/min:31017.000 - global_seqlen/max:31017.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31017.000 - global_seqlen/balanced_max:31017.000 - global_seqlen/mean:31017.000 - actor/kl_loss:1.615 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.006 - actor/ppo_kl:0.026 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:6.932 - actor/grad_norm:7.052 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.177 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:242.312 - response_length/max:326.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.283 - timing_s/old_log_prob:4.799 - timing_s/ref:7.316 - timing_s/adv:0.006 - timing_s/update_actor:21.300 - timing_s/step:34.708 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.687 - perf/total_num_tokens:31017.000 - perf/time_per_step:34.708 - perf/throughput:893.651 - timing_s/total:2501.835
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:73 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:47.172 - global_seqlen/min:32150.000 - global_seqlen/max:32150.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32150.000 - global_seqlen/balanced_max:32150.000 - global_seqlen/mean:32150.000 - actor/kl_loss:1.072 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.006 - actor/ppo_kl:-0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.646 - actor/grad_norm:0.064 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.181 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:251.164 - response_length/max:343.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.434 - timing_s/old_log_prob:4.851 - timing_s/ref:7.248 - timing_s/adv:0.006 - timing_s/update_actor:20.820 - timing_s/step:34.364 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.648 - perf/total_num_tokens:32150.000 - perf/time_per_step:34.364 - perf/throughput:935.585 - timing_s/total:2536.201
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:74 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:46.164 - global_seqlen/min:32021.000 - global_seqlen/max:32021.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32021.000 - global_seqlen/balanced_max:32021.000 - global_seqlen/mean:32021.000 - actor/kl_loss:1.340 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.046 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.504 - actor/grad_norm:0.052 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.192 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:250.148 - response_length/max:336.000 - response_length/min:220.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.661 - timing_s/old_log_prob:4.832 - timing_s/ref:7.331 - timing_s/adv:0.006 - timing_s/update_actor:21.242 - timing_s/step:35.076 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.663 - perf/total_num_tokens:32021.000 - perf/time_per_step:35.076 - perf/throughput:912.893 - timing_s/total:2571.281
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:75 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:39.523 - global_seqlen/min:31171.000 - global_seqlen/max:31171.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31171.000 - global_seqlen/balanced_max:31171.000 - global_seqlen/mean:31171.000 - actor/kl_loss:1.097 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.026 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.381 - actor/grad_norm:0.054 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.199 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:243.508 - response_length/max:319.000 - response_length/min:219.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.255 - timing_s/old_log_prob:4.826 - timing_s/ref:7.314 - timing_s/adv:0.003 - timing_s/update_actor:20.997 - timing_s/step:34.399 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.235 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.674 - perf/total_num_tokens:31171.000 - perf/time_per_step:34.399 - perf/throughput:906.169 - timing_s/total:2605.682
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:76 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.117 - global_seqlen/min:31887.000 - global_seqlen/max:31887.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31887.000 - global_seqlen/balanced_max:31887.000 - global_seqlen/mean:31887.000 - actor/kl_loss:1.173 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.018 - actor/ppo_kl:-0.007 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.664 - actor/grad_norm:13.570 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.197 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.019 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.019 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.109 - response_length/max:342.000 - response_length/min:219.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.415 - timing_s/old_log_prob:4.853 - timing_s/ref:7.313 - timing_s/adv:0.006 - timing_s/update_actor:20.994 - timing_s/step:34.586 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.658 - perf/total_num_tokens:31887.000 - perf/time_per_step:34.586 - perf/throughput:921.967 - timing_s/total:2640.271
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:77 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:46.352 - global_seqlen/min:32045.000 - global_seqlen/max:32045.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32045.000 - global_seqlen/balanced_max:32045.000 - global_seqlen/mean:32045.000 - actor/kl_loss:0.749 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.796 - actor/grad_norm:0.051 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.197 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.003 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.003 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:250.344 - response_length/max:323.000 - response_length/min:220.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.314 - timing_s/old_log_prob:4.827 - timing_s/ref:7.346 - timing_s/adv:0.003 - timing_s/update_actor:20.749 - timing_s/step:34.242 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.647 - perf/total_num_tokens:32045.000 - perf/time_per_step:34.242 - perf/throughput:935.832 - timing_s/total:2674.516
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:78 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.234 - global_seqlen/min:32670.000 - global_seqlen/max:32670.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32670.000 - global_seqlen/balanced_max:32670.000 - global_seqlen/mean:32670.000 - actor/kl_loss:1.276 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.021 - actor/ppo_kl:-0.022 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.944 - actor/grad_norm:0.046 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.175 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:255.227 - response_length/max:334.000 - response_length/min:222.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.411 - timing_s/old_log_prob:4.832 - timing_s/ref:7.280 - timing_s/adv:0.003 - timing_s/update_actor:21.178 - timing_s/step:34.708 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.223 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.648 - perf/total_num_tokens:32670.000 - perf/time_per_step:34.708 - perf/throughput:941.295 - timing_s/total:2709.226
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:79 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:48.312 - global_seqlen/min:32296.000 - global_seqlen/max:32296.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32296.000 - global_seqlen/balanced_max:32296.000 - global_seqlen/mean:32296.000 - actor/kl_loss:1.426 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.014 - actor/ppo_kl:-0.030 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.982 - actor/grad_norm:0.050 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.188 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.019 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.019 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:252.297 - response_length/max:342.000 - response_length/min:220.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.420 - timing_s/old_log_prob:4.845 - timing_s/ref:7.355 - timing_s/adv:0.006 - timing_s/update_actor:21.121 - timing_s/step:34.749 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.654 - perf/total_num_tokens:32296.000 - perf/time_per_step:34.749 - perf/throughput:929.405 - timing_s/total:2743.978
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.0571422576904297 seconds
[36m(TaskRunner pid=851128)[0m step:80 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:40.859 - global_seqlen/min:31342.000 - global_seqlen/max:31342.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31342.000 - global_seqlen/balanced_max:31342.000 - global_seqlen/mean:31342.000 - actor/kl_loss:1.513 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.015 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.668 - actor/grad_norm:0.081 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.199 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.410 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:18.139 - val-core/unknown/reward/mean@512:0.130 - val-aux/unknown/reward/std@512:0.204 - val-aux/unknown/reward/best@2/mean:0.180 - val-aux/unknown/reward/best@2/std:0.258 - val-aux/unknown/reward/worst@2/mean:0.074 - val-aux/unknown/reward/worst@2/std:0.061 - val-aux/unknown/reward/best@4/mean:0.269 - val-aux/unknown/reward/best@4/std:0.352 - val-aux/unknown/reward/worst@4/mean:0.049 - val-aux/unknown/reward/worst@4/std:0.050 - val-aux/unknown/reward/best@8/mean:0.409 - val-aux/unknown/reward/best@8/std:0.427 - val-aux/unknown/reward/worst@8/mean:0.024 - val-aux/unknown/reward/worst@8/std:0.043 - val-aux/unknown/reward/best@16/mean:0.615 - val-aux/unknown/reward/best@16/std:0.445 - val-aux/unknown/reward/worst@16/mean:0.007 - val-aux/unknown/reward/worst@16/std:0.025 - val-aux/unknown/reward/best@32/mean:0.825 - val-aux/unknown/reward/best@32/std:0.357 - val-aux/unknown/reward/worst@32/mean:0.001 - val-aux/unknown/reward/worst@32/std:0.009 - val-aux/unknown/reward/best@64/mean:0.960 - val-aux/unknown/reward/best@64/std:0.185 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:244.852 - response_length/max:296.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.305 - timing_s/old_log_prob:4.754 - timing_s/ref:7.343 - timing_s/adv:0.006 - timing_s/update_actor:21.005 - timing_s/testing:1.358 - timing_s/step:35.775 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.234 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.670 - perf/total_num_tokens:31342.000 - perf/time_per_step:35.775 - perf/throughput:876.096 - timing_s/total:2779.755
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:81 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:47.766 - global_seqlen/min:32226.000 - global_seqlen/max:32226.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32226.000 - global_seqlen/balanced_max:32226.000 - global_seqlen/mean:32226.000 - actor/kl_loss:0.995 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.313 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.849 - actor/grad_norm:0.090 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.198 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:251.758 - response_length/max:343.000 - response_length/min:220.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.531 - timing_s/old_log_prob:4.838 - timing_s/ref:7.341 - timing_s/adv:0.003 - timing_s/update_actor:20.944 - timing_s/step:34.659 - timing_per_token_ms/gen:0.047 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.650 - perf/total_num_tokens:32226.000 - perf/time_per_step:34.659 - perf/throughput:929.794 - timing_s/total:2814.417
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:82 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:50.328 - global_seqlen/min:32554.000 - global_seqlen/max:32554.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32554.000 - global_seqlen/balanced_max:32554.000 - global_seqlen/mean:32554.000 - actor/kl_loss:0.408 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.198 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.072 - actor/grad_norm:0.103 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.048 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:254.320 - response_length/max:342.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.415 - timing_s/old_log_prob:4.829 - timing_s/ref:7.333 - timing_s/adv:0.006 - timing_s/update_actor:20.956 - timing_s/step:34.541 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.644 - perf/total_num_tokens:32554.000 - perf/time_per_step:34.541 - perf/throughput:942.479 - timing_s/total:2848.961
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:83 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:53.594 - global_seqlen/min:32972.000 - global_seqlen/max:32972.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32972.000 - global_seqlen/balanced_max:32972.000 - global_seqlen/mean:32972.000 - actor/kl_loss:0.916 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.058 - actor/ppo_kl:-0.139 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:8.094 - actor/grad_norm:0.108 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.074 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.036 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.036 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:257.586 - response_length/max:344.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.466 - timing_s/old_log_prob:4.892 - timing_s/ref:7.352 - timing_s/adv:0.006 - timing_s/update_actor:21.501 - timing_s/step:35.220 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.223 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.652 - perf/total_num_tokens:32972.000 - perf/time_per_step:35.220 - perf/throughput:936.179 - timing_s/total:2884.183
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:84 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:52.648 - global_seqlen/min:32851.000 - global_seqlen/max:32851.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32851.000 - global_seqlen/balanced_max:32851.000 - global_seqlen/mean:32851.000 - actor/kl_loss:0.750 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.087 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.078 - actor/grad_norm:5.867 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.097 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.039 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.039 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:256.641 - response_length/max:342.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.453 - timing_s/old_log_prob:4.837 - timing_s/ref:7.334 - timing_s/adv:0.003 - timing_s/update_actor:21.377 - timing_s/step:35.008 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.223 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.651 - perf/total_num_tokens:32851.000 - perf/time_per_step:35.008 - perf/throughput:938.399 - timing_s/total:2919.194
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:85 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:50.203 - global_seqlen/min:32538.000 - global_seqlen/max:32538.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32538.000 - global_seqlen/balanced_max:32538.000 - global_seqlen/mean:32538.000 - actor/kl_loss:0.988 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.041 - actor/ppo_kl:-0.050 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.927 - actor/grad_norm:4.876 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.116 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.022 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.022 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:254.195 - response_length/max:339.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.448 - timing_s/old_log_prob:4.841 - timing_s/ref:7.322 - timing_s/adv:0.006 - timing_s/update_actor:20.885 - timing_s/step:34.507 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.642 - perf/total_num_tokens:32538.000 - perf/time_per_step:34.507 - perf/throughput:942.948 - timing_s/total:2953.703
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:86 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.867 - global_seqlen/min:31983.000 - global_seqlen/max:31983.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31983.000 - global_seqlen/balanced_max:31983.000 - global_seqlen/mean:31983.000 - actor/kl_loss:0.858 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.053 - actor/ppo_kl:-0.027 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.652 - actor/grad_norm:0.129 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.133 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.859 - response_length/max:340.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.363 - timing_s/old_log_prob:4.842 - timing_s/ref:7.338 - timing_s/adv:0.006 - timing_s/update_actor:20.827 - timing_s/step:34.380 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.651 - perf/total_num_tokens:31983.000 - perf/time_per_step:34.380 - perf/throughput:930.283 - timing_s/total:2988.084
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:87 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:48.812 - global_seqlen/min:32360.000 - global_seqlen/max:32360.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32360.000 - global_seqlen/balanced_max:32360.000 - global_seqlen/mean:32360.000 - actor/kl_loss:1.036 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.044 - actor/ppo_kl:-0.124 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.561 - actor/grad_norm:5.632 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.152 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.030 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.030 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:252.789 - response_length/max:340.000 - response_length/min:221.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.423 - timing_s/old_log_prob:4.854 - timing_s/ref:7.307 - timing_s/adv:0.006 - timing_s/update_actor:20.709 - timing_s/step:34.303 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.226 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.640 - perf/total_num_tokens:32360.000 - perf/time_per_step:34.303 - perf/throughput:943.357 - timing_s/total:3022.389
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:88 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:41.867 - global_seqlen/min:31471.000 - global_seqlen/max:31471.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31471.000 - global_seqlen/balanced_max:31471.000 - global_seqlen/mean:31471.000 - actor/kl_loss:1.089 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.024 - actor/ppo_kl:-0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.153 - actor/grad_norm:0.124 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.160 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.000 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.000 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:245.859 - response_length/max:306.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.147 - timing_s/old_log_prob:4.783 - timing_s/ref:7.327 - timing_s/adv:0.006 - timing_s/update_actor:20.587 - timing_s/step:33.853 - timing_per_token_ms/gen:0.036 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.654 - perf/total_num_tokens:31471.000 - perf/time_per_step:33.853 - perf/throughput:929.638 - timing_s/total:3056.245
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:89 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:41.961 - global_seqlen/min:31483.000 - global_seqlen/max:31483.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31483.000 - global_seqlen/balanced_max:31483.000 - global_seqlen/mean:31483.000 - actor/kl_loss:1.127 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.113 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.459 - actor/grad_norm:0.068 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.164 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:245.953 - response_length/max:315.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.417 - timing_s/old_log_prob:4.812 - timing_s/ref:7.331 - timing_s/adv:0.007 - timing_s/update_actor:21.081 - timing_s/step:34.651 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.670 - perf/total_num_tokens:31483.000 - perf/time_per_step:34.651 - perf/throughput:908.568 - timing_s/total:3090.899
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 1.1235995292663574 seconds
[36m(TaskRunner pid=851128)[0m step:90 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.211 - global_seqlen/min:31899.000 - global_seqlen/max:31899.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31899.000 - global_seqlen/balanced_max:31899.000 - global_seqlen/mean:31899.000 - actor/kl_loss:1.415 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.007 - actor/ppo_kl:0.123 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.893 - actor/grad_norm:24.555 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.183 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.496 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:18.295 - val-core/unknown/reward/mean@512:0.136 - val-aux/unknown/reward/std@512:0.223 - val-aux/unknown/reward/best@2/mean:0.218 - val-aux/unknown/reward/best@2/std:0.308 - val-aux/unknown/reward/worst@2/mean:0.068 - val-aux/unknown/reward/worst@2/std:0.063 - val-aux/unknown/reward/best@4/mean:0.297 - val-aux/unknown/reward/best@4/std:0.372 - val-aux/unknown/reward/worst@4/mean:0.044 - val-aux/unknown/reward/worst@4/std:0.050 - val-aux/unknown/reward/best@8/mean:0.456 - val-aux/unknown/reward/best@8/std:0.440 - val-aux/unknown/reward/worst@8/mean:0.017 - val-aux/unknown/reward/worst@8/std:0.038 - val-aux/unknown/reward/best@16/mean:0.677 - val-aux/unknown/reward/best@16/std:0.432 - val-aux/unknown/reward/worst@16/mean:0.004 - val-aux/unknown/reward/worst@16/std:0.019 - val-aux/unknown/reward/best@32/mean:0.887 - val-aux/unknown/reward/best@32/std:0.299 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.003 - val-aux/unknown/reward/best@64/mean:0.989 - val-aux/unknown/reward/best@64/std:0.098 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.203 - response_length/max:310.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.391 - timing_s/old_log_prob:4.791 - timing_s/ref:7.344 - timing_s/adv:0.006 - timing_s/update_actor:21.326 - timing_s/testing:1.425 - timing_s/step:36.284 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.669 - perf/total_num_tokens:31899.000 - perf/time_per_step:36.284 - perf/throughput:879.137 - timing_s/total:3127.186
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:91 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.102 - global_seqlen/min:32653.000 - global_seqlen/max:32653.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32653.000 - global_seqlen/balanced_max:32653.000 - global_seqlen/mean:32653.000 - actor/kl_loss:0.937 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.017 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.142 - actor/grad_norm:0.058 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.169 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:255.094 - response_length/max:344.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.302 - timing_s/old_log_prob:4.784 - timing_s/ref:7.309 - timing_s/adv:0.006 - timing_s/update_actor:21.457 - timing_s/step:34.862 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.224 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.657 - perf/total_num_tokens:32653.000 - perf/time_per_step:34.862 - perf/throughput:936.640 - timing_s/total:3162.050
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:92 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.664 - global_seqlen/min:32725.000 - global_seqlen/max:32725.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32725.000 - global_seqlen/balanced_max:32725.000 - global_seqlen/mean:32725.000 - actor/kl_loss:1.495 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.022 - actor/ppo_kl:-0.130 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.211 - actor/grad_norm:0.054 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.175 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.021 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.021 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:255.656 - response_length/max:347.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.414 - timing_s/old_log_prob:4.831 - timing_s/ref:7.265 - timing_s/adv:0.006 - timing_s/update_actor:21.131 - timing_s/step:34.650 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.222 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.646 - perf/total_num_tokens:32725.000 - perf/time_per_step:34.650 - perf/throughput:944.450 - timing_s/total:3196.702
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:93 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:49.664 - global_seqlen/min:32469.000 - global_seqlen/max:32469.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32469.000 - global_seqlen/balanced_max:32469.000 - global_seqlen/mean:32469.000 - actor/kl_loss:1.442 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.010 - actor/ppo_kl:-0.062 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.193 - actor/grad_norm:0.056 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.190 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.021 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.021 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:253.656 - response_length/max:348.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.465 - timing_s/old_log_prob:4.813 - timing_s/ref:7.317 - timing_s/adv:0.003 - timing_s/update_actor:21.198 - timing_s/step:34.799 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.653 - perf/total_num_tokens:32469.000 - perf/time_per_step:34.799 - perf/throughput:933.031 - timing_s/total:3231.504
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:94 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.164 - global_seqlen/min:31893.000 - global_seqlen/max:31893.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31893.000 - global_seqlen/balanced_max:31893.000 - global_seqlen/mean:31893.000 - actor/kl_loss:1.237 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.015 - actor/ppo_kl:-0.062 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.821 - actor/grad_norm:0.068 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.203 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.011 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.011 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.156 - response_length/max:341.000 - response_length/min:219.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.719 - timing_s/old_log_prob:4.794 - timing_s/ref:7.296 - timing_s/adv:0.005 - timing_s/update_actor:20.920 - timing_s/step:34.736 - timing_per_token_ms/gen:0.054 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.656 - perf/total_num_tokens:31893.000 - perf/time_per_step:34.736 - perf/throughput:918.145 - timing_s/total:3266.243
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:95 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:42.188 - global_seqlen/min:31512.000 - global_seqlen/max:31512.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31512.000 - global_seqlen/balanced_max:31512.000 - global_seqlen/mean:31512.000 - actor/kl_loss:1.845 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.073 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.865 - actor/grad_norm:0.054 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.139 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:246.180 - response_length/max:331.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.538 - timing_s/old_log_prob:4.846 - timing_s/ref:7.317 - timing_s/adv:0.006 - timing_s/update_actor:21.060 - timing_s/step:34.771 - timing_per_token_ms/gen:0.049 - timing_per_token_ms/ref:0.232 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.668 - perf/total_num_tokens:31512.000 - perf/time_per_step:34.771 - perf/throughput:906.271 - timing_s/total:3301.017
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:96 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:44.852 - global_seqlen/min:31853.000 - global_seqlen/max:31853.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31853.000 - global_seqlen/balanced_max:31853.000 - global_seqlen/mean:31853.000 - actor/kl_loss:1.567 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.112 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.154 - actor/grad_norm:0.058 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.171 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.011 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.011 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:248.844 - response_length/max:339.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.552 - timing_s/old_log_prob:4.833 - timing_s/ref:7.314 - timing_s/adv:0.006 - timing_s/update_actor:21.094 - timing_s/step:34.802 - timing_per_token_ms/gen:0.049 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.662 - perf/total_num_tokens:31853.000 - perf/time_per_step:34.802 - perf/throughput:915.266 - timing_s/total:3335.821
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:97 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.641 - global_seqlen/min:32722.000 - global_seqlen/max:32722.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32722.000 - global_seqlen/balanced_max:32722.000 - global_seqlen/mean:32722.000 - actor/kl_loss:1.570 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.062 - actor/ppo_kl:-0.128 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.513 - actor/grad_norm:15.681 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.222 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.029 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.029 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:255.633 - response_length/max:347.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.508 - timing_s/old_log_prob:4.852 - timing_s/ref:7.366 - timing_s/adv:0.003 - timing_s/update_actor:21.151 - timing_s/step:34.884 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.646 - perf/total_num_tokens:32722.000 - perf/time_per_step:34.884 - perf/throughput:938.029 - timing_s/total:3370.708
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:98 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.141 - global_seqlen/min:31890.000 - global_seqlen/max:31890.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31890.000 - global_seqlen/balanced_max:31890.000 - global_seqlen/mean:31890.000 - actor/kl_loss:1.608 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.051 - actor/ppo_kl:-0.048 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.890 - actor/grad_norm:0.060 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.227 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.015 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.015 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.133 - response_length/max:341.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.518 - timing_s/old_log_prob:4.991 - timing_s/ref:7.323 - timing_s/adv:0.003 - timing_s/update_actor:21.183 - timing_s/step:35.021 - timing_per_token_ms/gen:0.048 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.664 - perf/total_num_tokens:31890.000 - perf/time_per_step:35.021 - perf/throughput:910.597 - timing_s/total:3405.732
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:99 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:44.094 - global_seqlen/min:31756.000 - global_seqlen/max:31756.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31756.000 - global_seqlen/balanced_max:31756.000 - global_seqlen/mean:31756.000 - actor/kl_loss:2.056 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.064 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.125 - actor/grad_norm:0.062 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.230 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:248.086 - response_length/max:331.000 - response_length/min:222.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.768 - timing_s/old_log_prob:4.798 - timing_s/ref:7.328 - timing_s/adv:0.006 - timing_s/update_actor:20.658 - timing_s/step:34.560 - timing_per_token_ms/gen:0.056 - timing_per_token_ms/ref:0.231 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.651 - perf/total_num_tokens:31756.000 - perf/time_per_step:34.560 - perf/throughput:918.868 - timing_s/total:3440.294
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 2.583369493484497 seconds
[36m(TaskRunner pid=851128)[0m step:100 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:56.797 - global_seqlen/min:33382.000 - global_seqlen/max:33382.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33382.000 - global_seqlen/balanced_max:33382.000 - global_seqlen/mean:33382.000 - actor/kl_loss:0.910 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.109 - actor/ppo_kl:-0.051 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.527 - actor/grad_norm:4.428 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.234 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.418 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:17.480 - val-core/unknown/reward/mean@512:0.134 - val-aux/unknown/reward/std@512:0.211 - val-aux/unknown/reward/best@2/mean:0.194 - val-aux/unknown/reward/best@2/std:0.279 - val-aux/unknown/reward/worst@2/mean:0.077 - val-aux/unknown/reward/worst@2/std:0.085 - val-aux/unknown/reward/best@4/mean:0.287 - val-aux/unknown/reward/best@4/std:0.365 - val-aux/unknown/reward/worst@4/mean:0.053 - val-aux/unknown/reward/worst@4/std:0.050 - val-aux/unknown/reward/best@8/mean:0.418 - val-aux/unknown/reward/best@8/std:0.430 - val-aux/unknown/reward/worst@8/mean:0.027 - val-aux/unknown/reward/worst@8/std:0.044 - val-aux/unknown/reward/best@16/mean:0.631 - val-aux/unknown/reward/best@16/std:0.443 - val-aux/unknown/reward/worst@16/mean:0.007 - val-aux/unknown/reward/worst@16/std:0.025 - val-aux/unknown/reward/best@32/mean:0.835 - val-aux/unknown/reward/best@32/std:0.348 - val-aux/unknown/reward/worst@32/mean:0.001 - val-aux/unknown/reward/worst@32/std:0.008 - val-aux/unknown/reward/best@64/mean:0.975 - val-aux/unknown/reward/best@64/std:0.148 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.070 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.070 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:260.789 - response_length/max:352.000 - response_length/min:219.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.587 - timing_s/old_log_prob:4.806 - timing_s/ref:7.344 - timing_s/adv:0.003 - timing_s/update_actor:21.160 - timing_s/testing:2.895 - timing_s/step:37.799 - timing_per_token_ms/gen:0.048 - timing_per_token_ms/ref:0.220 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.634 - perf/total_num_tokens:33382.000 - perf/time_per_step:37.799 - perf/throughput:883.148 - timing_s/total:3478.094
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:101 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:41.492 - global_seqlen/min:31423.000 - global_seqlen/max:31423.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31423.000 - global_seqlen/balanced_max:31423.000 - global_seqlen/mean:31423.000 - actor/kl_loss:1.861 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.008 - actor/ppo_kl:-0.109 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:7.921 - actor/grad_norm:0.060 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.243 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:245.484 - response_length/max:347.000 - response_length/min:220.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.663 - timing_s/old_log_prob:4.850 - timing_s/ref:7.305 - timing_s/adv:0.006 - timing_s/update_actor:20.931 - timing_s/step:34.758 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/ref:0.232 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.666 - perf/total_num_tokens:31423.000 - perf/time_per_step:34.758 - perf/throughput:904.044 - timing_s/total:3512.855
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:102 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.570 - global_seqlen/min:31945.000 - global_seqlen/max:31945.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31945.000 - global_seqlen/balanced_max:31945.000 - global_seqlen/mean:31945.000 - actor/kl_loss:1.820 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.021 - actor/ppo_kl:-0.067 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.069 - actor/grad_norm:0.072 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.249 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.022 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.022 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.562 - response_length/max:340.000 - response_length/min:221.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.559 - timing_s/old_log_prob:4.857 - timing_s/ref:7.317 - timing_s/adv:0.006 - timing_s/update_actor:21.184 - timing_s/step:34.927 - timing_per_token_ms/gen:0.049 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.663 - perf/total_num_tokens:31945.000 - perf/time_per_step:34.927 - perf/throughput:914.622 - timing_s/total:3547.785
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:103 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:46.305 - global_seqlen/min:32039.000 - global_seqlen/max:32039.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32039.000 - global_seqlen/balanced_max:32039.000 - global_seqlen/mean:32039.000 - actor/kl_loss:1.640 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.046 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.214 - actor/grad_norm:0.110 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.259 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:250.297 - response_length/max:343.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.534 - timing_s/old_log_prob:4.822 - timing_s/ref:7.324 - timing_s/adv:0.006 - timing_s/update_actor:21.327 - timing_s/step:35.017 - timing_per_token_ms/gen:0.048 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.666 - perf/total_num_tokens:32039.000 - perf/time_per_step:35.017 - perf/throughput:914.951 - timing_s/total:3582.805
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:104 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.930 - train/Bandit/action_is_effective:0.930 - train/Bandit/action_is_valid:0.930 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:63.523 - global_seqlen/min:34243.000 - global_seqlen/max:34243.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34243.000 - global_seqlen/balanced_max:34243.000 - global_seqlen/mean:34243.000 - actor/kl_loss:1.533 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.083 - actor/ppo_kl:-0.038 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.780 - actor/grad_norm:3.457 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.271 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.060 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.060 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:267.516 - response_length/max:346.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.606 - timing_s/old_log_prob:4.851 - timing_s/ref:7.290 - timing_s/adv:0.006 - timing_s/update_actor:21.455 - timing_s/step:35.211 - timing_per_token_ms/gen:0.047 - timing_per_token_ms/ref:0.213 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.627 - perf/total_num_tokens:34243.000 - perf/time_per_step:35.211 - perf/throughput:972.506 - timing_s/total:3618.019
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:105 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:61.734 - global_seqlen/min:34014.000 - global_seqlen/max:34014.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34014.000 - global_seqlen/balanced_max:34014.000 - global_seqlen/mean:34014.000 - actor/kl_loss:1.358 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.090 - actor/ppo_kl:-0.035 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.700 - actor/grad_norm:11.492 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.267 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.046 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.046 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:265.727 - response_length/max:343.000 - response_length/min:222.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.584 - timing_s/old_log_prob:4.846 - timing_s/ref:7.341 - timing_s/adv:0.006 - timing_s/update_actor:21.583 - timing_s/step:35.363 - timing_per_token_ms/gen:0.047 - timing_per_token_ms/ref:0.216 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.635 - perf/total_num_tokens:34014.000 - perf/time_per_step:35.363 - perf/throughput:961.852 - timing_s/total:3653.385
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:106 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.812 - global_seqlen/min:31976.000 - global_seqlen/max:31976.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31976.000 - global_seqlen/balanced_max:31976.000 - global_seqlen/mean:31976.000 - actor/kl_loss:2.363 - actor/kl_coef:0.001 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.028 - actor/ppo_kl:0.077 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:8.139 - actor/grad_norm:11.220 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.266 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.011 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.011 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:249.805 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.830 - timing_s/old_log_prob:4.791 - timing_s/ref:7.289 - timing_s/adv:0.006 - timing_s/update_actor:21.360 - timing_s/step:35.280 - timing_per_token_ms/gen:0.057 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.668 - perf/total_num_tokens:31976.000 - perf/time_per_step:35.280 - perf/throughput:906.346 - timing_s/total:3688.668
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:107 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.781 - train/Bandit/action_is_effective:0.781 - train/Bandit/action_is_valid:0.781 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:96.625 - global_seqlen/min:38480.000 - global_seqlen/max:38480.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38480.000 - global_seqlen/balanced_max:38480.000 - global_seqlen/mean:38480.000 - actor/kl_loss:1.367 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.083 - actor/ppo_kl:-0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.510 - actor/grad_norm:8.460 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.270 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.750 - critic/score/min:-2.562 - critic/rewards/mean:0.000 - critic/rewards/max:0.750 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.065 - critic/advantages/max:0.750 - critic/advantages/min:-2.562 - critic/returns/mean:-0.065 - critic/returns/max:0.750 - critic/returns/min:-2.562 - response_length/mean:300.617 - response_length/max:345.000 - response_length/min:225.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.872 - timing_s/old_log_prob:4.872 - timing_s/ref:7.329 - timing_s/adv:0.006 - timing_s/update_actor:21.547 - timing_s/step:35.630 - timing_per_token_ms/gen:0.049 - timing_per_token_ms/ref:0.190 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.560 - perf/total_num_tokens:38480.000 - perf/time_per_step:35.630 - perf/throughput:1079.990 - timing_s/total:3724.301
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:108 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.898 - train/Bandit/action_is_effective:0.898 - train/Bandit/action_is_valid:0.898 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:85.055 - global_seqlen/min:36999.000 - global_seqlen/max:36999.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36999.000 - global_seqlen/balanced_max:36999.000 - global_seqlen/mean:36999.000 - actor/kl_loss:1.675 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.061 - actor/ppo_kl:-0.006 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.327 - actor/grad_norm:8.970 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.275 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.034 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.034 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:289.047 - response_length/max:348.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.604 - timing_s/old_log_prob:4.887 - timing_s/ref:7.311 - timing_s/adv:0.006 - timing_s/update_actor:21.567 - timing_s/step:35.380 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.198 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.583 - perf/total_num_tokens:36999.000 - perf/time_per_step:35.380 - perf/throughput:1045.760 - timing_s/total:3759.684
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:109 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.898 - train/Bandit/action_is_effective:0.898 - train/Bandit/action_is_valid:0.898 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:79.117 - global_seqlen/min:36239.000 - global_seqlen/max:36239.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36239.000 - global_seqlen/balanced_max:36239.000 - global_seqlen/mean:36239.000 - actor/kl_loss:2.197 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.107 - actor/ppo_kl:-0.017 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.872 - actor/grad_norm:6.291 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.280 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.069 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.069 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:283.109 - response_length/max:349.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.545 - timing_s/old_log_prob:4.837 - timing_s/ref:7.315 - timing_s/adv:0.003 - timing_s/update_actor:21.487 - timing_s/step:35.190 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.202 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.593 - perf/total_num_tokens:36239.000 - perf/time_per_step:35.190 - perf/throughput:1029.812 - timing_s/total:3794.876
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 2.1542601585388184 seconds
[36m(TaskRunner pid=851128)[0m step:110 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:67.945 - global_seqlen/min:34809.000 - global_seqlen/max:34809.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34809.000 - global_seqlen/balanced_max:34809.000 - global_seqlen/mean:34809.000 - actor/kl_loss:1.562 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.009 - actor/ppo_kl:-0.020 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.740 - actor/grad_norm:0.084 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.279 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.840 - val-env/Bandit/action_is_effective:0.840 - val-env/Bandit/action_is_valid:0.840 - val-env/BanditTest/success:0.445 - val-env/BanditTest/num_actions:0.902 - val-env/BanditTest/action_is_effective:0.902 - val-env/BanditTest/action_is_valid:0.902 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:32.713 - val-core/unknown/reward/mean@512:0.105 - val-aux/unknown/reward/std@512:0.223 - val-aux/unknown/reward/best@2/mean:0.172 - val-aux/unknown/reward/best@2/std:0.264 - val-aux/unknown/reward/worst@2/mean:0.030 - val-aux/unknown/reward/worst@2/std:0.107 - val-aux/unknown/reward/best@4/mean:0.278 - val-aux/unknown/reward/best@4/std:0.360 - val-aux/unknown/reward/worst@4/mean:-0.016 - val-aux/unknown/reward/worst@4/std:0.080 - val-aux/unknown/reward/best@8/mean:0.405 - val-aux/unknown/reward/best@8/std:0.426 - val-aux/unknown/reward/worst@8/mean:-0.060 - val-aux/unknown/reward/worst@8/std:0.058 - val-aux/unknown/reward/best@16/mean:0.614 - val-aux/unknown/reward/best@16/std:0.445 - val-aux/unknown/reward/worst@16/mean:-0.088 - val-aux/unknown/reward/worst@16/std:0.034 - val-aux/unknown/reward/best@32/mean:0.820 - val-aux/unknown/reward/best@32/std:0.360 - val-aux/unknown/reward/worst@32/mean:-0.099 - val-aux/unknown/reward/worst@32/std:0.008 - val-aux/unknown/reward/best@64/mean:0.971 - val-aux/unknown/reward/best@64/std:0.158 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:271.938 - response_length/max:341.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.469 - timing_s/old_log_prob:4.854 - timing_s/ref:7.338 - timing_s/adv:0.006 - timing_s/update_actor:21.748 - timing_s/testing:2.486 - timing_s/step:37.905 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.211 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.625 - perf/total_num_tokens:34809.000 - perf/time_per_step:37.905 - perf/throughput:918.315 - timing_s/total:3832.784
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:111 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:69.891 - global_seqlen/min:35058.000 - global_seqlen/max:35058.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35058.000 - global_seqlen/balanced_max:35058.000 - global_seqlen/mean:35058.000 - actor/kl_loss:3.032 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.038 - actor/ppo_kl:0.031 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.758 - actor/grad_norm:0.068 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.278 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.004 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.004 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:273.883 - response_length/max:341.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.363 - timing_s/old_log_prob:4.818 - timing_s/ref:7.311 - timing_s/adv:0.006 - timing_s/update_actor:21.450 - timing_s/step:34.952 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.209 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.612 - perf/total_num_tokens:35058.000 - perf/time_per_step:34.952 - perf/throughput:1003.043 - timing_s/total:3867.738
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:112 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:65.898 - global_seqlen/min:34547.000 - global_seqlen/max:34547.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34547.000 - global_seqlen/balanced_max:34547.000 - global_seqlen/mean:34547.000 - actor/kl_loss:1.106 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.016 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.631 - actor/grad_norm:0.070 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.292 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-2.562 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.005 - critic/advantages/max:0.366 - critic/advantages/min:-2.562 - critic/returns/mean:-0.005 - critic/returns/max:0.366 - critic/returns/min:-2.562 - response_length/mean:269.891 - response_length/max:339.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.477 - timing_s/old_log_prob:4.827 - timing_s/ref:7.326 - timing_s/adv:0.006 - timing_s/update_actor:21.536 - timing_s/step:35.177 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.212 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.623 - perf/total_num_tokens:34547.000 - perf/time_per_step:35.177 - perf/throughput:982.103 - timing_s/total:3902.917
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:113 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:59.727 - global_seqlen/min:33757.000 - global_seqlen/max:33757.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33757.000 - global_seqlen/balanced_max:33757.000 - global_seqlen/mean:33757.000 - actor/kl_loss:1.340 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.106 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.571 - actor/grad_norm:3.275 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.293 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.009 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.009 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:263.719 - response_length/max:344.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.495 - timing_s/old_log_prob:4.904 - timing_s/ref:7.348 - timing_s/adv:0.006 - timing_s/update_actor:21.668 - timing_s/step:35.425 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.218 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.642 - perf/total_num_tokens:33757.000 - perf/time_per_step:35.425 - perf/throughput:952.928 - timing_s/total:3938.345
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:114 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:84.992 - global_seqlen/min:36991.000 - global_seqlen/max:36991.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36991.000 - global_seqlen/balanced_max:36991.000 - global_seqlen/mean:36991.000 - actor/kl_loss:2.545 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.025 - actor/ppo_kl:-0.068 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.349 - actor/grad_norm:0.078 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.299 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.016 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.016 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:288.984 - response_length/max:343.000 - response_length/min:219.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.625 - timing_s/old_log_prob:4.853 - timing_s/ref:7.324 - timing_s/adv:0.003 - timing_s/update_actor:21.613 - timing_s/step:35.421 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.198 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.584 - perf/total_num_tokens:36991.000 - perf/time_per_step:35.421 - perf/throughput:1044.336 - timing_s/total:3973.768
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:115 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:85.359 - global_seqlen/min:37038.000 - global_seqlen/max:37038.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37038.000 - global_seqlen/balanced_max:37038.000 - global_seqlen/mean:37038.000 - actor/kl_loss:1.645 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.029 - actor/ppo_kl:-0.041 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.306 - actor/grad_norm:0.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.300 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.026 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.026 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:289.352 - response_length/max:351.000 - response_length/min:230.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.660 - timing_s/old_log_prob:4.891 - timing_s/ref:7.339 - timing_s/adv:0.006 - timing_s/update_actor:21.827 - timing_s/step:35.726 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.198 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.589 - perf/total_num_tokens:37038.000 - perf/time_per_step:35.726 - perf/throughput:1036.738 - timing_s/total:4009.497
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:116 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:81.141 - global_seqlen/min:36498.000 - global_seqlen/max:36498.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36498.000 - global_seqlen/balanced_max:36498.000 - global_seqlen/mean:36498.000 - actor/kl_loss:1.522 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.022 - actor/ppo_kl:-0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.076 - actor/grad_norm:0.090 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.306 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.020 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.020 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:285.133 - response_length/max:346.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.581 - timing_s/old_log_prob:4.860 - timing_s/ref:7.341 - timing_s/adv:0.003 - timing_s/update_actor:21.518 - timing_s/step:35.307 - timing_per_token_ms/gen:0.043 - timing_per_token_ms/ref:0.201 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.590 - perf/total_num_tokens:36498.000 - perf/time_per_step:35.307 - perf/throughput:1033.747 - timing_s/total:4044.806
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:117 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:73.617 - global_seqlen/min:35535.000 - global_seqlen/max:35535.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35535.000 - global_seqlen/balanced_max:35535.000 - global_seqlen/mean:35535.000 - actor/kl_loss:1.571 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.015 - actor/ppo_kl:-0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.814 - actor/grad_norm:10.415 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.304 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.020 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.020 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:277.609 - response_length/max:341.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.751 - timing_s/old_log_prob:4.846 - timing_s/ref:7.353 - timing_s/adv:0.005 - timing_s/update_actor:21.624 - timing_s/step:35.581 - timing_per_token_ms/gen:0.049 - timing_per_token_ms/ref:0.207 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.609 - perf/total_num_tokens:35535.000 - perf/time_per_step:35.581 - perf/throughput:998.698 - timing_s/total:4080.390
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:118 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:65.617 - global_seqlen/min:34511.000 - global_seqlen/max:34511.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34511.000 - global_seqlen/balanced_max:34511.000 - global_seqlen/mean:34511.000 - actor/kl_loss:2.095 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.031 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.651 - actor/grad_norm:0.089 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.307 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:269.609 - response_length/max:342.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.446 - timing_s/old_log_prob:4.779 - timing_s/ref:7.293 - timing_s/adv:0.006 - timing_s/update_actor:21.487 - timing_s/step:35.015 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.211 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.623 - perf/total_num_tokens:34511.000 - perf/time_per_step:35.015 - perf/throughput:985.607 - timing_s/total:4115.408
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:119 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:95.438 - global_seqlen/min:38328.000 - global_seqlen/max:38328.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38328.000 - global_seqlen/balanced_max:38328.000 - global_seqlen/mean:38328.000 - actor/kl_loss:2.013 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.033 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.473 - actor/grad_norm:10.074 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.310 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.034 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.034 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:299.430 - response_length/max:348.000 - response_length/min:223.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.567 - timing_s/old_log_prob:4.886 - timing_s/ref:7.359 - timing_s/adv:0.003 - timing_s/update_actor:21.322 - timing_s/step:35.140 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.192 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.556 - perf/total_num_tokens:38328.000 - perf/time_per_step:35.140 - perf/throughput:1090.731 - timing_s/total:4150.550
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.482530355453491 seconds
[36m(TaskRunner pid=851128)[0m step:120 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:88.984 - global_seqlen/min:37502.000 - global_seqlen/max:37502.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37502.000 - global_seqlen/balanced_max:37502.000 - global_seqlen/mean:37502.000 - actor/kl_loss:1.785 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.028 - actor/ppo_kl:0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.169 - actor/grad_norm:0.077 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.312 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.223 - val-env/Bandit/action_is_effective:0.223 - val-env/Bandit/action_is_valid:0.223 - val-env/BanditTest/success:0.102 - val-env/BanditTest/num_actions:0.262 - val-env/BanditTest/action_is_effective:0.262 - val-env/BanditTest/action_is_valid:0.262 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:106.213 - val-core/unknown/reward/mean@512:-0.051 - val-aux/unknown/reward/std@512:0.113 - val-aux/unknown/reward/best@2/mean:-0.014 - val-aux/unknown/reward/best@2/std:0.134 - val-aux/unknown/reward/worst@2/mean:-0.091 - val-aux/unknown/reward/worst@2/std:0.040 - val-aux/unknown/reward/best@4/mean:0.053 - val-aux/unknown/reward/best@4/std:0.184 - val-aux/unknown/reward/worst@4/mean:-0.099 - val-aux/unknown/reward/worst@4/std:0.011 - val-aux/unknown/reward/best@8/mean:0.110 - val-aux/unknown/reward/best@8/std:0.204 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:0.179 - val-aux/unknown/reward/best@16/std:0.266 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.248 - val-aux/unknown/reward/best@32/std:0.334 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.375 - val-aux/unknown/reward/best@64/std:0.414 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.571 - val-aux/unknown/reward/best@128/std:0.450 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:0.794 - val-aux/unknown/reward/best@256/std:0.378 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.007 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.007 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:292.977 - response_length/max:341.000 - response_length/min:242.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.557 - timing_s/old_log_prob:4.869 - timing_s/ref:7.334 - timing_s/adv:0.006 - timing_s/update_actor:21.264 - timing_s/testing:3.811 - timing_s/step:38.845 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.196 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.567 - perf/total_num_tokens:37502.000 - perf/time_per_step:38.845 - perf/throughput:965.426 - timing_s/total:4189.397
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:121 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:89.875 - global_seqlen/min:37616.000 - global_seqlen/max:37616.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37616.000 - global_seqlen/balanced_max:37616.000 - global_seqlen/mean:37616.000 - actor/kl_loss:2.210 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.007 - actor/ppo_kl:0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.177 - actor/grad_norm:0.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.335 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.000 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.000 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:293.867 - response_length/max:336.000 - response_length/min:238.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.431 - timing_s/old_log_prob:4.768 - timing_s/ref:7.325 - timing_s/adv:0.003 - timing_s/update_actor:21.001 - timing_s/step:34.530 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.195 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.558 - perf/total_num_tokens:37616.000 - perf/time_per_step:34.530 - perf/throughput:1089.378 - timing_s/total:4223.928
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:122 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:87.438 - global_seqlen/min:37304.000 - global_seqlen/max:37304.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37304.000 - global_seqlen/balanced_max:37304.000 - global_seqlen/mean:37304.000 - actor/kl_loss:1.723 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.012 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.253 - actor/grad_norm:0.067 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.339 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.005 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.005 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:291.430 - response_length/max:340.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.530 - timing_s/old_log_prob:4.853 - timing_s/ref:7.320 - timing_s/adv:0.003 - timing_s/update_actor:21.072 - timing_s/step:34.780 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.196 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.565 - perf/total_num_tokens:37304.000 - perf/time_per_step:34.780 - perf/throughput:1072.560 - timing_s/total:4258.711
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:123 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:100.180 - global_seqlen/min:38935.000 - global_seqlen/max:38935.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38935.000 - global_seqlen/balanced_max:38935.000 - global_seqlen/mean:38935.000 - actor/kl_loss:1.548 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.050 - actor/ppo_kl:-0.008 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.511 - actor/grad_norm:11.221 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.337 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.032 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.032 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:304.172 - response_length/max:348.000 - response_length/min:238.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.554 - timing_s/old_log_prob:4.825 - timing_s/ref:7.320 - timing_s/adv:0.003 - timing_s/update_actor:21.093 - timing_s/step:34.798 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.188 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.542 - perf/total_num_tokens:38935.000 - perf/time_per_step:34.798 - perf/throughput:1118.898 - timing_s/total:4293.511
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:124 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:94.211 - global_seqlen/min:38171.000 - global_seqlen/max:38171.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38171.000 - global_seqlen/balanced_max:38171.000 - global_seqlen/mean:38171.000 - actor/kl_loss:1.489 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.044 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.382 - actor/grad_norm:2.776 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.337 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.026 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.026 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:298.203 - response_length/max:352.000 - response_length/min:251.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.561 - timing_s/old_log_prob:4.849 - timing_s/ref:7.339 - timing_s/adv:0.006 - timing_s/update_actor:21.074 - timing_s/step:34.831 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.192 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.552 - perf/total_num_tokens:38171.000 - perf/time_per_step:34.831 - perf/throughput:1095.877 - timing_s/total:4328.346
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:125 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:77.961 - global_seqlen/min:36091.000 - global_seqlen/max:36091.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36091.000 - global_seqlen/balanced_max:36091.000 - global_seqlen/mean:36091.000 - actor/kl_loss:1.570 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.018 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:8.962 - actor/grad_norm:0.081 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.335 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:281.953 - response_length/max:326.000 - response_length/min:245.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.417 - timing_s/old_log_prob:4.802 - timing_s/ref:7.340 - timing_s/adv:0.006 - timing_s/update_actor:21.234 - timing_s/step:34.804 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.203 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.588 - perf/total_num_tokens:36091.000 - perf/time_per_step:34.804 - perf/throughput:1036.987 - timing_s/total:4363.152
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:126 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:91.695 - global_seqlen/min:37849.000 - global_seqlen/max:37849.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37849.000 - global_seqlen/balanced_max:37849.000 - global_seqlen/mean:37849.000 - actor/kl_loss:1.766 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.036 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.403 - actor/grad_norm:0.059 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.335 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:295.688 - response_length/max:336.000 - response_length/min:255.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.471 - timing_s/old_log_prob:4.844 - timing_s/ref:7.343 - timing_s/adv:0.003 - timing_s/update_actor:21.258 - timing_s/step:34.922 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.194 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.562 - perf/total_num_tokens:37849.000 - perf/time_per_step:34.922 - perf/throughput:1083.825 - timing_s/total:4398.077
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:127 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.523 - train/Bandit/action_is_effective:0.523 - train/Bandit/action_is_valid:0.523 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:129.836 - global_seqlen/min:42731.000 - global_seqlen/max:42731.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42731.000 - global_seqlen/balanced_max:42731.000 - global_seqlen/mean:42731.000 - actor/kl_loss:2.028 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.043 - actor/ppo_kl:0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:10.082 - actor/grad_norm:8.380 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.334 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:1.436 - critic/score/min:-1.250 - critic/rewards/mean:0.000 - critic/rewards/max:1.436 - critic/rewards/min:-1.250 - critic/advantages/mean:-0.026 - critic/advantages/max:1.436 - critic/advantages/min:-1.250 - critic/returns/mean:-0.026 - critic/returns/max:1.436 - critic/returns/min:-1.250 - response_length/mean:333.828 - response_length/max:353.000 - response_length/min:283.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.880 - timing_s/old_log_prob:4.856 - timing_s/ref:7.329 - timing_s/adv:0.006 - timing_s/update_actor:21.323 - timing_s/step:35.398 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:42731.000 - perf/time_per_step:35.398 - perf/throughput:1207.171 - timing_s/total:4433.477
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:128 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.562 - train/Bandit/action_is_effective:0.562 - train/Bandit/action_is_valid:0.562 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:129.844 - global_seqlen/min:42732.000 - global_seqlen/max:42732.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42732.000 - global_seqlen/balanced_max:42732.000 - global_seqlen/mean:42732.000 - actor/kl_loss:1.413 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.053 - actor/ppo_kl:0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.997 - actor/grad_norm:7.680 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.346 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:1.250 - critic/score/min:-1.436 - critic/rewards/mean:-0.000 - critic/rewards/max:1.250 - critic/rewards/min:-1.436 - critic/advantages/mean:-0.024 - critic/advantages/max:1.250 - critic/advantages/min:-1.436 - critic/returns/mean:-0.024 - critic/returns/max:1.250 - critic/returns/min:-1.436 - response_length/mean:333.836 - response_length/max:351.000 - response_length/min:283.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.653 - timing_s/old_log_prob:4.836 - timing_s/ref:7.310 - timing_s/adv:0.007 - timing_s/update_actor:21.245 - timing_s/step:35.054 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.171 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.497 - perf/total_num_tokens:42732.000 - perf/time_per_step:35.054 - perf/throughput:1219.050 - timing_s/total:4468.533
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:129 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.875 - train/Bandit/action_is_effective:0.875 - train/Bandit/action_is_valid:0.875 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:117.602 - global_seqlen/min:41165.000 - global_seqlen/max:41165.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41165.000 - global_seqlen/balanced_max:41165.000 - global_seqlen/mean:41165.000 - actor/kl_loss:1.530 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.055 - actor/ppo_kl:-0.007 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.652 - actor/grad_norm:12.840 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.352 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.023 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.023 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:321.594 - response_length/max:348.000 - response_length/min:278.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.632 - timing_s/old_log_prob:4.862 - timing_s/ref:7.323 - timing_s/adv:0.006 - timing_s/update_actor:21.282 - timing_s/step:35.108 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.517 - perf/total_num_tokens:41165.000 - perf/time_per_step:35.108 - perf/throughput:1172.517 - timing_s/total:4503.644
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 4.077573776245117 seconds
[36m(TaskRunner pid=851128)[0m step:130 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:109.109 - global_seqlen/min:40078.000 - global_seqlen/max:40078.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40078.000 - global_seqlen/balanced_max:40078.000 - global_seqlen/mean:40078.000 - actor/kl_loss:1.646 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.042 - actor/ppo_kl:0.031 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.389 - actor/grad_norm:0.079 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.347 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.039 - val-env/Bandit/action_is_effective:0.039 - val-env/Bandit/action_is_valid:0.039 - val-env/BanditTest/success:0.012 - val-env/BanditTest/num_actions:0.035 - val-env/BanditTest/action_is_effective:0.035 - val-env/BanditTest/action_is_valid:0.035 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:130.465 - val-core/unknown/reward/mean@512:-0.093 - val-aux/unknown/reward/std@512:0.036 - val-aux/unknown/reward/best@2/mean:-0.085 - val-aux/unknown/reward/best@2/std:0.051 - val-aux/unknown/reward/worst@2/mean:-0.100 - val-aux/unknown/reward/worst@2/std:0.009 - val-aux/unknown/reward/best@4/mean:-0.075 - val-aux/unknown/reward/best@4/std:0.065 - val-aux/unknown/reward/worst@4/mean:-0.100 - val-aux/unknown/reward/worst@4/std:0.000 - val-aux/unknown/reward/best@8/mean:-0.050 - val-aux/unknown/reward/best@8/std:0.085 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:-0.011 - val-aux/unknown/reward/best@16/std:0.097 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.037 - val-aux/unknown/reward/best@32/std:0.089 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.081 - val-aux/unknown/reward/best@64/std:0.055 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.099 - val-aux/unknown/reward/best@128/std:0.013 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:0.100 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:0.100 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.021 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.021 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:313.102 - response_length/max:348.000 - response_length/min:273.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.604 - timing_s/old_log_prob:4.948 - timing_s/ref:7.299 - timing_s/adv:0.006 - timing_s/update_actor:21.150 - timing_s/testing:4.396 - timing_s/step:39.406 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.182 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.528 - perf/total_num_tokens:40078.000 - perf/time_per_step:39.406 - perf/throughput:1017.065 - timing_s/total:4543.051
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:131 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:101.133 - global_seqlen/min:39057.000 - global_seqlen/max:39057.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39057.000 - global_seqlen/balanced_max:39057.000 - global_seqlen/mean:39057.000 - actor/kl_loss:1.868 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.022 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.448 - actor/grad_norm:0.066 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.346 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.007 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.007 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:305.125 - response_length/max:343.000 - response_length/min:265.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.444 - timing_s/old_log_prob:4.797 - timing_s/ref:7.311 - timing_s/adv:0.003 - timing_s/update_actor:21.285 - timing_s/step:34.842 - timing_per_token_ms/gen:0.037 - timing_per_token_ms/ref:0.187 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.545 - perf/total_num_tokens:39057.000 - perf/time_per_step:34.842 - perf/throughput:1120.966 - timing_s/total:4577.896
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:132 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.930 - train/Bandit/action_is_effective:0.930 - train/Bandit/action_is_valid:0.930 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:109.062 - global_seqlen/min:40072.000 - global_seqlen/max:40072.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40072.000 - global_seqlen/balanced_max:40072.000 - global_seqlen/mean:40072.000 - actor/kl_loss:2.066 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.021 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.438 - actor/grad_norm:7.866 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.352 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.016 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.016 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:313.055 - response_length/max:348.000 - response_length/min:275.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.588 - timing_s/old_log_prob:4.875 - timing_s/ref:7.291 - timing_s/adv:0.003 - timing_s/update_actor:21.207 - timing_s/step:34.967 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.182 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.529 - perf/total_num_tokens:40072.000 - perf/time_per_step:34.967 - perf/throughput:1145.996 - timing_s/total:4612.866
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:133 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.898 - train/Bandit/action_is_effective:0.898 - train/Bandit/action_is_valid:0.898 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:115.211 - global_seqlen/min:40859.000 - global_seqlen/max:40859.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40859.000 - global_seqlen/balanced_max:40859.000 - global_seqlen/mean:40859.000 - actor/kl_loss:1.454 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.038 - actor/ppo_kl:0.007 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.454 - actor/grad_norm:2.714 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.322 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.653 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.653 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.019 - critic/advantages/max:0.653 - critic/advantages/min:-3.750 - critic/returns/mean:-0.019 - critic/returns/max:0.653 - critic/returns/min:-3.750 - response_length/mean:319.203 - response_length/max:348.000 - response_length/min:270.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.867 - timing_s/old_log_prob:4.835 - timing_s/ref:7.308 - timing_s/adv:0.005 - timing_s/update_actor:21.244 - timing_s/step:35.261 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.179 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.520 - perf/total_num_tokens:40859.000 - perf/time_per_step:35.261 - perf/throughput:1158.757 - timing_s/total:4648.130
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:134 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.953 - train/Bandit/action_is_effective:0.953 - train/Bandit/action_is_valid:0.953 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:110.266 - global_seqlen/min:40226.000 - global_seqlen/max:40226.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40226.000 - global_seqlen/balanced_max:40226.000 - global_seqlen/mean:40226.000 - actor/kl_loss:1.438 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.023 - actor/ppo_kl:0.031 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.233 - actor/grad_norm:3.049 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.344 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:314.258 - response_length/max:349.000 - response_length/min:270.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.631 - timing_s/old_log_prob:4.843 - timing_s/ref:7.319 - timing_s/adv:0.003 - timing_s/update_actor:21.370 - timing_s/step:35.169 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.182 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.531 - perf/total_num_tokens:40226.000 - perf/time_per_step:35.169 - perf/throughput:1143.797 - timing_s/total:4683.302
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:135 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:91.570 - global_seqlen/min:37833.000 - global_seqlen/max:37833.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37833.000 - global_seqlen/balanced_max:37833.000 - global_seqlen/mean:37833.000 - actor/kl_loss:1.895 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.127 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.138 - actor/grad_norm:0.078 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.343 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:295.562 - response_length/max:335.000 - response_length/min:250.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.480 - timing_s/old_log_prob:4.865 - timing_s/ref:7.331 - timing_s/adv:0.003 - timing_s/update_actor:20.617 - timing_s/step:34.300 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.194 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.545 - perf/total_num_tokens:37833.000 - perf/time_per_step:34.300 - perf/throughput:1103.000 - timing_s/total:4717.606
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:136 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.758 - train/Bandit/action_is_effective:0.758 - train/Bandit/action_is_valid:0.758 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:125.758 - global_seqlen/min:42209.000 - global_seqlen/max:42209.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42209.000 - global_seqlen/balanced_max:42209.000 - global_seqlen/mean:42209.000 - actor/kl_loss:1.157 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.044 - actor/ppo_kl:-0.033 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.739 - actor/grad_norm:7.870 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.350 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:1.098 - critic/score/min:-2.562 - critic/rewards/mean:0.000 - critic/rewards/max:1.098 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.020 - critic/advantages/max:1.098 - critic/advantages/min:-2.562 - critic/returns/mean:-0.020 - critic/returns/max:1.098 - critic/returns/min:-2.562 - response_length/mean:329.750 - response_length/max:350.000 - response_length/min:296.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.647 - timing_s/old_log_prob:4.893 - timing_s/ref:7.335 - timing_s/adv:0.007 - timing_s/update_actor:21.045 - timing_s/step:34.929 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:42209.000 - perf/time_per_step:34.929 - perf/throughput:1208.418 - timing_s/total:4752.538
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:137 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.844 - train/Bandit/action_is_effective:0.844 - train/Bandit/action_is_valid:0.844 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:121.523 - global_seqlen/min:41667.000 - global_seqlen/max:41667.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41667.000 - global_seqlen/balanced_max:41667.000 - global_seqlen/mean:41667.000 - actor/kl_loss:1.492 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.060 - actor/ppo_kl:-0.042 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.440 - actor/grad_norm:8.442 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.353 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.021 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.021 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:325.508 - response_length/max:349.000 - response_length/min:292.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.661 - timing_s/old_log_prob:4.888 - timing_s/ref:7.323 - timing_s/adv:0.006 - timing_s/update_actor:20.645 - timing_s/step:34.526 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.495 - perf/total_num_tokens:41667.000 - perf/time_per_step:34.526 - perf/throughput:1206.838 - timing_s/total:4787.066
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:138 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:111.703 - global_seqlen/min:40410.000 - global_seqlen/max:40410.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40410.000 - global_seqlen/balanced_max:40410.000 - global_seqlen/mean:40410.000 - actor/kl_loss:1.539 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.020 - actor/ppo_kl:0.024 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.410 - actor/grad_norm:3.394 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.363 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:315.695 - response_length/max:345.000 - response_length/min:278.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.597 - timing_s/old_log_prob:4.824 - timing_s/ref:7.333 - timing_s/adv:0.006 - timing_s/update_actor:21.187 - timing_s/step:34.950 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.181 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.524 - perf/total_num_tokens:40410.000 - perf/time_per_step:34.950 - perf/throughput:1156.208 - timing_s/total:4822.018
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:139 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:106.445 - global_seqlen/min:39737.000 - global_seqlen/max:39737.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39737.000 - global_seqlen/balanced_max:39737.000 - global_seqlen/mean:39737.000 - actor/kl_loss:1.509 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.011 - actor/ppo_kl:-0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.442 - actor/grad_norm:0.057 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.366 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.003 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.003 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:310.438 - response_length/max:346.000 - response_length/min:277.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.841 - timing_s/old_log_prob:4.900 - timing_s/ref:7.372 - timing_s/adv:0.007 - timing_s/update_actor:20.986 - timing_s/step:35.109 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.186 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.528 - perf/total_num_tokens:39737.000 - perf/time_per_step:35.109 - perf/throughput:1131.831 - timing_s/total:4857.130
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.9048259258270264 seconds
[36m(TaskRunner pid=851128)[0m step:140 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:108.445 - global_seqlen/min:39993.000 - global_seqlen/max:39993.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39993.000 - global_seqlen/balanced_max:39993.000 - global_seqlen/mean:39993.000 - actor/kl_loss:1.762 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.015 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.572 - actor/grad_norm:11.052 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.364 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.023 - val-env/Bandit/action_is_effective:0.023 - val-env/Bandit/action_is_valid:0.023 - val-env/BanditTest/success:0.008 - val-env/BanditTest/num_actions:0.008 - val-env/BanditTest/action_is_effective:0.008 - val-env/BanditTest/action_is_valid:0.008 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:131.914 - val-core/unknown/reward/mean@512:-0.095 - val-aux/unknown/reward/std@512:0.053 - val-aux/unknown/reward/best@2/mean:-0.093 - val-aux/unknown/reward/best@2/std:0.058 - val-aux/unknown/reward/worst@2/mean:-0.100 - val-aux/unknown/reward/worst@2/std:0.000 - val-aux/unknown/reward/best@4/mean:-0.079 - val-aux/unknown/reward/best@4/std:0.108 - val-aux/unknown/reward/worst@4/mean:-0.100 - val-aux/unknown/reward/worst@4/std:0.000 - val-aux/unknown/reward/best@8/mean:-0.063 - val-aux/unknown/reward/best@8/std:0.144 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:-0.028 - val-aux/unknown/reward/best@16/std:0.199 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.035 - val-aux/unknown/reward/best@32/std:0.266 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.129 - val-aux/unknown/reward/best@64/std:0.327 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.289 - val-aux/unknown/reward/best@128/std:0.406 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:0.447 - val-aux/unknown/reward/best@256/std:0.444 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.007 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.007 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:312.430 - response_length/max:346.000 - response_length/min:249.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.607 - timing_s/old_log_prob:4.852 - timing_s/ref:7.271 - timing_s/adv:0.006 - timing_s/update_actor:20.845 - timing_s/testing:4.272 - timing_s/step:38.856 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.182 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.521 - perf/total_num_tokens:39993.000 - perf/time_per_step:38.856 - perf/throughput:1029.256 - timing_s/total:4895.988
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:141 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.867 - train/Bandit/action_is_effective:0.867 - train/Bandit/action_is_valid:0.867 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:114.352 - global_seqlen/min:40749.000 - global_seqlen/max:40749.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40749.000 - global_seqlen/balanced_max:40749.000 - global_seqlen/mean:40749.000 - actor/kl_loss:1.672 - actor/kl_coef:0.001 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.056 - actor/ppo_kl:0.025 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:9.553 - actor/grad_norm:24.843 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.383 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:318.344 - response_length/max:345.000 - response_length/min:275.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.497 - timing_s/old_log_prob:4.826 - timing_s/ref:7.323 - timing_s/adv:0.003 - timing_s/update_actor:20.982 - timing_s/step:34.633 - timing_per_token_ms/gen:0.037 - timing_per_token_ms/ref:0.180 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.515 - perf/total_num_tokens:40749.000 - perf/time_per_step:34.633 - perf/throughput:1176.580 - timing_s/total:4930.624
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:142 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:117.320 - global_seqlen/min:41129.000 - global_seqlen/max:41129.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41129.000 - global_seqlen/balanced_max:41129.000 - global_seqlen/mean:41129.000 - actor/kl_loss:1.721 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.046 - actor/ppo_kl:-0.067 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.645 - actor/grad_norm:10.529 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.358 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:321.312 - response_length/max:348.000 - response_length/min:269.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.632 - timing_s/old_log_prob:4.916 - timing_s/ref:7.362 - timing_s/adv:0.006 - timing_s/update_actor:20.822 - timing_s/step:34.741 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.179 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.506 - perf/total_num_tokens:41129.000 - perf/time_per_step:34.741 - perf/throughput:1183.867 - timing_s/total:4965.367
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:143 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:115.195 - global_seqlen/min:40857.000 - global_seqlen/max:40857.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40857.000 - global_seqlen/balanced_max:40857.000 - global_seqlen/mean:40857.000 - actor/kl_loss:1.458 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.039 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.485 - actor/grad_norm:15.373 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.358 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.017 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.017 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:319.180 - response_length/max:349.000 - response_length/min:273.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.622 - timing_s/old_log_prob:4.870 - timing_s/ref:7.307 - timing_s/adv:0.003 - timing_s/update_actor:21.109 - timing_s/step:34.913 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.179 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.517 - perf/total_num_tokens:40857.000 - perf/time_per_step:34.913 - perf/throughput:1170.269 - timing_s/total:5000.282
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:144 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:109.547 - global_seqlen/min:40134.000 - global_seqlen/max:40134.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40134.000 - global_seqlen/balanced_max:40134.000 - global_seqlen/mean:40134.000 - actor/kl_loss:1.908 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.017 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.374 - actor/grad_norm:0.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.379 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:313.539 - response_length/max:343.000 - response_length/min:278.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.635 - timing_s/old_log_prob:4.899 - timing_s/ref:7.292 - timing_s/adv:0.006 - timing_s/update_actor:20.753 - timing_s/step:34.588 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.182 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.517 - perf/total_num_tokens:40134.000 - perf/time_per_step:34.588 - perf/throughput:1160.339 - timing_s/total:5034.873
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:145 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.906 - train/Bandit/action_is_effective:0.906 - train/Bandit/action_is_valid:0.906 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:124.117 - global_seqlen/min:41999.000 - global_seqlen/max:41999.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41999.000 - global_seqlen/balanced_max:41999.000 - global_seqlen/mean:41999.000 - actor/kl_loss:1.535 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.016 - actor/ppo_kl:0.008 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.552 - actor/grad_norm:0.074 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.377 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:328.109 - response_length/max:351.000 - response_length/min:297.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.655 - timing_s/old_log_prob:4.877 - timing_s/ref:7.324 - timing_s/adv:0.003 - timing_s/update_actor:20.974 - timing_s/step:34.835 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:41999.000 - perf/time_per_step:34.835 - perf/throughput:1205.640 - timing_s/total:5069.712
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:146 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.844 - train/Bandit/action_is_effective:0.844 - train/Bandit/action_is_valid:0.844 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.320 - global_seqlen/min:42281.000 - global_seqlen/max:42281.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42281.000 - global_seqlen/balanced_max:42281.000 - global_seqlen/mean:42281.000 - actor/kl_loss:1.789 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.043 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.574 - actor/grad_norm:10.850 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.376 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.014 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.014 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:330.305 - response_length/max:345.000 - response_length/min:295.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.949 - timing_s/old_log_prob:4.854 - timing_s/ref:7.328 - timing_s/adv:0.006 - timing_s/update_actor:21.176 - timing_s/step:35.316 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.501 - perf/total_num_tokens:42281.000 - perf/time_per_step:35.316 - perf/throughput:1197.218 - timing_s/total:5105.030
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:147 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.836 - train/Bandit/action_is_effective:0.836 - train/Bandit/action_is_valid:0.836 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:127.148 - global_seqlen/min:42387.000 - global_seqlen/max:42387.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42387.000 - global_seqlen/balanced_max:42387.000 - global_seqlen/mean:42387.000 - actor/kl_loss:1.879 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.040 - actor/ppo_kl:0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.654 - actor/grad_norm:6.361 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.377 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-2.562 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.014 - critic/advantages/max:0.559 - critic/advantages/min:-2.562 - critic/returns/mean:-0.014 - critic/returns/max:0.559 - critic/returns/min:-2.562 - response_length/mean:331.133 - response_length/max:346.000 - response_length/min:302.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.660 - timing_s/old_log_prob:4.903 - timing_s/ref:7.338 - timing_s/adv:0.006 - timing_s/update_actor:20.849 - timing_s/step:34.760 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.492 - perf/total_num_tokens:42387.000 - perf/time_per_step:34.760 - perf/throughput:1219.425 - timing_s/total:5139.792
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:148 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:120.133 - global_seqlen/min:41489.000 - global_seqlen/max:41489.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41489.000 - global_seqlen/balanced_max:41489.000 - global_seqlen/mean:41489.000 - actor/kl_loss:1.220 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.044 - actor/ppo_kl:0.006 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.379 - actor/grad_norm:11.644 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.386 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.013 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.013 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:324.109 - response_length/max:344.000 - response_length/min:235.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.637 - timing_s/old_log_prob:4.879 - timing_s/ref:7.317 - timing_s/adv:0.003 - timing_s/update_actor:20.715 - timing_s/step:34.552 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:41489.000 - perf/time_per_step:34.552 - perf/throughput:1200.755 - timing_s/total:5174.348
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:149 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:119.852 - global_seqlen/min:41453.000 - global_seqlen/max:41453.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41453.000 - global_seqlen/balanced_max:41453.000 - global_seqlen/mean:41453.000 - actor/kl_loss:1.407 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.016 - actor/ppo_kl:0.018 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.446 - actor/grad_norm:0.074 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.382 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:323.844 - response_length/max:347.000 - response_length/min:289.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.662 - timing_s/old_log_prob:4.851 - timing_s/ref:7.349 - timing_s/adv:0.003 - timing_s/update_actor:21.152 - timing_s/step:35.020 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.177 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.510 - perf/total_num_tokens:41453.000 - perf/time_per_step:35.020 - perf/throughput:1183.701 - timing_s/total:5209.370
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.569603443145752 seconds
[36m(TaskRunner pid=851128)[0m step:150 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.867 - train/Bandit/action_is_effective:0.867 - train/Bandit/action_is_valid:0.867 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.266 - global_seqlen/min:42274.000 - global_seqlen/max:42274.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42274.000 - global_seqlen/balanced_max:42274.000 - global_seqlen/mean:42274.000 - actor/kl_loss:0.828 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.033 - actor/ppo_kl:0.078 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.314 - actor/grad_norm:10.967 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.387 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.047 - val-env/Bandit/action_is_effective:0.047 - val-env/Bandit/action_is_valid:0.047 - val-env/BanditTest/success:0.039 - val-env/BanditTest/num_actions:0.055 - val-env/BanditTest/action_is_effective:0.055 - val-env/BanditTest/action_is_valid:0.055 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:129.057 - val-core/unknown/reward/mean@512:-0.088 - val-aux/unknown/reward/std@512:0.077 - val-aux/unknown/reward/best@2/mean:-0.076 - val-aux/unknown/reward/best@2/std:0.108 - val-aux/unknown/reward/worst@2/mean:-0.100 - val-aux/unknown/reward/worst@2/std:0.006 - val-aux/unknown/reward/best@4/mean:-0.056 - val-aux/unknown/reward/best@4/std:0.138 - val-aux/unknown/reward/worst@4/mean:-0.100 - val-aux/unknown/reward/worst@4/std:0.000 - val-aux/unknown/reward/best@8/mean:-0.017 - val-aux/unknown/reward/best@8/std:0.194 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:0.049 - val-aux/unknown/reward/best@16/std:0.250 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.165 - val-aux/unknown/reward/best@32/std:0.329 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.297 - val-aux/unknown/reward/best@64/std:0.389 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.457 - val-aux/unknown/reward/best@128/std:0.442 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:0.684 - val-aux/unknown/reward/best@256/std:0.430 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:330.250 - response_length/max:349.000 - response_length/min:301.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.880 - timing_s/old_log_prob:4.870 - timing_s/ref:7.332 - timing_s/adv:0.003 - timing_s/update_actor:20.798 - timing_s/testing:3.892 - timing_s/step:38.778 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.492 - perf/total_num_tokens:42274.000 - perf/time_per_step:38.778 - perf/throughput:1090.153 - timing_s/total:5248.149
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:151 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:120.258 - global_seqlen/min:41505.000 - global_seqlen/max:41505.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41505.000 - global_seqlen/balanced_max:41505.000 - global_seqlen/mean:41505.000 - actor/kl_loss:1.554 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.018 - actor/ppo_kl:0.012 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.237 - actor/grad_norm:24.585 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.396 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.006 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.006 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:324.250 - response_length/max:348.000 - response_length/min:296.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.762 - timing_s/old_log_prob:4.883 - timing_s/ref:7.372 - timing_s/adv:0.003 - timing_s/update_actor:21.307 - timing_s/step:35.329 - timing_per_token_ms/gen:0.042 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.513 - perf/total_num_tokens:41505.000 - perf/time_per_step:35.329 - perf/throughput:1174.810 - timing_s/total:5283.480
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:152 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:118.203 - global_seqlen/min:41242.000 - global_seqlen/max:41242.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41242.000 - global_seqlen/balanced_max:41242.000 - global_seqlen/mean:41242.000 - actor/kl_loss:1.862 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.014 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.428 - actor/grad_norm:0.055 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.398 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:322.195 - response_length/max:344.000 - response_length/min:283.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.608 - timing_s/old_log_prob:4.839 - timing_s/ref:7.332 - timing_s/adv:0.007 - timing_s/update_actor:21.170 - timing_s/step:34.958 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.513 - perf/total_num_tokens:41242.000 - perf/time_per_step:34.958 - perf/throughput:1179.762 - timing_s/total:5318.440
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:153 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.695 - train/Bandit/action_is_effective:0.695 - train/Bandit/action_is_valid:0.695 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:130.844 - global_seqlen/min:42860.000 - global_seqlen/max:42860.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42860.000 - global_seqlen/balanced_max:42860.000 - global_seqlen/mean:42860.000 - actor/kl_loss:1.165 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.025 - actor/ppo_kl:0.016 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.736 - actor/grad_norm:7.662 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.397 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.854 - critic/score/min:-2.016 - critic/rewards/mean:0.000 - critic/rewards/max:0.854 - critic/rewards/min:-2.016 - critic/advantages/mean:-0.013 - critic/advantages/max:0.854 - critic/advantages/min:-2.016 - critic/returns/mean:-0.013 - critic/returns/max:0.854 - critic/returns/min:-2.016 - response_length/mean:334.828 - response_length/max:349.000 - response_length/min:297.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.649 - timing_s/old_log_prob:4.831 - timing_s/ref:7.321 - timing_s/adv:0.003 - timing_s/update_actor:20.820 - timing_s/step:34.626 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.171 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.486 - perf/total_num_tokens:42860.000 - perf/time_per_step:34.626 - perf/throughput:1237.796 - timing_s/total:5353.069
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:154 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.766 - train/Bandit/action_is_effective:0.766 - train/Bandit/action_is_valid:0.766 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:129.680 - global_seqlen/min:42711.000 - global_seqlen/max:42711.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42711.000 - global_seqlen/balanced_max:42711.000 - global_seqlen/mean:42711.000 - actor/kl_loss:0.684 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.046 - actor/ppo_kl:0.021 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.619 - actor/grad_norm:6.306 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.795 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.854 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.854 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.011 - critic/advantages/max:0.854 - critic/advantages/min:-3.750 - critic/returns/mean:-0.011 - critic/returns/max:0.854 - critic/returns/min:-3.750 - response_length/mean:333.672 - response_length/max:346.000 - response_length/min:296.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.691 - timing_s/old_log_prob:4.845 - timing_s/ref:7.648 - timing_s/adv:0.006 - timing_s/update_actor:20.629 - timing_s/step:34.821 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.179 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.483 - perf/total_num_tokens:42711.000 - perf/time_per_step:34.821 - perf/throughput:1226.575 - timing_s/total:5387.893
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:155 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.914 - global_seqlen/min:42357.000 - global_seqlen/max:42357.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42357.000 - global_seqlen/balanced_max:42357.000 - global_seqlen/mean:42357.000 - actor/kl_loss:1.723 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.024 - actor/ppo_kl:0.007 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.651 - actor/grad_norm:3.193 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.818 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:330.906 - response_length/max:346.000 - response_length/min:300.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.881 - timing_s/old_log_prob:4.837 - timing_s/ref:7.331 - timing_s/adv:0.006 - timing_s/update_actor:21.227 - timing_s/step:35.285 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.501 - perf/total_num_tokens:42357.000 - perf/time_per_step:35.285 - perf/throughput:1200.417 - timing_s/total:5423.182
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:156 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:123.641 - global_seqlen/min:41938.000 - global_seqlen/max:41938.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41938.000 - global_seqlen/balanced_max:41938.000 - global_seqlen/mean:41938.000 - actor/kl_loss:0.986 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.019 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.513 - actor/grad_norm:15.166 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.849 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.003 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.003 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:327.633 - response_length/max:343.000 - response_length/min:301.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.661 - timing_s/old_log_prob:4.867 - timing_s/ref:7.339 - timing_s/adv:0.006 - timing_s/update_actor:21.195 - timing_s/step:35.071 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.175 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.505 - perf/total_num_tokens:41938.000 - perf/time_per_step:35.071 - perf/throughput:1195.801 - timing_s/total:5458.255
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:157 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.859 - global_seqlen/min:42350.000 - global_seqlen/max:42350.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42350.000 - global_seqlen/balanced_max:42350.000 - global_seqlen/mean:42350.000 - actor/kl_loss:1.509 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.017 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.483 - actor/grad_norm:2.451 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.873 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.005 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.005 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:330.844 - response_length/max:345.000 - response_length/min:311.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.650 - timing_s/old_log_prob:4.865 - timing_s/ref:7.355 - timing_s/adv:0.005 - timing_s/update_actor:21.087 - timing_s/step:34.966 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.498 - perf/total_num_tokens:42350.000 - perf/time_per_step:34.966 - perf/throughput:1211.190 - timing_s/total:5493.223
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:158 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:125.766 - global_seqlen/min:42210.000 - global_seqlen/max:42210.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42210.000 - global_seqlen/balanced_max:42210.000 - global_seqlen/mean:42210.000 - actor/kl_loss:1.608 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.056 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.264 - actor/grad_norm:0.063 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.884 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:329.750 - response_length/max:346.000 - response_length/min:297.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.624 - timing_s/old_log_prob:4.828 - timing_s/ref:7.304 - timing_s/adv:0.003 - timing_s/update_actor:21.200 - timing_s/step:34.962 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.502 - perf/total_num_tokens:42210.000 - perf/time_per_step:34.962 - perf/throughput:1207.321 - timing_s/total:5528.187
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:159 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:108.016 - global_seqlen/min:39938.000 - global_seqlen/max:39938.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39938.000 - global_seqlen/balanced_max:39938.000 - global_seqlen/mean:39938.000 - actor/kl_loss:1.904 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.328 - actor/grad_norm:0.060 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.890 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:312.008 - response_length/max:334.000 - response_length/min:285.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.584 - timing_s/old_log_prob:4.850 - timing_s/ref:7.327 - timing_s/adv:0.006 - timing_s/update_actor:21.106 - timing_s/step:34.877 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.183 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.528 - perf/total_num_tokens:39938.000 - perf/time_per_step:34.877 - perf/throughput:1145.105 - timing_s/total:5563.067
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.7518856525421143 seconds
[36m(TaskRunner pid=851128)[0m step:160 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:120.492 - global_seqlen/min:41535.000 - global_seqlen/max:41535.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41535.000 - global_seqlen/balanced_max:41535.000 - global_seqlen/mean:41535.000 - actor/kl_loss:1.666 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.011 - actor/ppo_kl:0.004 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.574 - actor/grad_norm:3.584 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.906 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.418 - val-env/Bandit/action_is_effective:0.418 - val-env/Bandit/action_is_valid:0.418 - val-env/BanditTest/success:0.305 - val-env/BanditTest/num_actions:0.312 - val-env/BanditTest/action_is_effective:0.312 - val-env/BanditTest/action_is_valid:0.312 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:124.418 - val-core/unknown/reward/mean@512:-0.003 - val-aux/unknown/reward/std@512:0.218 - val-aux/unknown/reward/best@2/mean:0.080 - val-aux/unknown/reward/best@2/std:0.287 - val-aux/unknown/reward/worst@2/mean:-0.077 - val-aux/unknown/reward/worst@2/std:0.065 - val-aux/unknown/reward/best@4/mean:0.185 - val-aux/unknown/reward/best@4/std:0.341 - val-aux/unknown/reward/worst@4/mean:-0.097 - val-aux/unknown/reward/worst@4/std:0.020 - val-aux/unknown/reward/best@8/mean:0.327 - val-aux/unknown/reward/best@8/std:0.406 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:0.513 - val-aux/unknown/reward/best@16/std:0.450 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.756 - val-aux/unknown/reward/best@32/std:0.400 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.933 - val-aux/unknown/reward/best@64/std:0.236 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.995 - val-aux/unknown/reward/best@128/std:0.070 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:324.484 - response_length/max:350.000 - response_length/min:289.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.660 - timing_s/old_log_prob:4.850 - timing_s/ref:7.320 - timing_s/adv:0.003 - timing_s/update_actor:21.155 - timing_s/testing:4.077 - timing_s/step:39.068 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.509 - perf/total_num_tokens:41535.000 - perf/time_per_step:39.068 - perf/throughput:1063.154 - timing_s/total:5602.137
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:161 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.789 - train/Bandit/action_is_effective:0.789 - train/Bandit/action_is_valid:0.789 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:128.180 - global_seqlen/min:42519.000 - global_seqlen/max:42519.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42519.000 - global_seqlen/balanced_max:42519.000 - global_seqlen/mean:42519.000 - actor/kl_loss:0.992 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.029 - actor/ppo_kl:0.017 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.684 - actor/grad_norm:7.408 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.929 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.653 - critic/score/min:-2.562 - critic/rewards/mean:-0.000 - critic/rewards/max:0.653 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.013 - critic/advantages/max:0.653 - critic/advantages/min:-2.562 - critic/returns/mean:-0.013 - critic/returns/max:0.653 - critic/returns/min:-2.562 - response_length/mean:332.172 - response_length/max:346.000 - response_length/min:294.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.509 - timing_s/old_log_prob:4.864 - timing_s/ref:7.350 - timing_s/adv:0.006 - timing_s/update_actor:20.807 - timing_s/step:34.539 - timing_per_token_ms/gen:0.035 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.489 - perf/total_num_tokens:42519.000 - perf/time_per_step:34.539 - perf/throughput:1231.050 - timing_s/total:5636.679
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:162 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.789 - train/Bandit/action_is_effective:0.789 - train/Bandit/action_is_valid:0.789 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:127.883 - global_seqlen/min:42481.000 - global_seqlen/max:42481.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42481.000 - global_seqlen/balanced_max:42481.000 - global_seqlen/mean:42481.000 - actor/kl_loss:1.574 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.046 - actor/ppo_kl:0.019 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.551 - actor/grad_norm:9.513 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.937 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.653 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.653 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.014 - critic/advantages/max:0.653 - critic/advantages/min:-3.750 - critic/returns/mean:-0.014 - critic/returns/max:0.653 - critic/returns/min:-3.750 - response_length/mean:331.875 - response_length/max:349.000 - response_length/min:285.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.678 - timing_s/old_log_prob:4.844 - timing_s/ref:7.343 - timing_s/adv:0.005 - timing_s/update_actor:20.996 - timing_s/step:34.868 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.494 - perf/total_num_tokens:42481.000 - perf/time_per_step:34.868 - perf/throughput:1218.331 - timing_s/total:5671.549
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:163 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.281 - global_seqlen/min:42276.000 - global_seqlen/max:42276.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42276.000 - global_seqlen/balanced_max:42276.000 - global_seqlen/mean:42276.000 - actor/kl_loss:1.750 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.021 - actor/ppo_kl:0.006 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.469 - actor/grad_norm:0.058 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.950 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:330.266 - response_length/max:346.000 - response_length/min:299.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.873 - timing_s/old_log_prob:4.816 - timing_s/ref:7.317 - timing_s/adv:0.006 - timing_s/update_actor:21.178 - timing_s/step:35.193 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.501 - perf/total_num_tokens:42276.000 - perf/time_per_step:35.193 - perf/throughput:1201.271 - timing_s/total:5706.744
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:164 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:125.570 - global_seqlen/min:42185.000 - global_seqlen/max:42185.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42185.000 - global_seqlen/balanced_max:42185.000 - global_seqlen/mean:42185.000 - actor/kl_loss:1.657 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.026 - actor/ppo_kl:0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.485 - actor/grad_norm:2.441 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.956 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.010 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.010 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:329.562 - response_length/max:345.000 - response_length/min:295.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.670 - timing_s/old_log_prob:4.836 - timing_s/ref:7.321 - timing_s/adv:0.003 - timing_s/update_actor:21.194 - timing_s/step:35.027 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.502 - perf/total_num_tokens:42185.000 - perf/time_per_step:35.027 - perf/throughput:1204.360 - timing_s/total:5741.774
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:165 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.953 - train/Bandit/action_is_effective:0.953 - train/Bandit/action_is_valid:0.953 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:121.773 - global_seqlen/min:41699.000 - global_seqlen/max:41699.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41699.000 - global_seqlen/balanced_max:41699.000 - global_seqlen/mean:41699.000 - actor/kl_loss:1.347 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.018 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.414 - actor/grad_norm:10.576 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.966 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:325.766 - response_length/max:344.000 - response_length/min:287.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.647 - timing_s/old_log_prob:4.875 - timing_s/ref:7.312 - timing_s/adv:0.006 - timing_s/update_actor:21.287 - timing_s/step:35.130 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.175 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.510 - perf/total_num_tokens:41699.000 - perf/time_per_step:35.130 - perf/throughput:1186.984 - timing_s/total:5776.907
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:166 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:118.961 - global_seqlen/min:41339.000 - global_seqlen/max:41339.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41339.000 - global_seqlen/balanced_max:41339.000 - global_seqlen/mean:41339.000 - actor/kl_loss:1.531 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.021 - actor/ppo_kl:0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.349 - actor/grad_norm:0.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.889 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.006 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.006 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:322.953 - response_length/max:346.000 - response_length/min:284.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.677 - timing_s/old_log_prob:5.040 - timing_s/ref:7.317 - timing_s/adv:0.003 - timing_s/update_actor:21.243 - timing_s/step:35.283 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.177 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.514 - perf/total_num_tokens:41339.000 - perf/time_per_step:35.283 - perf/throughput:1171.643 - timing_s/total:5812.192
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:167 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:117.281 - global_seqlen/min:41124.000 - global_seqlen/max:41124.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41124.000 - global_seqlen/balanced_max:41124.000 - global_seqlen/mean:41124.000 - actor/kl_loss:1.474 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.007 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.412 - actor/grad_norm:0.044 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.906 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:321.273 - response_length/max:339.000 - response_length/min:288.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.878 - timing_s/old_log_prob:4.863 - timing_s/ref:7.312 - timing_s/adv:0.003 - timing_s/update_actor:21.112 - timing_s/step:35.171 - timing_per_token_ms/gen:0.046 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.513 - perf/total_num_tokens:41124.000 - perf/time_per_step:35.171 - perf/throughput:1169.263 - timing_s/total:5847.366
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:168 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:114.461 - global_seqlen/min:40763.000 - global_seqlen/max:40763.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40763.000 - global_seqlen/balanced_max:40763.000 - global_seqlen/mean:40763.000 - actor/kl_loss:1.576 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.433 - actor/grad_norm:0.040 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.918 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:318.453 - response_length/max:347.000 - response_length/min:246.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.626 - timing_s/old_log_prob:4.868 - timing_s/ref:7.327 - timing_s/adv:0.006 - timing_s/update_actor:21.391 - timing_s/step:35.222 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.180 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.525 - perf/total_num_tokens:40763.000 - perf/time_per_step:35.222 - perf/throughput:1157.303 - timing_s/total:5882.591
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:169 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:122.258 - global_seqlen/min:41761.000 - global_seqlen/max:41761.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41761.000 - global_seqlen/balanced_max:41761.000 - global_seqlen/mean:41761.000 - actor/kl_loss:1.362 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.604 - actor/grad_norm:0.036 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.924 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:326.250 - response_length/max:346.000 - response_length/min:288.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.643 - timing_s/old_log_prob:4.841 - timing_s/ref:7.326 - timing_s/adv:0.006 - timing_s/update_actor:21.345 - timing_s/step:35.163 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.175 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.511 - perf/total_num_tokens:41761.000 - perf/time_per_step:35.163 - perf/throughput:1187.632 - timing_s/total:5917.757
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.4401919841766357 seconds
[36m(TaskRunner pid=851128)[0m step:170 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.938 - train/Bandit/action_is_effective:0.938 - train/Bandit/action_is_valid:0.938 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:122.430 - global_seqlen/min:41783.000 - global_seqlen/max:41783.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41783.000 - global_seqlen/balanced_max:41783.000 - global_seqlen/mean:41783.000 - actor/kl_loss:0.483 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.016 - actor/ppo_kl:0.004 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.604 - actor/grad_norm:13.039 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.932 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.859 - val-env/Bandit/action_is_effective:0.859 - val-env/Bandit/action_is_valid:0.859 - val-env/BanditTest/success:0.801 - val-env/BanditTest/num_actions:0.801 - val-env/BanditTest/action_is_effective:0.801 - val-env/BanditTest/action_is_valid:0.801 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:95.342 - val-core/unknown/reward/mean@512:0.124 - val-aux/unknown/reward/std@512:0.297 - val-aux/unknown/reward/best@2/mean:0.243 - val-aux/unknown/reward/best@2/std:0.366 - val-aux/unknown/reward/worst@2/mean:0.012 - val-aux/unknown/reward/worst@2/std:0.137 - val-aux/unknown/reward/best@4/mean:0.398 - val-aux/unknown/reward/best@4/std:0.429 - val-aux/unknown/reward/worst@4/mean:-0.046 - val-aux/unknown/reward/worst@4/std:0.063 - val-aux/unknown/reward/best@8/mean:0.596 - val-aux/unknown/reward/best@8/std:0.448 - val-aux/unknown/reward/worst@8/mean:-0.077 - val-aux/unknown/reward/worst@8/std:0.044 - val-aux/unknown/reward/best@16/mean:0.824 - val-aux/unknown/reward/best@16/std:0.357 - val-aux/unknown/reward/worst@16/mean:-0.095 - val-aux/unknown/reward/worst@16/std:0.022 - val-aux/unknown/reward/best@32/mean:0.971 - val-aux/unknown/reward/best@32/std:0.158 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.005 - val-aux/unknown/reward/best@64/mean:0.998 - val-aux/unknown/reward/best@64/std:0.040 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:326.422 - response_length/max:344.000 - response_length/min:276.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.603 - timing_s/old_log_prob:4.845 - timing_s/ref:7.321 - timing_s/adv:0.006 - timing_s/update_actor:21.275 - timing_s/testing:3.778 - timing_s/step:38.832 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.175 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.509 - perf/total_num_tokens:41783.000 - perf/time_per_step:38.832 - perf/throughput:1076.001 - timing_s/total:5956.590
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:171 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.875 - train/Bandit/action_is_effective:0.875 - train/Bandit/action_is_valid:0.875 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.055 - global_seqlen/min:42247.000 - global_seqlen/max:42247.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42247.000 - global_seqlen/balanced_max:42247.000 - global_seqlen/mean:42247.000 - actor/kl_loss:1.705 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.017 - actor/ppo_kl:0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.624 - actor/grad_norm:6.461 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.946 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.854 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.854 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.009 - critic/advantages/max:0.854 - critic/advantages/min:-3.750 - critic/returns/mean:-0.009 - critic/returns/max:0.854 - critic/returns/min:-3.750 - response_length/mean:330.047 - response_length/max:347.000 - response_length/min:293.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.513 - timing_s/old_log_prob:4.837 - timing_s/ref:7.295 - timing_s/adv:0.003 - timing_s/update_actor:21.220 - timing_s/step:34.871 - timing_per_token_ms/gen:0.036 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.502 - perf/total_num_tokens:42247.000 - perf/time_per_step:34.871 - perf/throughput:1211.518 - timing_s/total:5991.463
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:172 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:119.914 - global_seqlen/min:41461.000 - global_seqlen/max:41461.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41461.000 - global_seqlen/balanced_max:41461.000 - global_seqlen/mean:41461.000 - actor/kl_loss:1.539 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.007 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.542 - actor/grad_norm:0.041 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.951 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:323.906 - response_length/max:345.000 - response_length/min:286.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.696 - timing_s/old_log_prob:4.941 - timing_s/ref:7.360 - timing_s/adv:0.003 - timing_s/update_actor:21.116 - timing_s/step:35.119 - timing_per_token_ms/gen:0.041 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.509 - perf/total_num_tokens:41461.000 - perf/time_per_step:35.119 - perf/throughput:1180.594 - timing_s/total:6026.585
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:173 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:119.109 - global_seqlen/min:41358.000 - global_seqlen/max:41358.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41358.000 - global_seqlen/balanced_max:41358.000 - global_seqlen/mean:41358.000 - actor/kl_loss:1.696 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.599 - actor/grad_norm:0.038 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.973 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:323.102 - response_length/max:346.000 - response_length/min:265.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.629 - timing_s/old_log_prob:4.863 - timing_s/ref:7.357 - timing_s/adv:0.006 - timing_s/update_actor:21.255 - timing_s/step:35.114 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.514 - perf/total_num_tokens:41358.000 - perf/time_per_step:35.114 - perf/throughput:1177.835 - timing_s/total:6061.702
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:174 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.898 - train/Bandit/action_is_effective:0.898 - train/Bandit/action_is_valid:0.898 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:124.539 - global_seqlen/min:42053.000 - global_seqlen/max:42053.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42053.000 - global_seqlen/balanced_max:42053.000 - global_seqlen/mean:42053.000 - actor/kl_loss:1.643 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.042 - actor/ppo_kl:0.012 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.644 - actor/grad_norm:7.022 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.953 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.009 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.009 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:328.531 - response_length/max:347.000 - response_length/min:282.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.636 - timing_s/old_log_prob:4.868 - timing_s/ref:7.335 - timing_s/adv:0.006 - timing_s/update_actor:21.128 - timing_s/step:34.976 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.502 - perf/total_num_tokens:42053.000 - perf/time_per_step:34.976 - perf/throughput:1202.355 - timing_s/total:6096.680
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:175 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.906 - train/Bandit/action_is_effective:0.906 - train/Bandit/action_is_valid:0.906 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.922 - global_seqlen/min:42358.000 - global_seqlen/max:42358.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42358.000 - global_seqlen/balanced_max:42358.000 - global_seqlen/mean:42358.000 - actor/kl_loss:1.216 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.035 - actor/ppo_kl:0.006 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.636 - actor/grad_norm:3.380 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.965 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.009 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.009 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:330.906 - response_length/max:346.000 - response_length/min:294.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.905 - timing_s/old_log_prob:4.870 - timing_s/ref:7.342 - timing_s/adv:0.003 - timing_s/update_actor:21.253 - timing_s/step:35.376 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.502 - perf/total_num_tokens:42358.000 - perf/time_per_step:35.376 - perf/throughput:1197.379 - timing_s/total:6132.058
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:176 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:123.047 - global_seqlen/min:41862.000 - global_seqlen/max:41862.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41862.000 - global_seqlen/balanced_max:41862.000 - global_seqlen/mean:41862.000 - actor/kl_loss:1.729 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.020 - actor/ppo_kl:0.005 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.670 - actor/grad_norm:0.048 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.970 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.006 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.006 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:327.039 - response_length/max:346.000 - response_length/min:240.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.645 - timing_s/old_log_prob:4.879 - timing_s/ref:7.356 - timing_s/adv:0.003 - timing_s/update_actor:21.349 - timing_s/step:35.236 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.510 - perf/total_num_tokens:41862.000 - perf/time_per_step:35.236 - perf/throughput:1188.049 - timing_s/total:6167.296
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:177 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:120.477 - global_seqlen/min:41533.000 - global_seqlen/max:41533.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41533.000 - global_seqlen/balanced_max:41533.000 - global_seqlen/mean:41533.000 - actor/kl_loss:1.524 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.011 - actor/ppo_kl:0.004 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.560 - actor/grad_norm:2.041 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.980 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:324.461 - response_length/max:343.000 - response_length/min:280.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.635 - timing_s/old_log_prob:4.896 - timing_s/ref:7.279 - timing_s/adv:0.006 - timing_s/update_actor:20.988 - timing_s/step:34.807 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.175 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.505 - perf/total_num_tokens:41533.000 - perf/time_per_step:34.807 - perf/throughput:1193.243 - timing_s/total:6202.106
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:178 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.242 - global_seqlen/min:42271.000 - global_seqlen/max:42271.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42271.000 - global_seqlen/balanced_max:42271.000 - global_seqlen/mean:42271.000 - actor/kl_loss:1.664 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.014 - actor/ppo_kl:0.005 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.639 - actor/grad_norm:0.038 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:405.999 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:330.227 - response_length/max:345.000 - response_length/min:298.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.651 - timing_s/old_log_prob:4.823 - timing_s/ref:7.349 - timing_s/adv:0.006 - timing_s/update_actor:21.109 - timing_s/step:34.941 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:42271.000 - perf/time_per_step:34.941 - perf/throughput:1209.773 - timing_s/total:6237.050
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:179 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.844 - train/Bandit/action_is_effective:0.844 - train/Bandit/action_is_valid:0.844 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:129.961 - global_seqlen/min:42747.000 - global_seqlen/max:42747.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42747.000 - global_seqlen/balanced_max:42747.000 - global_seqlen/mean:42747.000 - actor/kl_loss:1.435 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.032 - actor/ppo_kl:0.005 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.672 - actor/grad_norm:2.958 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.003 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-2.562 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-2.562 - critic/advantages/mean:-0.008 - critic/advantages/max:0.559 - critic/advantages/min:-2.562 - critic/returns/mean:-0.008 - critic/returns/max:0.559 - critic/returns/min:-2.562 - response_length/mean:333.953 - response_length/max:345.000 - response_length/min:300.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.935 - timing_s/old_log_prob:4.902 - timing_s/ref:7.353 - timing_s/adv:0.006 - timing_s/update_actor:21.213 - timing_s/step:35.412 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.496 - perf/total_num_tokens:42747.000 - perf/time_per_step:35.412 - perf/throughput:1207.141 - timing_s/total:6272.465
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.202850341796875 seconds
[36m(TaskRunner pid=851128)[0m step:180 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.070 - global_seqlen/min:42249.000 - global_seqlen/max:42249.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42249.000 - global_seqlen/balanced_max:42249.000 - global_seqlen/mean:42249.000 - actor/kl_loss:1.288 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.027 - actor/ppo_kl:0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.620 - actor/grad_norm:0.037 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.011 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.973 - val-env/Bandit/action_is_effective:0.973 - val-env/Bandit/action_is_valid:0.973 - val-env/BanditTest/success:0.949 - val-env/BanditTest/num_actions:0.961 - val-env/BanditTest/action_is_effective:0.961 - val-env/BanditTest/action_is_valid:0.961 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:92.865 - val-core/unknown/reward/mean@512:0.165 - val-aux/unknown/reward/std@512:0.312 - val-aux/unknown/reward/best@2/mean:0.292 - val-aux/unknown/reward/best@2/std:0.387 - val-aux/unknown/reward/worst@2/mean:0.047 - val-aux/unknown/reward/worst@2/std:0.134 - val-aux/unknown/reward/best@4/mean:0.452 - val-aux/unknown/reward/best@4/std:0.441 - val-aux/unknown/reward/worst@4/mean:0.002 - val-aux/unknown/reward/worst@4/std:0.052 - val-aux/unknown/reward/best@8/mean:0.659 - val-aux/unknown/reward/best@8/std:0.437 - val-aux/unknown/reward/worst@8/mean:-0.022 - val-aux/unknown/reward/worst@8/std:0.046 - val-aux/unknown/reward/best@16/mean:0.881 - val-aux/unknown/reward/best@16/std:0.305 - val-aux/unknown/reward/worst@16/mean:-0.043 - val-aux/unknown/reward/worst@16/std:0.050 - val-aux/unknown/reward/best@32/mean:0.986 - val-aux/unknown/reward/best@32/std:0.113 - val-aux/unknown/reward/worst@32/mean:-0.068 - val-aux/unknown/reward/worst@32/std:0.047 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.090 - val-aux/unknown/reward/worst@64/std:0.030 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.099 - val-aux/unknown/reward/worst@128/std:0.012 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:330.062 - response_length/max:345.000 - response_length/min:272.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.680 - timing_s/old_log_prob:4.885 - timing_s/ref:7.345 - timing_s/adv:0.003 - timing_s/update_actor:21.433 - timing_s/testing:3.587 - timing_s/step:38.935 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.507 - perf/total_num_tokens:42249.000 - perf/time_per_step:38.935 - perf/throughput:1085.120 - timing_s/total:6311.402
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:181 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.836 - train/Bandit/action_is_effective:0.836 - train/Bandit/action_is_valid:0.836 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:128.930 - global_seqlen/min:42615.000 - global_seqlen/max:42615.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42615.000 - global_seqlen/balanced_max:42615.000 - global_seqlen/mean:42615.000 - actor/kl_loss:1.343 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.023 - actor/ppo_kl:0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.661 - actor/grad_norm:6.164 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.016 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.653 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.653 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.009 - critic/advantages/max:0.653 - critic/advantages/min:-3.750 - critic/returns/mean:-0.009 - critic/returns/max:0.653 - critic/returns/min:-3.750 - response_length/mean:332.922 - response_length/max:346.000 - response_length/min:298.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.539 - timing_s/old_log_prob:4.867 - timing_s/ref:7.321 - timing_s/adv:0.006 - timing_s/update_actor:21.310 - timing_s/step:35.046 - timing_per_token_ms/gen:0.036 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.500 - perf/total_num_tokens:42615.000 - perf/time_per_step:35.046 - perf/throughput:1215.957 - timing_s/total:6346.450
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:182 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.820 - train/Bandit/action_is_effective:0.820 - train/Bandit/action_is_valid:0.820 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:128.539 - global_seqlen/min:42565.000 - global_seqlen/max:42565.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42565.000 - global_seqlen/balanced_max:42565.000 - global_seqlen/mean:42565.000 - actor/kl_loss:1.450 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.034 - actor/ppo_kl:0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.611 - actor/grad_norm:8.572 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.020 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.011 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.011 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:332.531 - response_length/max:348.000 - response_length/min:294.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.895 - timing_s/old_log_prob:4.818 - timing_s/ref:7.304 - timing_s/adv:0.005 - timing_s/update_actor:20.959 - timing_s/step:34.984 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.492 - perf/total_num_tokens:42565.000 - perf/time_per_step:34.984 - perf/throughput:1216.711 - timing_s/total:6381.437
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:183 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.898 - train/Bandit/action_is_effective:0.898 - train/Bandit/action_is_valid:0.898 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.078 - global_seqlen/min:42250.000 - global_seqlen/max:42250.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42250.000 - global_seqlen/balanced_max:42250.000 - global_seqlen/mean:42250.000 - actor/kl_loss:1.067 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.033 - actor/ppo_kl:0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.573 - actor/grad_norm:6.838 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.029 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.012 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.012 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:330.062 - response_length/max:345.000 - response_length/min:219.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.904 - timing_s/old_log_prob:4.873 - timing_s/ref:7.346 - timing_s/adv:0.007 - timing_s/update_actor:21.243 - timing_s/step:35.376 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.503 - perf/total_num_tokens:42250.000 - perf/time_per_step:35.376 - perf/throughput:1194.298 - timing_s/total:6416.815
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:184 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:122.281 - global_seqlen/min:41764.000 - global_seqlen/max:41764.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41764.000 - global_seqlen/balanced_max:41764.000 - global_seqlen/mean:41764.000 - actor/kl_loss:1.567 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.014 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.545 - actor/grad_norm:2.069 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.033 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.006 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.006 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:326.273 - response_length/max:348.000 - response_length/min:268.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.606 - timing_s/old_log_prob:4.905 - timing_s/ref:7.352 - timing_s/adv:0.006 - timing_s/update_actor:21.151 - timing_s/step:35.024 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.506 - perf/total_num_tokens:41764.000 - perf/time_per_step:35.024 - perf/throughput:1192.444 - timing_s/total:6451.841
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:185 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:121.445 - global_seqlen/min:41657.000 - global_seqlen/max:41657.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41657.000 - global_seqlen/balanced_max:41657.000 - global_seqlen/mean:41657.000 - actor/kl_loss:1.519 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.013 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.457 - actor/grad_norm:0.047 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.047 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:325.438 - response_length/max:342.000 - response_length/min:291.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.647 - timing_s/old_log_prob:4.878 - timing_s/ref:7.351 - timing_s/adv:0.006 - timing_s/update_actor:21.115 - timing_s/step:35.000 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.507 - perf/total_num_tokens:41657.000 - perf/time_per_step:35.000 - perf/throughput:1190.207 - timing_s/total:6486.844
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:186 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:116.984 - global_seqlen/min:41086.000 - global_seqlen/max:41086.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41086.000 - global_seqlen/balanced_max:41086.000 - global_seqlen/mean:41086.000 - actor/kl_loss:1.342 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.522 - actor/grad_norm:0.047 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.045 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:320.977 - response_length/max:341.000 - response_length/min:276.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.622 - timing_s/old_log_prob:4.851 - timing_s/ref:7.324 - timing_s/adv:0.003 - timing_s/update_actor:21.135 - timing_s/step:34.937 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.514 - perf/total_num_tokens:41086.000 - perf/time_per_step:34.937 - perf/throughput:1176.003 - timing_s/total:6521.784
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:187 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:119.070 - global_seqlen/min:41353.000 - global_seqlen/max:41353.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41353.000 - global_seqlen/balanced_max:41353.000 - global_seqlen/mean:41353.000 - actor/kl_loss:1.402 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.635 - actor/grad_norm:0.052 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.055 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:323.062 - response_length/max:342.000 - response_length/min:275.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.880 - timing_s/old_log_prob:4.861 - timing_s/ref:7.328 - timing_s/adv:0.006 - timing_s/update_actor:20.971 - timing_s/step:35.049 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.177 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.507 - perf/total_num_tokens:41353.000 - perf/time_per_step:35.049 - perf/throughput:1179.861 - timing_s/total:6556.836
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:188 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:123.461 - global_seqlen/min:41915.000 - global_seqlen/max:41915.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41915.000 - global_seqlen/balanced_max:41915.000 - global_seqlen/mean:41915.000 - actor/kl_loss:0.895 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.439 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.750 - actor/grad_norm:0.050 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.061 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:327.453 - response_length/max:345.000 - response_length/min:279.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.646 - timing_s/old_log_prob:4.843 - timing_s/ref:7.284 - timing_s/adv:0.006 - timing_s/update_actor:21.175 - timing_s/step:34.957 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.505 - perf/total_num_tokens:41915.000 - perf/time_per_step:34.957 - perf/throughput:1199.028 - timing_s/total:6591.796
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:189 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.891 - global_seqlen/min:42354.000 - global_seqlen/max:42354.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42354.000 - global_seqlen/balanced_max:42354.000 - global_seqlen/mean:42354.000 - actor/kl_loss:0.457 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.014 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.717 - actor/grad_norm:0.050 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.069 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.003 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.003 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:330.867 - response_length/max:343.000 - response_length/min:219.000 - response_length/clip_ratio:0.039 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.657 - timing_s/old_log_prob:4.842 - timing_s/ref:7.307 - timing_s/adv:0.006 - timing_s/update_actor:21.210 - timing_s/step:35.026 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.501 - perf/total_num_tokens:42354.000 - perf/time_per_step:35.026 - perf/throughput:1209.231 - timing_s/total:6626.824
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 3.4554638862609863 seconds
[36m(TaskRunner pid=851128)[0m step:190 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:125.039 - global_seqlen/min:42117.000 - global_seqlen/max:42117.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42117.000 - global_seqlen/balanced_max:42117.000 - global_seqlen/mean:42117.000 - actor/kl_loss:0.649 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.010 - actor/ppo_kl:-0.167 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.650 - actor/grad_norm:0.049 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.077 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.992 - val-env/Bandit/action_is_effective:0.992 - val-env/Bandit/action_is_valid:0.992 - val-env/BanditTest/success:0.996 - val-env/BanditTest/num_actions:0.996 - val-env/BanditTest/action_is_effective:0.996 - val-env/BanditTest/action_is_valid:0.996 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:102.266 - val-core/unknown/reward/mean@512:0.172 - val-aux/unknown/reward/std@512:0.314 - val-aux/unknown/reward/best@2/mean:0.301 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.053 - val-aux/unknown/reward/worst@2/std:0.131 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.014 - val-aux/unknown/reward/worst@4/std:0.039 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:-0.002 - val-aux/unknown/reward/worst@8/std:0.024 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:-0.008 - val-aux/unknown/reward/worst@16/std:0.027 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:-0.016 - val-aux/unknown/reward/worst@32/std:0.037 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.032 - val-aux/unknown/reward/worst@64/std:0.046 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.052 - val-aux/unknown/reward/worst@128/std:0.050 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.076 - val-aux/unknown/reward/worst@256/std:0.043 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:329.023 - response_length/max:343.000 - response_length/min:219.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.684 - timing_s/old_log_prob:4.908 - timing_s/ref:7.321 - timing_s/adv:0.003 - timing_s/update_actor:21.754 - timing_s/testing:3.787 - timing_s/step:39.459 - timing_per_token_ms/gen:0.040 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.517 - perf/total_num_tokens:42117.000 - perf/time_per_step:39.459 - perf/throughput:1067.349 - timing_s/total:6666.286
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:191 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.836 - train/Bandit/action_is_effective:0.836 - train/Bandit/action_is_valid:0.836 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:130.398 - global_seqlen/min:42803.000 - global_seqlen/max:42803.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42803.000 - global_seqlen/balanced_max:42803.000 - global_seqlen/mean:42803.000 - actor/kl_loss:0.699 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.041 - actor/ppo_kl:-0.068 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.716 - actor/grad_norm:6.566 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.078 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.854 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.854 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.854 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.854 - critic/returns/min:-3.750 - response_length/mean:334.391 - response_length/max:344.000 - response_length/min:219.000 - response_length/clip_ratio:0.070 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.532 - timing_s/old_log_prob:4.891 - timing_s/ref:7.300 - timing_s/adv:0.006 - timing_s/update_actor:21.886 - timing_s/step:35.618 - timing_per_token_ms/gen:0.036 - timing_per_token_ms/ref:0.171 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.511 - perf/total_num_tokens:42803.000 - perf/time_per_step:35.618 - perf/throughput:1201.725 - timing_s/total:6701.906
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:192 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.836 - train/Bandit/action_is_effective:0.836 - train/Bandit/action_is_valid:0.836 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:130.570 - global_seqlen/min:42825.000 - global_seqlen/max:42825.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42825.000 - global_seqlen/balanced_max:42825.000 - global_seqlen/mean:42825.000 - actor/kl_loss:1.162 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.035 - actor/ppo_kl:-0.121 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.786 - actor/grad_norm:6.716 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.083 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.008 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.008 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:334.562 - response_length/max:350.000 - response_length/min:274.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.679 - timing_s/old_log_prob:4.913 - timing_s/ref:7.311 - timing_s/adv:0.003 - timing_s/update_actor:21.785 - timing_s/step:35.694 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.171 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.509 - perf/total_num_tokens:42825.000 - perf/time_per_step:35.694 - perf/throughput:1199.784 - timing_s/total:6737.603
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:193 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:126.641 - global_seqlen/min:42322.000 - global_seqlen/max:42322.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42322.000 - global_seqlen/balanced_max:42322.000 - global_seqlen/mean:42322.000 - actor/kl_loss:1.316 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.078 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.784 - actor/grad_norm:0.042 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.084 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.002 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.002 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:330.633 - response_length/max:344.000 - response_length/min:283.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.639 - timing_s/old_log_prob:4.836 - timing_s/ref:7.309 - timing_s/adv:0.006 - timing_s/update_actor:21.550 - timing_s/step:35.343 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.173 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.509 - perf/total_num_tokens:42322.000 - perf/time_per_step:35.343 - perf/throughput:1197.461 - timing_s/total:6772.949
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:194 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:127.219 - global_seqlen/min:42396.000 - global_seqlen/max:42396.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42396.000 - global_seqlen/balanced_max:42396.000 - global_seqlen/mean:42396.000 - actor/kl_loss:1.203 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.026 - actor/ppo_kl:-0.032 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.826 - actor/grad_norm:8.973 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.093 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.007 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.007 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:331.195 - response_length/max:343.000 - response_length/min:278.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.915 - timing_s/old_log_prob:4.873 - timing_s/ref:7.366 - timing_s/adv:0.005 - timing_s/update_actor:21.588 - timing_s/step:35.750 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.509 - perf/total_num_tokens:42396.000 - perf/time_per_step:35.750 - perf/throughput:1185.887 - timing_s/total:6808.702
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:195 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.852 - train/Bandit/action_is_effective:0.852 - train/Bandit/action_is_valid:0.852 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:130.297 - global_seqlen/min:42790.000 - global_seqlen/max:42790.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42790.000 - global_seqlen/balanced_max:42790.000 - global_seqlen/mean:42790.000 - actor/kl_loss:1.425 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.028 - actor/ppo_kl:-0.033 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.780 - actor/grad_norm:6.262 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.092 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.007 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.007 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:334.289 - response_length/max:346.000 - response_length/min:267.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.686 - timing_s/old_log_prob:4.827 - timing_s/ref:7.335 - timing_s/adv:0.006 - timing_s/update_actor:21.247 - timing_s/step:35.104 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.171 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.497 - perf/total_num_tokens:42790.000 - perf/time_per_step:35.104 - perf/throughput:1218.938 - timing_s/total:6843.809
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:196 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:131.125 - global_seqlen/min:42896.000 - global_seqlen/max:42896.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42896.000 - global_seqlen/balanced_max:42896.000 - global_seqlen/mean:42896.000 - actor/kl_loss:1.465 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.025 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.775 - actor/grad_norm:6.312 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.096 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.559 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.559 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.559 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.559 - critic/returns/min:-3.750 - response_length/mean:335.117 - response_length/max:344.000 - response_length/min:289.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.688 - timing_s/old_log_prob:4.911 - timing_s/ref:7.386 - timing_s/adv:0.003 - timing_s/update_actor:20.960 - timing_s/step:34.949 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.489 - perf/total_num_tokens:42896.000 - perf/time_per_step:34.949 - perf/throughput:1227.374 - timing_s/total:6878.761
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:197 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:129.352 - global_seqlen/min:42669.000 - global_seqlen/max:42669.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42669.000 - global_seqlen/balanced_max:42669.000 - global_seqlen/mean:42669.000 - actor/kl_loss:1.426 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.009 - actor/ppo_kl:0.005 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.746 - actor/grad_norm:0.044 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.099 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:333.344 - response_length/max:349.000 - response_length/min:283.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.677 - timing_s/old_log_prob:4.912 - timing_s/ref:7.320 - timing_s/adv:0.006 - timing_s/update_actor:21.284 - timing_s/step:35.203 - timing_per_token_ms/gen:0.039 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:42669.000 - perf/time_per_step:35.203 - perf/throughput:1212.079 - timing_s/total:6913.967
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:198 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:127.180 - global_seqlen/min:42391.000 - global_seqlen/max:42391.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42391.000 - global_seqlen/balanced_max:42391.000 - global_seqlen/mean:42391.000 - actor/kl_loss:1.129 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.674 - actor/grad_norm:0.037 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.095 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.250 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.250 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.250 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.250 - critic/returns/min:-3.750 - response_length/mean:331.172 - response_length/max:343.000 - response_length/min:268.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.876 - timing_s/old_log_prob:4.874 - timing_s/ref:7.360 - timing_s/adv:0.006 - timing_s/update_actor:20.702 - timing_s/step:34.821 - timing_per_token_ms/gen:0.044 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.488 - perf/total_num_tokens:42391.000 - perf/time_per_step:34.821 - perf/throughput:1217.400 - timing_s/total:6948.791
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m step:199 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.945 - train/Bandit/action_is_effective:0.945 - train/Bandit/action_is_valid:0.945 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:129.125 - global_seqlen/min:42640.000 - global_seqlen/max:42640.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42640.000 - global_seqlen/balanced_max:42640.000 - global_seqlen/mean:42640.000 - actor/kl_loss:1.354 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.601 - actor/grad_norm:12.846 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.105 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.366 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.366 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.001 - critic/advantages/max:0.366 - critic/advantages/min:-3.750 - critic/returns/mean:-0.001 - critic/returns/max:0.366 - critic/returns/min:-3.750 - response_length/mean:333.117 - response_length/max:343.000 - response_length/min:219.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.913 - timing_s/old_log_prob:4.860 - timing_s/ref:7.347 - timing_s/adv:0.005 - timing_s/update_actor:21.138 - timing_s/step:35.267 - timing_per_token_ms/gen:0.045 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.496 - perf/total_num_tokens:42640.000 - perf/time_per_step:35.267 - perf/throughput:1209.045 - timing_s/total:6984.061
[36m(TaskRunner pid=851128)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=851128)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=851128)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=851128)[0m validation generation time: 2.8893911838531494 seconds
[36m(TaskRunner pid=851128)[0m step:200 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.953 - train/Bandit/action_is_effective:0.953 - train/Bandit/action_is_valid:0.953 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:128.984 - global_seqlen/min:42622.000 - global_seqlen/max:42622.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42622.000 - global_seqlen/balanced_max:42622.000 - global_seqlen/mean:42622.000 - actor/kl_loss:1.166 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.015 - actor/ppo_kl:0.007 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:9.587 - actor/grad_norm:2.257 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:23.287 - perf/max_memory_reserved_gb:26.936 - perf/cpu_memory_used_gb:406.111 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.992 - val-env/Bandit/action_is_effective:0.992 - val-env/Bandit/action_is_valid:0.992 - val-env/BanditTest/success:0.965 - val-env/BanditTest/num_actions:0.969 - val-env/BanditTest/action_is_effective:0.969 - val-env/BanditTest/action_is_valid:0.969 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:76.164 - val-core/unknown/reward/mean@512:0.169 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.299 - val-aux/unknown/reward/best@2/std:0.391 - val-aux/unknown/reward/worst@2/mean:0.048 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.460 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.006 - val-aux/unknown/reward/worst@4/std:0.048 - val-aux/unknown/reward/best@8/mean:0.665 - val-aux/unknown/reward/best@8/std:0.435 - val-aux/unknown/reward/worst@8/mean:-0.015 - val-aux/unknown/reward/worst@8/std:0.040 - val-aux/unknown/reward/best@16/mean:0.885 - val-aux/unknown/reward/best@16/std:0.301 - val-aux/unknown/reward/worst@16/mean:-0.029 - val-aux/unknown/reward/worst@16/std:0.045 - val-aux/unknown/reward/best@32/mean:0.986 - val-aux/unknown/reward/best@32/std:0.113 - val-aux/unknown/reward/worst@32/mean:-0.050 - val-aux/unknown/reward/worst@32/std:0.050 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.071 - val-aux/unknown/reward/worst@64/std:0.045 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.092 - val-aux/unknown/reward/worst@128/std:0.027 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.006 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.465 - critic/score/min:-3.750 - critic/rewards/mean:-0.000 - critic/rewards/max:0.465 - critic/rewards/min:-3.750 - critic/advantages/mean:-0.004 - critic/advantages/max:0.465 - critic/advantages/min:-3.750 - critic/returns/mean:-0.004 - critic/returns/max:0.465 - critic/returns/min:-3.750 - response_length/mean:332.977 - response_length/max:343.000 - response_length/min:226.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.634 - timing_s/old_log_prob:4.823 - timing_s/ref:7.349 - timing_s/adv:0.006 - timing_s/update_actor:21.261 - timing_s/testing:3.214 - timing_s/step:38.290 - timing_per_token_ms/gen:0.038 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.499 - perf/total_num_tokens:42622.000 - perf/time_per_step:38.290 - perf/throughput:1113.145 - timing_s/total:7022.353
[36m(TaskRunner pid=851128)[0m ("Final validation metrics: {'val-env/Bandit/success': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/num_actions': 0.9921875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/action_is_effective': 0.9921875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/action_is_valid': 0.9921875, 'val-env/BanditTest/success': "
[36m(TaskRunner pid=851128)[0m  "0.96484375, 'val-env/BanditTest/num_actions': 0.96875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/action_is_effective': 0.96875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/action_is_valid': 0.96875, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/num_actions': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/action_is_effective': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/Bandit/non-zero/action_is_valid': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/success': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/num_actions': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/action_is_effective': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/BanditTest/non-zero/action_is_valid': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-env/response_length': 76.1640625, 'val-core/unknown/reward/mean@512': "
[36m(TaskRunner pid=851128)[0m  "0.16894531321304385, 'val-aux/unknown/reward/std@512': 0.3126131995735254, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@2/mean': 0.2987000009343028, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@2/std': 0.3912394530582315, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@2/mean': 0.04800000049173832, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@2/std': 0.12967652091099102, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@4/mean': 0.4601000008657575, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@4/std': 0.44285210779275, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@4/mean': 0.006200000092387199, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@4/std': 0.047555862597578234, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@8/mean': 0.6652000005543232, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@8/std': 0.43500455098009383, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@8/mean': -0.015000000223517418, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@8/std': 0.040435133840841894, "
[36m(TaskRunner pid=851128)[0m  
[36m(TaskRunner pid=851128)[0m "'val-aux/unknown/reward/best@16/mean': 0.8848000001907349, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@16/std': 0.3006808269587913, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@16/mean': -0.028500000424683095, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@16/std': 0.045362430064159145, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@32/mean': 0.9856000000238418, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@32/std': 0.112927587230806, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@32/mean': -0.05030000074952841, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@32/std': 0.0499991007369445, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@64/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@64/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@64/mean': -0.0713000010624528, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@64/std': 0.04523615877795981, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@128/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@128/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@128/mean': -0.09230000137537718, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@128/std': 0.026659145169731314, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@256/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/best@256/std': 0.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@256/mean': -0.09960000148415565, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@256/std': 0.006311893629278342, "
[36m(TaskRunner pid=851128)[0m  "'val-core/unknown/reward/best@512/mean': 1.0, "
[36m(TaskRunner pid=851128)[0m  "'val-aux/unknown/reward/worst@512/mean': -0.10000000149011612}")
