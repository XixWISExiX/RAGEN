/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In '_3_frozen_lake': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
2025-06-08 10:19:06,950	INFO worker.py:1888 -- Started a local Ray instance.
[36m(TaskRunner pid=3964106)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=3964106)[0m WARNING:2025-06-08 10:19:15,906:Waiting for register center actor N4tyUc_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=3964503)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=3964503)[0m [rank0]:[W608 10:19:22.733131040 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=3964503)[0m /home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/torch/distributed/fsdp/_init_utils.py:444: UserWarning: FSDP is switching to use `NO_SHARD` instead of ShardingStrategy.FULL_SHARD since the world size is 1.
[36m(WorkerDict pid=3964503)[0m   warnings.warn(
[36m(WorkerDict pid=3964503)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=3964503)[0m /home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/torch/distributed/fsdp/_init_utils.py:444: UserWarning: FSDP is switching to use `NO_SHARD` instead of ShardingStrategy.FULL_SHARD since the world size is 1.
[36m(WorkerDict pid=3964503)[0m   warnings.warn(
[36m(WorkerDict pid=3964503)[0m /home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=3964503)[0m   warnings.warn(
[36m(TaskRunner pid=3964106)[0m wandb: Currently logged in as: addalooptoit (addalooptoit-me) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=3964106)[0m wandb: Tracking run with wandb version 0.19.11
[36m(TaskRunner pid=3964106)[0m wandb: Run data is saved locally in /scr/jwiseman/RAGEN/wandb/run-20250608_101937-600yw7x1
[36m(TaskRunner pid=3964106)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=3964106)[0m wandb: Syncing run debug-output-1
[36m(TaskRunner pid=3964106)[0m wandb: ‚≠êÔ∏è View project at https://wandb.ai/addalooptoit-me/ragen_latest
[36m(TaskRunner pid=3964106)[0m wandb: üöÄ View run at https://wandb.ai/addalooptoit-me/ragen_latest/runs/600yw7x1
[36m(WorkerDict pid=3964503)[0m /home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=3964503)[0m   warnings.warn(
[36m(WorkerDict pid=3964503)[0m /home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=3964503)[0m   warnings.warn(
[36m(TaskRunner pid=3964106)[0m Training Progress:   0%|          | 0/200 [00:00<?, ?it/s]
Error executing job with overrides: ['system.CUDA_VISIBLE_DEVICES=1', 'trainer.experiment_name=debug-output-1', 'algorithm.adv_estimator=grpo', 'agent_proxy.reward_normalization.method=mean_std', 'actor_rollout_ref.actor.use_kl_loss=True', 'algorithm.kl_ctrl.kl_coef=0.001', 'actor_rollout_ref.actor.kl_loss_coef=0.001', 'actor_rollout_ref.actor.clip_ratio_high=0.2', 'actor_rollout_ref.rollout.rollout_filter_ratio=1', 'micro_batch_size_per_gpu=1', 'ppo_mini_batch_size=8', 'actor_rollout_ref.rollout.max_model_len=2048', 'actor_rollout_ref.rollout.response_length=128']
Traceback (most recent call last):
  File "/scr/jwiseman/RAGEN/train.py", line 302, in <module>
    main()
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scr/jwiseman/RAGEN/train.py", line 158, in main
    run_ppo(config)
  File "/scr/jwiseman/RAGEN/train.py", line 179, in run_ppo
    ray.get(runner.run.remote(config))
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/ray/_private/worker.py", line 2822, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/student/jwiseman/.conda/envs/ragen/lib/python3.12/site-packages/ray/_private/worker.py", line 930, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ZeroDivisionError): [36mray::TaskRunner.run()[39m (pid=3964106, ip=10.255.0.11, actor_id=79783dfb4cde48acf6706d7801000000, repr=<train.TaskRunner object at 0x7fbf264d92e0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scr/jwiseman/RAGEN/train.py", line 298, in run
    trainer.fit()
  File "/scr/jwiseman/RAGEN/ragen/trainer/agent_trainer.py", line 524, in fit
    x = 1/0
        ~^~
ZeroDivisionError: division by zero
[36m(TaskRunner pid=3964106)[0m wandb:                                                                                
[36m(TaskRunner pid=3964106)[0m wandb: 
[36m(TaskRunner pid=3964106)[0m wandb: Run history:
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/best@128/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@128/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@16/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@16/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@2/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:               val-aux/unknown/reward/best@2/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@32/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@32/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@4/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:               val-aux/unknown/reward/best@4/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@64/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@64/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@8/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:               val-aux/unknown/reward/best@8/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:                  val-aux/unknown/reward/std@256 ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:           val-aux/unknown/reward/worst@128/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@128/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@16/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@16/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@2/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/worst@2/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:           val-aux/unknown/reward/worst@256/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@32/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@32/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@4/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/worst@4/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@64/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@64/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@8/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/worst@8/std ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:           val-core/unknown/reward/best@256/mean ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:                val-core/unknown/reward/mean@256 ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:          val-env/FrozenLake/action_is_effective ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:              val-env/FrozenLake/action_is_valid ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb: val-env/FrozenLake/non-zero/action_is_effective ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:     val-env/FrozenLake/non-zero/action_is_valid ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:         val-env/FrozenLake/non-zero/num_actions ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:             val-env/FrozenLake/non-zero/success ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:                  val-env/FrozenLake/num_actions ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:                      val-env/FrozenLake/success ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb:                         val-env/response_length ‚ñÅ
[36m(TaskRunner pid=3964106)[0m wandb: 
[36m(TaskRunner pid=3964106)[0m wandb: Run summary:
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/best@128/mean 0.9926
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@128/std 0.07865
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@16/mean 0.448
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@16/std 0.52394
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@2/mean -0.2483
[36m(TaskRunner pid=3964106)[0m wandb:               val-aux/unknown/reward/best@2/std 0.41051
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@32/mean 0.7048
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@32/std 0.44875
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@4/mean -0.0526
[36m(TaskRunner pid=3964106)[0m wandb:               val-aux/unknown/reward/best@4/std 0.50271
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/best@64/mean 0.9171
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@64/std 0.26343
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/best@8/mean 0.1885
[36m(TaskRunner pid=3964106)[0m wandb:               val-aux/unknown/reward/best@8/std 0.54472
[36m(TaskRunner pid=3964106)[0m wandb:                  val-aux/unknown/reward/std@256 0.31476
[36m(TaskRunner pid=3964106)[0m wandb:           val-aux/unknown/reward/worst@128/mean -0.5
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@128/std 0
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@16/mean -0.5
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@16/std 0
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@2/mean -0.4809
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/worst@2/std 0.09168
[36m(TaskRunner pid=3964106)[0m wandb:           val-aux/unknown/reward/worst@256/mean -0.5
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@32/mean -0.5
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@32/std 0
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@4/mean -0.4991
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/worst@4/std 0.00944
[36m(TaskRunner pid=3964106)[0m wandb:            val-aux/unknown/reward/worst@64/mean -0.5
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@64/std 0
[36m(TaskRunner pid=3964106)[0m wandb:             val-aux/unknown/reward/worst@8/mean -0.5
[36m(TaskRunner pid=3964106)[0m wandb:              val-aux/unknown/reward/worst@8/std 0
[36m(TaskRunner pid=3964106)[0m wandb:           val-core/unknown/reward/best@256/mean 1
[36m(TaskRunner pid=3964106)[0m wandb:                val-core/unknown/reward/mean@256 -0.36953
[36m(TaskRunner pid=3964106)[0m wandb:          val-env/FrozenLake/action_is_effective 0.15729
[36m(TaskRunner pid=3964106)[0m wandb:              val-env/FrozenLake/action_is_valid 0.18079
[36m(TaskRunner pid=3964106)[0m wandb: val-env/FrozenLake/non-zero/action_is_effective 0.64946
[36m(TaskRunner pid=3964106)[0m wandb:     val-env/FrozenLake/non-zero/action_is_valid 0.65188
[36m(TaskRunner pid=3964106)[0m wandb:         val-env/FrozenLake/non-zero/num_actions 3.46479
[36m(TaskRunner pid=3964106)[0m wandb:             val-env/FrozenLake/non-zero/success 1
[36m(TaskRunner pid=3964106)[0m wandb:                  val-env/FrozenLake/num_actions 0.96094
[36m(TaskRunner pid=3964106)[0m wandb:                      val-env/FrozenLake/success 0.03906
[36m(TaskRunner pid=3964106)[0m wandb:                         val-env/response_length 100.21484
[36m(TaskRunner pid=3964106)[0m wandb: 
[36m(TaskRunner pid=3964106)[0m wandb: üöÄ View run debug-output-1 at: https://wandb.ai/addalooptoit-me/ragen_latest/runs/600yw7x1
[36m(TaskRunner pid=3964106)[0m wandb: ‚≠êÔ∏è View project at: https://wandb.ai/addalooptoit-me/ragen_latest
[36m(TaskRunner pid=3964106)[0m wandb: Synced 5 W&B file(s), 1 media file(s), 2 artifact file(s) and 0 other file(s)
[36m(TaskRunner pid=3964106)[0m wandb: Find logs at: ./wandb/run-20250608_101937-600yw7x1/logs
[36m(TaskRunner pid=3964106)[0m Training Progress:   0%|          | 0/200 [00:08<?, ?it/s]
