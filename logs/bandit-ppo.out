INFO 05-30 10:38:46 [__init__.py:239] Automatically detected platform cuda.
config: {'data': {'tokenizer': None, 'train_files': '~/data/rlhf/gsm8k/train.parquet', 'val_files': '~/data/rlhf/gsm8k/test.parquet', 'prompt_key': 'prompt', 'reward_fn_key': 'data_source', 'max_prompt_length': None, 'max_response_length': None, 'train_batch_size': 128, 'val_batch_size': None, 'return_raw_input_ids': False, 'return_raw_chat': False, 'shuffle': True, 'filter_overlong_prompts': False, 'filter_overlong_prompts_workers': 1, 'truncation': 'error', 'image_key': 'images', 'video_key': 'videos', 'custom_cls': {'path': None, 'name': None}}, 'actor_rollout_ref': {'hybrid_engine': True, 'model': {'path': '${model_path}', 'external_lib': None, 'override_config': {}, 'enable_gradient_checkpointing': True, 'use_remove_padding': False, 'use_liger': False, 'lora_rank': '${lora.rank}', 'lora_alpha': '${lora.alpha}', 'target_modules': '${lora.target_modules}'}, 'actor': {'strategy': 'fsdp', 'ppo_mini_batch_size': '${ppo_mini_batch_size}', 'ppo_micro_batch_size': None, 'ppo_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'use_dynamic_bsz': False, 'ppo_max_token_len_per_gpu': 16384, 'grad_clip': 1.0, 'clip_ratio': 0.2, 'clip_ratio_low': 0.2, 'clip_ratio_high': 0.2, 'clip_ratio_c': 3.0, 'loss_agg_mode': 'token-mean', 'entropy_coeff': 0.001, 'use_kl_loss': False, 'use_torch_compile': True, 'kl_loss_coef': 0.001, 'kl_loss_type': 'kl', 'ppo_epochs': 1, 'shuffle': False, 'ulysses_sequence_parallel_size': 1, 'checkpoint': {'contents': ['model', 'optimizer', 'extra']}, 'optim': {'lr': 1e-06, 'lr_warmup_steps': -1, 'lr_warmup_steps_ratio': 0.0, 'min_lr_ratio': None, 'warmup_style': 'constant', 'total_training_steps': -1, 'weight_decay': 0.01, 'betas': [0.9, 0.999]}, 'fsdp_config': {'wrap_policy': {'min_num_params': 0}, 'param_offload': False, 'optimizer_offload': False, 'offload_policy': False, 'reshard_after_forward': True, 'fsdp_size': -1}, 'micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'use_ref': True, 'grpo_advantage_length_weight': '${grpo_advantage_length_weight}'}, 'ref': {'strategy': 'fsdp', 'fsdp_config': {'param_offload': False, 'reshard_after_forward': True, 'wrap_policy': {'min_num_params': 0}}, 'use_torch_compile': '${actor_rollout_ref.actor.use_torch_compile}', 'log_prob_micro_batch_size': None, 'log_prob_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'log_prob_use_dynamic_bsz': '${actor_rollout_ref.actor.use_dynamic_bsz}', 'log_prob_max_token_len_per_gpu': '${actor_rollout_ref.actor.ppo_max_token_len_per_gpu}', 'ulysses_sequence_parallel_size': '${actor_rollout_ref.actor.ulysses_sequence_parallel_size}'}, 'rollout': {'name': 'vllm', 'mode': 'sync', 'chat_scheduler': None, 'temperature': 1, 'top_k': -1, 'top_p': 1, 'use_fire_sampling': False, 'prompt_length': 1, 'response_length': 128, 'dtype': 'bfloat16', 'gpu_memory_utilization': 0.5, 'ignore_eos': False, 'enforce_eager': True, 'free_cache_engine': True, 'load_format': 'dummy_dtensor', 'tensor_model_parallel_size': 1, 'max_num_batched_tokens': 8192, 'max_model_len': 2048, 'max_num_seqs': 1024, 'log_prob_micro_batch_size': None, 'log_prob_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'log_prob_use_dynamic_bsz': '${actor_rollout_ref.actor.use_dynamic_bsz}', 'log_prob_max_token_len_per_gpu': '${actor_rollout_ref.actor.ppo_max_token_len_per_gpu}', 'disable_log_stats': True, 'enable_chunked_prefill': True, 'do_sample': True, 'n': 1, 'engine_kwargs': {'swap_space': None}, 'val_kwargs': {'top_k': -1, 'top_p': 1.0, 'temperature': 0.5, 'n': 1, 'do_sample': True}, 'multi_turn': {'enable': False, 'max_turns': None, 'tool_config_path': None, 'format': 'chatml'}, 'rollout_filter_ratio': 1, 'rollout_filter_type': 'std', 'tp_size_check': True}}, 'critic': {'rollout_n': '${actor_rollout_ref.rollout.n}', 'strategy': 'fsdp', 'optim': {'lr': 1e-05, 'lr_warmup_steps_ratio': 0.0, 'min_lr_ratio': None, 'warmup_style': 'constant', 'total_training_steps': -1, 'weight_decay': 0.01, 'betas': [0.9, 0.999]}, 'model': {'path': '${model_path}', 'tokenizer_path': '${actor_rollout_ref.model.path}', 'override_config': {}, 'external_lib': '${actor_rollout_ref.model.external_lib}', 'enable_gradient_checkpointing': True, 'use_remove_padding': False, 'fsdp_config': {'param_offload': False, 'optimizer_offload': False, 'offload_policy': False, 'reshard_after_forward': True, 'wrap_policy': {'min_num_params': 0}, 'fsdp_size': -1}, 'lora_rank': '${lora.rank}', 'lora_alpha': '${lora.alpha}', 'target_modules': '${lora.target_modules}'}, 'ppo_mini_batch_size': '${ppo_mini_batch_size}', 'ppo_micro_batch_size': None, 'ppo_micro_batch_size_per_gpu': '${micro_batch_size_per_gpu}', 'forward_micro_batch_size': '${critic.ppo_micro_batch_size}', 'forward_micro_batch_size_per_gpu': '${critic.ppo_micro_batch_size_per_gpu}', 'use_dynamic_bsz': '${actor_rollout_ref.actor.use_dynamic_bsz}', 'ppo_max_token_len_per_gpu': 32768, 'forward_max_token_len_per_gpu': '${critic.ppo_max_token_len_per_gpu}', 'ulysses_sequence_parallel_size': 1, 'ppo_epochs': '${actor_rollout_ref.actor.ppo_epochs}', 'shuffle': '${actor_rollout_ref.actor.shuffle}', 'grad_clip': 1.0, 'cliprange_value': 0.5, 'checkpoint': {'contents': ['model', 'optimizer', 'extra']}}, 'reward_model': {'enable': False, 'strategy': 'fsdp', 'model': {'input_tokenizer': '${actor_rollout_ref.model.path}', 'path': '~/models/FsfairX-LLaMA3-RM-v0.1', 'external_lib': '${actor_rollout_ref.model.external_lib}', 'use_remove_padding': False, 'fsdp_config': {'wrap_policy': {'min_num_params': 0}, 'param_offload': False, 'reshard_after_forward': True, 'fsdp_size': -1}}, 'micro_batch_size': None, 'micro_batch_size_per_gpu': None, 'max_length': None, 'ulysses_sequence_parallel_size': 1, 'use_dynamic_bsz': '${critic.use_dynamic_bsz}', 'forward_max_token_len_per_gpu': '${critic.forward_max_token_len_per_gpu}', 'reward_manager': 'naive', 'launch_reward_fn_async': False}, 'custom_reward_function': {'path': None, 'name': 'compute_score'}, 'algorithm': {'gamma': 1.0, 'lam': 1.0, 'adv_estimator': 'gae', 'norm_adv_by_std_in_grpo': True, 'use_kl_in_reward': False, 'kl_penalty': 'kl', 'kl_ctrl': {'type': 'fixed', 'kl_coef': 0.001, 'horizon': 10000, 'target_kl': 0.1}, 'high_level_gamma': 0.95, 'bi_level_gae': False}, 'trainer': {'balance_batch': True, 'total_epochs': 30, 'total_training_steps': 200, 'project_name': 'ragen_latest', 'experiment_name': 'bandit-ppo', 'logger': ['console', 'wandb'], 'log_val_generations': 0, 'rollout_data_dir': None, 'validation_data_dir': None, 'nnodes': 1, 'n_gpus_per_node': 1, 'save_freq': -1, 'resume_mode': 'auto', 'resume_from_path': None, 'val_before_train': True, 'test_freq': 10, 'critic_warmup': 0, 'default_hdfs_dir': None, 'del_local_ckpt_after_load': False, 'default_local_dir': 'checkpoints/${trainer.project_name}/${trainer.experiment_name}', 'max_actor_ckpt_to_keep': None, 'max_critic_ckpt_to_keep': None, 'ray_wait_register_center_timeout': 300, 'validation_steps': 1, 'generations_to_log_to_wandb': {'train': 128, 'val': 20}}, 'ray_init': {'num_cpus': None}, 'custom_envs': {'SimpleSokoban': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'dim_x': 6, 'dim_y': 6, 'num_boxes': 1, 'max_steps': 100}}, 'LargerSokoban': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'dim_x': 8, 'dim_y': 8, 'num_boxes': 2, 'max_steps': 100, 'search_depth': 10}}, 'SokobanDifferentGridVocab': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'search_depth': 30, 'dim_x': 6, 'dim_y': 6, 'num_boxes': 1, 'max_steps': 100, 'grid_lookup': {0: 'W', 1: '.', 2: 'G', 3: 'C', 4: 'B', 5: 'A', 6: '@'}, 'grid_vocab': {'W': 'wall', '.': 'empty', 'G': 'target', 'C': 'box on target', 'B': 'box', 'A': 'player', '@': 'player on target'}}}, 'VisualSimpleSokoban': {'env_type': 'sokoban', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the Sokoban puzzle. You are the player and you need to push all boxes to targets. When you are right next to a box, you can push it by moving in the same direction. You cannot push a box through a wall, and you cannot pull a box. The answer should be a sequence of actions, like <answer>Right || Right || Up</answer>', 'max_tokens': 100, 'env_config': {'dim_x': 6, 'dim_y': 6, 'num_boxes': 1, 'max_steps': 100, 'render_mode': 'rgb_array'}}, 'Countdown': {'env_type': 'countdown', 'max_actions_per_traj': 1, 'env_instruction': "You are solving the Countdown puzzle. You should use the num list to create an equation that equals the target. Example answer format: <think> To find an equation using [3, 5, 2] to get 4. Let's check 2 + 5 = 7, 7 - 3 = 4. So the answer is 2 + 5 - 3 = 4. </think><answer>2 + 5 - 3</answer>", 'max_tokens': 100, 'env_config': None}, 'Bandit': {'env_type': 'bandit', 'max_actions_per_traj': 1, 'env_instruction': '', 'max_tokens': 100, 'env_config': {'lo_arm_name': 'Phoenix', 'hi_arm_name': 'Dragon'}}, 'BanditTest': {'env_type': 'bandit', 'max_actions_per_traj': 1, 'env_instruction': '', 'max_tokens': 100, 'env_config': {'lo_arm_name': 'Trader', 'hi_arm_name': 'Librarian'}}, 'FrozenLake': {'env_type': 'frozen_lake', 'max_actions_per_traj': 10, 'env_instruction': 'You are solving the FrozenLake puzzle. Forbid the whole and go to the target. You may move to the unintended direction due to the slippery ice. Example answer format: <think>To forbid the hole and go to the target, I should go left then go up.</think><answer>Left || Up</answer>', 'max_tokens': 100, 'env_config': None}, 'MetamathQA': {'env_type': 'metamathqa', 'max_actions_per_traj': 1, 'env_instruction': 'You are solving Math problems. ', 'max_tokens': 100, 'env_config': None}, 'WebShop': {'env_type': 'webshop', 'max_actions_per_traj': 9, 'env_instruction': 'You are browsing an online shop. Based on the instruction, buy a product that close to the production description. You need to search, read the search results, pick a product, choose the size and color and buy. You should only choose action from the available actions list provided later.  Example process: I need a gingko light and 20x20 pillow cover that is hand painted. First search[gingko light 20x20 pillow cover hand painted], answer format: <answer>search[blanket with fleece throw]</answer>. Valid answer is search[<keywords>] or click[<clickable>].', 'max_tokens': 200, 'env_config': {'dataset': 'small'}}}, 'system': {'CUDA_VISIBLE_DEVICES': 0}, 'micro_batch_size_per_gpu': 1, 'ppo_mini_batch_size': 8, 'model_path': 'Qwen/Qwen2.5-0.5B-Instruct', 'enable_response_mask': True, 'grpo_advantage_length_weight': False, 'lora': {'rank': 0, 'alpha': 16, 'target_modules': 'all-linear'}, 'agent_proxy': {'max_turn': 1, 'action_sep': '||', 'max_actions_per_turn': 1, 'use_turn_scores': False, 'enable_think': True, 'reward_normalization': {'grouping': 'state', 'method': 'identity'}}, 'es_manager': {'format_penalty': -0.1, 'train': {'env_groups': 8, 'group_size': 16, 'env_configs': {'tags': ['Bandit'], 'n_groups': [8]}}, 'val': {'env_groups': 512, 'group_size': 1, 'env_configs': {'tags': ['Bandit', 'BanditTest'], 'n_groups': [256, 256]}}}, 'ctx_manager': {'generation': {'gen_config': {'response_length': '${actor_rollout_ref.rollout.response_length}', 'temperature': '${actor_rollout_ref.rollout.temperature}', 'top_p': '${actor_rollout_ref.rollout.top_p}', 'top_k': '${actor_rollout_ref.rollout.top_k}', 'kwargs': None}}}}
CUDA_VISIBLE_DEVICES: 0
[36m(TaskRunner pid=850907)[0m [DEBUG] using ref policy
[36m(TaskRunner pid=850907)[0m using dummy reward manager
[36m(TaskRunner pid=850907)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=850907)[0m Total training steps: 200
[36m(TaskRunner pid=850907)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=855141)[0m Critic overriding config {'bos_token_id': None, 'eos_token_id': 151645, 'pad_token_id': 151643}
[36m(WorkerDict pid=855141)[0m Qwen2ForTokenClassification contains 494.03M parameters
[36m(WorkerDict pid=855141)[0m Before critic FSDP, memory allocated (GB): 0.00, memory reserved (GB): 0.00, device memory used/total (GB): 0.42/44.52
[36m(WorkerDict pid=855141)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=855141)[0m After critic FSDP, memory allocated (GB): 1.84, memory reserved (GB): 2.96, device memory used/total (GB): 3.58/44.52
[36m(WorkerDict pid=855141)[0m Total steps: 200, num_warmup_steps: 0
[36m(WorkerDict pid=855141)[0m Critic use_remove_padding=False
[36m(WorkerDict pid=855141)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=855141)[0m   "architectures": [
[36m(WorkerDict pid=855141)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=855141)[0m   ],
[36m(WorkerDict pid=855141)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=855141)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=855141)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=855141)[0m   "hidden_size": 896,
[36m(WorkerDict pid=855141)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=855141)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=855141)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=855141)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=855141)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=855141)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=855141)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=855141)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=855141)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=855141)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=855141)[0m   "rope_scaling": null,
[36m(WorkerDict pid=855141)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=855141)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=855141)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=855141)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=855141)[0m   "transformers_version": "4.52.3",
[36m(WorkerDict pid=855141)[0m   "use_cache": true,
[36m(WorkerDict pid=855141)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=855141)[0m   "vocab_size": 151936
[36m(WorkerDict pid=855141)[0m }
[36m(WorkerDict pid=855141)[0m 
[36m(WorkerDict pid=855141)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=855141)[0m wrap_policy: functools.partial(<function _or_policy at 0x7eeec8d92ca0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7eeec8d92b60>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=855141)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=855141)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=855141)[0m   "architectures": [
[36m(WorkerDict pid=855141)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=855141)[0m   ],
[36m(WorkerDict pid=855141)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=855141)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=855141)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=855141)[0m   "hidden_size": 896,
[36m(WorkerDict pid=855141)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=855141)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=855141)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=855141)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=855141)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=855141)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=855141)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=855141)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=855141)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=855141)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=855141)[0m   "rope_scaling": null,
[36m(WorkerDict pid=855141)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=855141)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=855141)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=855141)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=855141)[0m   "transformers_version": "4.52.3",
[36m(WorkerDict pid=855141)[0m   "use_cache": true,
[36m(WorkerDict pid=855141)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=855141)[0m   "vocab_size": 151936
[36m(WorkerDict pid=855141)[0m }
[36m(WorkerDict pid=855141)[0m 
[36m(WorkerDict pid=855141)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=855141)[0m wrap_policy: functools.partial(<function _or_policy at 0x7eeec8d92ca0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7eeec8d92b60>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=855141)[0m Total steps: 200, num_warmup_steps: 0
[36m(WorkerDict pid=855141)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=855141)[0m WARNING 05-30 10:39:22 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=855141)[0m WARNING 05-30 10:39:22 [utils.py:2321] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7eed2f24d250>
[36m(WorkerDict pid=855141)[0m WARNING 05-30 10:39:23 [topk_topp_sampler.py:63] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
[36m(WorkerDict pid=855141)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 128, 'detokenize': False, 'temperature': 1, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(TaskRunner pid=850907)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=850907)[0m Checkpoint tracker file does not exist: %s /scr/jwiseman/RAGEN/checkpoints/ragen_latest/bandit-ppo/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=850907)[0m Training from scratch
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 2.682443141937256 seconds
[36m(TaskRunner pid=850907)[0m ("Initial validation metrics: {'val-env/Bandit/success': 0.08203125, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/num_actions': 0.82421875, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/action_is_effective': 0.82421875, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/action_is_valid': 0.82421875, 'val-env/BanditTest/success': "
[36m(TaskRunner pid=850907)[0m  "0.44140625, 'val-env/BanditTest/num_actions': 0.81640625, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/action_is_effective': 0.81640625, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/action_is_valid': 0.81640625, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/non-zero/success': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/non-zero/num_actions': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/non-zero/action_is_effective': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/non-zero/action_is_valid': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/non-zero/success': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/non-zero/num_actions': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/non-zero/action_is_effective': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/non-zero/action_is_valid': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/response_length': 67.9453125, 'val-core/unknown/reward/mean@512': "
[36m(TaskRunner pid=850907)[0m  "0.09257812556461431, 'val-aux/unknown/reward/std@512': 0.2312998127689849, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@2/mean': 0.20390000104159117, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@2/std': 0.31631438443837934, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@2/mean': 0.010000000104308128, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@2/std': 0.09979980064267782, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@4/mean': 0.2893000011369586, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@4/std': 0.37004798279351214, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@4/mean': -0.038700000576674935, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@4/std': 0.07383976003814952, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@8/mean': 0.43390000093728304, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@8/std': 0.4347652117799703, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@8/mean': -0.07660000114142895, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@8/std': 0.04745987849887465, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@16/mean': 0.6544000005722046, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@16/std': 0.4377221028981054, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@16/mean': -0.09410000140219926, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@16/std': 0.023983119420584093, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@32/mean': 0.8569000002369285, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@32/std': 0.3291084770122728, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@32/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@32/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@64/mean': 0.9802000000327825, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@64/std': 0.13201499892924892, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@64/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@64/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@128/mean': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@128/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@128/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@128/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@256/mean': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@256/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@256/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@256/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-core/unknown/reward/best@512/mean': 1.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@512/mean': -0.10000000149011612}")
[36m(TaskRunner pid=850907)[0m step:0 - val-env/Bandit/success:0.082 - val-env/Bandit/num_actions:0.824 - val-env/Bandit/action_is_effective:0.824 - val-env/Bandit/action_is_valid:0.824 - val-env/BanditTest/success:0.441 - val-env/BanditTest/num_actions:0.816 - val-env/BanditTest/action_is_effective:0.816 - val-env/BanditTest/action_is_valid:0.816 - val-env/Bandit/non-zero/success:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:67.945 - val-core/unknown/reward/mean@512:0.093 - val-aux/unknown/reward/std@512:0.231 - val-aux/unknown/reward/best@2/mean:0.204 - val-aux/unknown/reward/best@2/std:0.316 - val-aux/unknown/reward/worst@2/mean:0.010 - val-aux/unknown/reward/worst@2/std:0.100 - val-aux/unknown/reward/best@4/mean:0.289 - val-aux/unknown/reward/best@4/std:0.370 - val-aux/unknown/reward/worst@4/mean:-0.039 - val-aux/unknown/reward/worst@4/std:0.074 - val-aux/unknown/reward/best@8/mean:0.434 - val-aux/unknown/reward/best@8/std:0.435 - val-aux/unknown/reward/worst@8/mean:-0.077 - val-aux/unknown/reward/worst@8/std:0.047 - val-aux/unknown/reward/best@16/mean:0.654 - val-aux/unknown/reward/best@16/std:0.438 - val-aux/unknown/reward/worst@16/mean:-0.094 - val-aux/unknown/reward/worst@16/std:0.024 - val-aux/unknown/reward/best@32/mean:0.857 - val-aux/unknown/reward/best@32/std:0.329 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.980 - val-aux/unknown/reward/best@64/std:0.132 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:1 - train/Bandit/success:0.086 - train/Bandit/num_actions:0.430 - train/Bandit/action_is_effective:0.430 - train/Bandit/action_is_valid:0.430 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:83.242 - global_seqlen/min:36767.000 - global_seqlen/max:36767.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36767.000 - global_seqlen/balanced_max:36767.000 - global_seqlen/mean:36767.000 - critic/vf_loss:10.695 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.609 - critic/grad_norm:725.762 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.791 - actor/grad_norm:64.586 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.234 - actor/lr:0.000 - critic/score/mean:0.001 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.001 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.109 - critic/advantages/max:3.323 - critic/advantages/min:-4.916 - critic/returns/mean:-0.004 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.207 - critic/values/max:21.500 - critic/values/min:-15.875 - critic/vf_explained_var:-188.241 - response_length/mean:287.148 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.117 - prompt_length/mean:0.094 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.094 - timing_s/gen:1.460 - timing_s/old_log_prob:5.207 - timing_s/ref:8.719 - timing_s/values:4.057 - timing_s/adv:0.022 - timing_s/update_critic:18.877 - timing_s/update_actor:20.716 - timing_s/step:59.062 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/update_actor:0.563 - timing_per_token_ms/values:0.110 - timing_per_token_ms/update_critic:0.513 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.040 - perf/total_num_tokens:36767.000 - perf/time_per_step:59.062 - perf/throughput:622.515 - timing_s/total:59.064
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:2 - train/Bandit/success:0.070 - train/Bandit/num_actions:0.484 - train/Bandit/action_is_effective:0.484 - train/Bandit/action_is_valid:0.484 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:75.734 - global_seqlen/min:35806.000 - global_seqlen/max:35806.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35806.000 - global_seqlen/balanced_max:35806.000 - global_seqlen/mean:35806.000 - critic/vf_loss:11.066 - critic/vf_clipfrac:0.534 - critic/vpred_mean:-0.066 - critic/grad_norm:444.499 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.087 - actor/ppo_kl:0.201 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.706 - actor/grad_norm:21.955 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.311 - actor/lr:0.000 - critic/score/mean:0.013 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.013 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.086 - critic/advantages/max:2.811 - critic/advantages/min:-4.929 - critic/returns/mean:0.011 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.147 - critic/values/max:21.625 - critic/values/min:-13.250 - critic/vf_explained_var:-179.496 - response_length/mean:279.656 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.094 - prompt_length/mean:0.078 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.078 - timing_s/gen:1.572 - timing_s/old_log_prob:4.808 - timing_s/ref:7.348 - timing_s/values:4.095 - timing_s/adv:0.022 - timing_s/update_critic:18.970 - timing_s/update_actor:20.943 - timing_s/step:57.762 - timing_per_token_ms/ref:0.205 - timing_per_token_ms/update_actor:0.585 - timing_per_token_ms/values:0.114 - timing_per_token_ms/update_critic:0.530 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:35806.000 - perf/time_per_step:57.762 - perf/throughput:619.890 - timing_s/total:116.830
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:3 - train/Bandit/success:0.016 - train/Bandit/num_actions:0.312 - train/Bandit/action_is_effective:0.312 - train/Bandit/action_is_valid:0.312 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:101.508 - global_seqlen/min:39105.000 - global_seqlen/max:39105.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39105.000 - global_seqlen/balanced_max:39105.000 - global_seqlen/mean:39105.000 - critic/vf_loss:2.079 - critic/vf_clipfrac:0.719 - critic/vpred_mean:-0.468 - critic/grad_norm:80.842 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.040 - actor/pg_clipfrac:0.044 - actor/ppo_kl:-0.041 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.731 - actor/grad_norm:14.090 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.350 - actor/lr:0.000 - critic/score/mean:-0.031 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:-0.031 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.819 - critic/advantages/max:5.521 - critic/advantages/min:-9.061 - critic/returns/mean:-0.036 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.621 - critic/values/max:11.750 - critic/values/min:-10.250 - critic/vf_explained_var:-91.746 - response_length/mean:305.273 - response_length/max:338.000 - response_length/min:230.000 - response_length/clip_ratio:0.320 - prompt_length/mean:0.234 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.234 - timing_s/gen:1.600 - timing_s/old_log_prob:4.730 - timing_s/ref:7.203 - timing_s/values:3.944 - timing_s/adv:0.026 - timing_s/update_critic:18.784 - timing_s/update_actor:20.553 - timing_s/step:56.841 - timing_per_token_ms/ref:0.184 - timing_per_token_ms/update_actor:0.526 - timing_per_token_ms/values:0.101 - timing_per_token_ms/update_critic:0.480 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.041 - perf/total_num_tokens:39105.000 - perf/time_per_step:56.841 - perf/throughput:687.972 - timing_s/total:173.674
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:4 - train/Bandit/success:0.047 - train/Bandit/num_actions:0.125 - train/Bandit/action_is_effective:0.125 - train/Bandit/action_is_valid:0.125 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:107.406 - global_seqlen/min:39860.000 - global_seqlen/max:39860.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39860.000 - global_seqlen/balanced_max:39860.000 - global_seqlen/mean:39860.000 - critic/vf_loss:0.687 - critic/vf_clipfrac:0.314 - critic/vpred_mean:-0.664 - critic/grad_norm:207.851 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.027 - actor/pg_clipfrac:0.040 - actor/ppo_kl:0.010 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.776 - actor/grad_norm:12.462 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.410 - actor/lr:0.000 - critic/score/mean:-0.064 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:-0.064 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.885 - critic/advantages/max:6.305 - critic/advantages/min:-11.257 - critic/returns/mean:-0.069 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.371 - critic/values/max:7.719 - critic/values/min:-6.031 - critic/vf_explained_var:-25.801 - response_length/mean:311.070 - response_length/max:338.000 - response_length/min:233.000 - response_length/clip_ratio:0.375 - prompt_length/mean:0.336 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.336 - timing_s/gen:1.643 - timing_s/old_log_prob:4.675 - timing_s/ref:7.115 - timing_s/values:3.868 - timing_s/adv:0.022 - timing_s/update_critic:18.235 - timing_s/update_actor:20.279 - timing_s/step:55.841 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/update_actor:0.509 - timing_per_token_ms/values:0.097 - timing_per_token_ms/update_critic:0.457 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.041 - perf/total_num_tokens:39860.000 - perf/time_per_step:55.841 - perf/throughput:713.810 - timing_s/total:229.518
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:5 - train/Bandit/success:0.039 - train/Bandit/num_actions:0.250 - train/Bandit/action_is_effective:0.250 - train/Bandit/action_is_valid:0.250 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:92.562 - global_seqlen/min:37960.000 - global_seqlen/max:37960.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37960.000 - global_seqlen/balanced_max:37960.000 - global_seqlen/mean:37960.000 - critic/vf_loss:0.522 - critic/vf_clipfrac:0.012 - critic/vpred_mean:0.187 - critic/grad_norm:232.717 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.047 - actor/ppo_kl:0.039 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.642 - actor/grad_norm:32.313 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.466 - actor/lr:0.000 - critic/score/mean:-0.046 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:-0.046 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:0.186 - critic/advantages/max:12.336 - critic/advantages/min:-5.817 - critic/returns/mean:-0.048 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.026 - critic/values/max:1.953 - critic/values/min:-4.031 - critic/vf_explained_var:-1.978 - response_length/mean:296.398 - response_length/max:338.000 - response_length/min:231.000 - response_length/clip_ratio:0.188 - prompt_length/mean:0.164 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.164 - timing_s/gen:1.591 - timing_s/old_log_prob:4.751 - timing_s/ref:7.226 - timing_s/values:4.023 - timing_s/adv:0.022 - timing_s/update_critic:18.806 - timing_s/update_actor:20.474 - timing_s/step:56.896 - timing_per_token_ms/ref:0.190 - timing_per_token_ms/update_actor:0.539 - timing_per_token_ms/values:0.106 - timing_per_token_ms/update_critic:0.495 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.042 - perf/total_num_tokens:37960.000 - perf/time_per_step:56.896 - perf/throughput:667.185 - timing_s/total:286.417
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:6 - train/Bandit/success:0.031 - train/Bandit/num_actions:0.250 - train/Bandit/action_is_effective:0.250 - train/Bandit/action_is_valid:0.250 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:93.828 - global_seqlen/min:38122.000 - global_seqlen/max:38122.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38122.000 - global_seqlen/balanced_max:38122.000 - global_seqlen/mean:38122.000 - critic/vf_loss:0.140 - critic/vf_clipfrac:0.409 - critic/vpred_mean:-0.254 - critic/grad_norm:79.786 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.047 - actor/ppo_kl:0.012 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.749 - actor/grad_norm:15.094 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.506 - actor/lr:0.000 - critic/score/mean:-0.045 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:-0.045 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.233 - critic/advantages/max:6.720 - critic/advantages/min:-7.434 - critic/returns/mean:-0.050 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.264 - critic/values/max:1.000 - critic/values/min:-2.578 - critic/vf_explained_var:-11.344 - response_length/mean:297.664 - response_length/max:338.000 - response_length/min:234.000 - response_length/clip_ratio:0.234 - prompt_length/mean:0.164 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.164 - timing_s/gen:1.622 - timing_s/old_log_prob:4.767 - timing_s/ref:7.213 - timing_s/values:3.968 - timing_s/adv:0.009 - timing_s/update_critic:18.861 - timing_s/update_actor:20.693 - timing_s/step:57.137 - timing_per_token_ms/ref:0.189 - timing_per_token_ms/update_actor:0.543 - timing_per_token_ms/values:0.104 - timing_per_token_ms/update_critic:0.495 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.043 - perf/total_num_tokens:38122.000 - perf/time_per_step:57.137 - perf/throughput:667.206 - timing_s/total:343.557
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:7 - train/Bandit/success:0.164 - train/Bandit/num_actions:0.414 - train/Bandit/action_is_effective:0.414 - train/Bandit/action_is_valid:0.414 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:90.953 - global_seqlen/min:37754.000 - global_seqlen/max:37754.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37754.000 - global_seqlen/balanced_max:37754.000 - global_seqlen/mean:37754.000 - critic/vf_loss:0.212 - critic/vf_clipfrac:0.116 - critic/vpred_mean:0.277 - critic/grad_norm:118.304 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.060 - actor/pg_clipfrac:0.044 - actor/ppo_kl:0.039 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.569 - actor/grad_norm:46.070 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.543 - actor/lr:0.000 - critic/score/mean:0.037 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.037 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:1.220 - critic/advantages/max:7.629 - critic/advantages/min:-7.405 - critic/returns/mean:0.027 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.141 - critic/values/max:2.609 - critic/values/min:-1.766 - critic/vf_explained_var:-0.791 - response_length/mean:294.828 - response_length/max:338.000 - response_length/min:225.000 - response_length/clip_ratio:0.188 - prompt_length/mean:0.125 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.125 - timing_s/gen:1.603 - timing_s/old_log_prob:4.743 - timing_s/ref:7.259 - timing_s/values:3.927 - timing_s/adv:0.009 - timing_s/update_critic:18.432 - timing_s/update_actor:20.760 - timing_s/step:56.738 - timing_per_token_ms/ref:0.192 - timing_per_token_ms/update_actor:0.550 - timing_per_token_ms/values:0.104 - timing_per_token_ms/update_critic:0.488 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.042 - perf/total_num_tokens:37754.000 - perf/time_per_step:56.738 - perf/throughput:665.413 - timing_s/total:400.298
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:8 - train/Bandit/success:0.172 - train/Bandit/num_actions:0.680 - train/Bandit/action_is_effective:0.680 - train/Bandit/action_is_valid:0.680 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:78.180 - global_seqlen/min:36119.000 - global_seqlen/max:36119.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36119.000 - global_seqlen/balanced_max:36119.000 - global_seqlen/mean:36119.000 - critic/vf_loss:0.191 - critic/vf_clipfrac:0.017 - critic/vpred_mean:-0.142 - critic/grad_norm:101.466 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.085 - actor/ppo_kl:0.120 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.583 - actor/grad_norm:10.235 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.526 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:0.464 - critic/advantages/max:4.307 - critic/advantages/min:-6.584 - critic/returns/mean:0.089 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.051 - critic/values/max:2.203 - critic/values/min:-0.574 - critic/vf_explained_var:-0.292 - response_length/mean:282.172 - response_length/max:338.000 - response_length/min:229.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.601 - timing_s/old_log_prob:5.136 - timing_s/ref:7.367 - timing_s/values:4.146 - timing_s/adv:0.022 - timing_s/update_critic:18.640 - timing_s/update_actor:20.743 - timing_s/step:57.660 - timing_per_token_ms/ref:0.204 - timing_per_token_ms/update_actor:0.574 - timing_per_token_ms/values:0.115 - timing_per_token_ms/update_critic:0.516 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:36119.000 - perf/time_per_step:57.660 - perf/throughput:626.416 - timing_s/total:457.960
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:9 - train/Bandit/success:0.352 - train/Bandit/num_actions:0.734 - train/Bandit/action_is_effective:0.734 - train/Bandit/action_is_valid:0.734 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:83.773 - global_seqlen/min:36835.000 - global_seqlen/max:36835.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36835.000 - global_seqlen/balanced_max:36835.000 - global_seqlen/mean:36835.000 - critic/vf_loss:0.035 - critic/vf_clipfrac:0.001 - critic/vpred_mean:0.085 - critic/grad_norm:40.221 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.071 - actor/ppo_kl:0.084 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:1.558 - actor/grad_norm:16.305 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.564 - actor/lr:0.000 - critic/score/mean:0.051 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.051 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.021 - critic/advantages/max:5.364 - critic/advantages/min:-4.212 - critic/returns/mean:0.047 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.006 - critic/values/max:1.008 - critic/values/min:-0.996 - critic/vf_explained_var:-0.125 - response_length/mean:287.750 - response_length/max:338.000 - response_length/min:236.000 - response_length/clip_ratio:0.070 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.625 - timing_s/old_log_prob:4.873 - timing_s/ref:7.342 - timing_s/values:4.072 - timing_s/adv:0.022 - timing_s/update_critic:19.047 - timing_s/update_actor:20.907 - timing_s/step:57.889 - timing_per_token_ms/ref:0.199 - timing_per_token_ms/update_actor:0.568 - timing_per_token_ms/values:0.111 - timing_per_token_ms/update_critic:0.517 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:36835.000 - perf/time_per_step:57.889 - perf/throughput:636.302 - timing_s/total:515.853
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.1196889877319336 seconds
[36m(TaskRunner pid=850907)[0m step:10 - train/Bandit/success:0.258 - train/Bandit/num_actions:0.703 - train/Bandit/action_is_effective:0.703 - train/Bandit/action_is_valid:0.703 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:74.250 - global_seqlen/min:35616.000 - global_seqlen/max:35616.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35616.000 - global_seqlen/balanced_max:35616.000 - global_seqlen/mean:35616.000 - critic/vf_loss:0.097 - critic/vf_clipfrac:0.009 - critic/vpred_mean:0.123 - critic/grad_norm:93.138 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.043 - actor/pg_clipfrac:0.064 - actor/ppo_kl:0.011 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.595 - actor/grad_norm:17.172 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.631 - actor/lr:0.000 - val-env/Bandit/success:0.285 - val-env/Bandit/num_actions:0.980 - val-env/Bandit/action_is_effective:0.980 - val-env/Bandit/action_is_valid:0.980 - val-env/BanditTest/success:0.582 - val-env/BanditTest/num_actions:0.977 - val-env/BanditTest/action_is_effective:0.977 - val-env/BanditTest/action_is_valid:0.977 - val-env/Bandit/non-zero/success:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:63.863 - val-core/unknown/reward/mean@512:0.140 - val-aux/unknown/reward/std@512:0.272 - val-aux/unknown/reward/best@2/mean:0.251 - val-aux/unknown/reward/best@2/std:0.355 - val-aux/unknown/reward/worst@2/mean:0.044 - val-aux/unknown/reward/worst@2/std:0.093 - val-aux/unknown/reward/best@4/mean:0.372 - val-aux/unknown/reward/best@4/std:0.416 - val-aux/unknown/reward/worst@4/mean:0.009 - val-aux/unknown/reward/worst@4/std:0.048 - val-aux/unknown/reward/best@8/mean:0.569 - val-aux/unknown/reward/best@8/std:0.450 - val-aux/unknown/reward/worst@8/mean:-0.013 - val-aux/unknown/reward/worst@8/std:0.040 - val-aux/unknown/reward/best@16/mean:0.788 - val-aux/unknown/reward/best@16/std:0.382 - val-aux/unknown/reward/worst@16/mean:-0.028 - val-aux/unknown/reward/worst@16/std:0.045 - val-aux/unknown/reward/best@32/mean:0.951 - val-aux/unknown/reward/best@32/std:0.203 - val-aux/unknown/reward/worst@32/mean:-0.048 - val-aux/unknown/reward/worst@32/std:0.050 - val-aux/unknown/reward/best@64/mean:0.999 - val-aux/unknown/reward/best@64/std:0.028 - val-aux/unknown/reward/worst@64/mean:-0.074 - val-aux/unknown/reward/worst@64/std:0.044 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.093 - val-aux/unknown/reward/worst@128/std:0.026 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.099 - val-aux/unknown/reward/worst@256/std:0.008 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.023 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.023 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-1.482 - critic/advantages/max:8.195 - critic/advantages/min:-2.784 - critic/returns/mean:0.019 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.091 - critic/values/max:0.068 - critic/values/min:-0.906 - critic/vf_explained_var:-1.438 - response_length/mean:278.188 - response_length/max:338.000 - response_length/min:228.000 - response_length/clip_ratio:0.078 - prompt_length/mean:0.062 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.062 - timing_s/gen:1.618 - timing_s/old_log_prob:4.850 - timing_s/ref:7.289 - timing_s/values:4.022 - timing_s/adv:0.022 - timing_s/update_critic:19.094 - timing_s/update_actor:20.846 - timing_s/testing:3.436 - timing_s/step:61.182 - timing_per_token_ms/ref:0.205 - timing_per_token_ms/update_actor:0.585 - timing_per_token_ms/values:0.113 - timing_per_token_ms/update_critic:0.536 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:35616.000 - perf/time_per_step:61.182 - perf/throughput:582.133 - timing_s/total:577.038
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:11 - train/Bandit/success:0.117 - train/Bandit/num_actions:0.711 - train/Bandit/action_is_effective:0.711 - train/Bandit/action_is_valid:0.711 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:76.844 - global_seqlen/min:35948.000 - global_seqlen/max:35948.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35948.000 - global_seqlen/balanced_max:35948.000 - global_seqlen/mean:35948.000 - critic/vf_loss:0.014 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.028 - critic/grad_norm:28.844 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.131 - actor/pg_clipfrac:0.061 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:1.572 - actor/grad_norm:23.737 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.660 - actor/lr:0.000 - critic/score/mean:0.030 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.030 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.261 - critic/advantages/max:4.740 - critic/advantages/min:-3.729 - critic/returns/mean:0.025 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.016 - critic/values/max:0.232 - critic/values/min:-0.680 - critic/vf_explained_var:-0.117 - response_length/mean:280.820 - response_length/max:338.000 - response_length/min:225.000 - response_length/clip_ratio:0.055 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.452 - timing_s/old_log_prob:4.807 - timing_s/ref:7.316 - timing_s/values:4.146 - timing_s/adv:0.022 - timing_s/update_critic:18.986 - timing_s/update_actor:21.126 - timing_s/step:57.857 - timing_per_token_ms/ref:0.204 - timing_per_token_ms/update_actor:0.588 - timing_per_token_ms/values:0.115 - timing_per_token_ms/update_critic:0.528 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.040 - perf/total_num_tokens:35948.000 - perf/time_per_step:57.857 - perf/throughput:621.326 - timing_s/total:634.898
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:12 - train/Bandit/success:0.125 - train/Bandit/num_actions:0.797 - train/Bandit/action_is_effective:0.797 - train/Bandit/action_is_valid:0.797 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:69.625 - global_seqlen/min:35024.000 - global_seqlen/max:35024.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35024.000 - global_seqlen/balanced_max:35024.000 - global_seqlen/mean:35024.000 - critic/vf_loss:0.038 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.033 - critic/grad_norm:45.406 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.078 - actor/pg_clipfrac:0.069 - actor/ppo_kl:-0.034 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:1.579 - actor/grad_norm:17.900 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.676 - actor/lr:0.000 - critic/score/mean:0.047 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.047 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-1.093 - critic/advantages/max:4.928 - critic/advantages/min:-4.982 - critic/returns/mean:0.044 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.036 - critic/values/max:0.168 - critic/values/min:-0.520 - critic/vf_explained_var:-0.489 - response_length/mean:273.602 - response_length/max:337.000 - response_length/min:228.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.606 - timing_s/old_log_prob:4.826 - timing_s/ref:7.315 - timing_s/values:4.159 - timing_s/adv:0.010 - timing_s/update_critic:19.293 - timing_s/update_actor:20.948 - timing_s/step:58.162 - timing_per_token_ms/ref:0.209 - timing_per_token_ms/update_actor:0.598 - timing_per_token_ms/values:0.119 - timing_per_token_ms/update_critic:0.551 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:35024.000 - perf/time_per_step:58.162 - perf/throughput:602.184 - timing_s/total:693.063
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:13 - train/Bandit/success:0.164 - train/Bandit/num_actions:0.875 - train/Bandit/action_is_effective:0.875 - train/Bandit/action_is_valid:0.875 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:64.625 - global_seqlen/min:34384.000 - global_seqlen/max:34384.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34384.000 - global_seqlen/balanced_max:34384.000 - global_seqlen/mean:34384.000 - critic/vf_loss:0.066 - critic/vf_clipfrac:0.387 - critic/vpred_mean:-0.014 - critic/grad_norm:36.710 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.135 - actor/pg_clipfrac:0.074 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:1.541 - actor/grad_norm:5.257 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.709 - actor/lr:0.000 - critic/score/mean:0.121 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.121 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-1.830 - critic/advantages/max:5.065 - critic/advantages/min:-3.455 - critic/returns/mean:0.115 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.129 - critic/values/max:-0.000 - critic/values/min:-1.047 - critic/vf_explained_var:-0.885 - response_length/mean:268.609 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.549 - timing_s/old_log_prob:4.860 - timing_s/ref:7.378 - timing_s/values:4.190 - timing_s/adv:0.022 - timing_s/update_critic:19.192 - timing_s/update_actor:20.940 - timing_s/step:58.133 - timing_per_token_ms/ref:0.215 - timing_per_token_ms/update_actor:0.609 - timing_per_token_ms/values:0.122 - timing_per_token_ms/update_critic:0.558 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:34384.000 - perf/time_per_step:58.133 - perf/throughput:591.471 - timing_s/total:751.200
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:14 - train/Bandit/success:0.086 - train/Bandit/num_actions:0.867 - train/Bandit/action_is_effective:0.867 - train/Bandit/action_is_valid:0.867 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:56.266 - global_seqlen/min:33314.000 - global_seqlen/max:33314.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33314.000 - global_seqlen/balanced_max:33314.000 - global_seqlen/mean:33314.000 - critic/vf_loss:0.074 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.123 - critic/grad_norm:70.700 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.096 - actor/ppo_kl:-0.069 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:1.485 - actor/grad_norm:4.965 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.728 - actor/lr:0.000 - critic/score/mean:0.096 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.096 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.416 - critic/advantages/max:4.696 - critic/advantages/min:-1.638 - critic/returns/mean:0.096 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.025 - critic/values/max:0.123 - critic/values/min:-0.330 - critic/vf_explained_var:-0.052 - response_length/mean:260.242 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.039 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.562 - timing_s/old_log_prob:4.837 - timing_s/ref:7.362 - timing_s/values:4.121 - timing_s/adv:0.022 - timing_s/update_critic:19.180 - timing_s/update_actor:20.899 - timing_s/step:57.986 - timing_per_token_ms/ref:0.221 - timing_per_token_ms/update_actor:0.627 - timing_per_token_ms/values:0.124 - timing_per_token_ms/update_critic:0.576 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:33314.000 - perf/time_per_step:57.986 - perf/throughput:574.519 - timing_s/total:809.189
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:15 - train/Bandit/success:0.234 - train/Bandit/num_actions:0.938 - train/Bandit/action_is_effective:0.938 - train/Bandit/action_is_valid:0.938 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:42.781 - global_seqlen/min:31588.000 - global_seqlen/max:31588.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31588.000 - global_seqlen/balanced_max:31588.000 - global_seqlen/mean:31588.000 - critic/vf_loss:0.033 - critic/vf_clipfrac:0.015 - critic/vpred_mean:0.029 - critic/grad_norm:49.112 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.119 - actor/pg_clipfrac:0.155 - actor/ppo_kl:0.205 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.341 - actor/grad_norm:14.245 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.757 - actor/lr:0.000 - critic/score/mean:0.064 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.064 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.137 - critic/advantages/max:2.643 - critic/advantages/min:-4.001 - critic/returns/mean:0.063 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.053 - critic/values/max:-0.000 - critic/values/min:-0.656 - critic/vf_explained_var:-3.808 - response_length/mean:246.773 - response_length/max:322.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.733 - timing_s/old_log_prob:4.843 - timing_s/ref:7.340 - timing_s/values:4.098 - timing_s/adv:0.021 - timing_s/update_critic:18.786 - timing_s/update_actor:20.727 - timing_s/step:57.552 - timing_per_token_ms/ref:0.232 - timing_per_token_ms/update_actor:0.656 - timing_per_token_ms/values:0.130 - timing_per_token_ms/update_critic:0.595 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:31588.000 - perf/time_per_step:57.552 - perf/throughput:548.864 - timing_s/total:866.745
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:16 - train/Bandit/success:0.227 - train/Bandit/num_actions:0.922 - train/Bandit/action_is_effective:0.922 - train/Bandit/action_is_valid:0.922 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.898 - global_seqlen/min:32755.000 - global_seqlen/max:32755.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32755.000 - global_seqlen/balanced_max:32755.000 - global_seqlen/mean:32755.000 - critic/vf_loss:0.035 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.029 - critic/grad_norm:36.857 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.072 - actor/pg_clipfrac:0.093 - actor/ppo_kl:0.048 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:1.385 - actor/grad_norm:67.327 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.763 - actor/lr:0.000 - critic/score/mean:0.109 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.109 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:0.623 - critic/advantages/max:5.341 - critic/advantages/min:-1.843 - critic/returns/mean:0.104 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.026 - critic/values/max:0.457 - critic/values/min:-0.197 - critic/vf_explained_var:-0.079 - response_length/mean:255.875 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.591 - timing_s/old_log_prob:4.857 - timing_s/ref:7.357 - timing_s/values:4.064 - timing_s/adv:0.022 - timing_s/update_critic:18.890 - timing_s/update_actor:20.902 - timing_s/step:57.687 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/update_actor:0.638 - timing_per_token_ms/values:0.124 - timing_per_token_ms/update_critic:0.577 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:32755.000 - perf/time_per_step:57.687 - perf/throughput:567.809 - timing_s/total:924.434
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:17 - train/Bandit/success:0.055 - train/Bandit/num_actions:0.930 - train/Bandit/action_is_effective:0.930 - train/Bandit/action_is_valid:0.930 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:48.023 - global_seqlen/min:32259.000 - global_seqlen/max:32259.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32259.000 - global_seqlen/balanced_max:32259.000 - global_seqlen/mean:32259.000 - critic/vf_loss:0.089 - critic/vf_clipfrac:0.041 - critic/vpred_mean:0.266 - critic/grad_norm:85.190 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.071 - actor/pg_clipfrac:0.117 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:1.332 - actor/grad_norm:22.544 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.803 - actor/lr:0.000 - critic/score/mean:0.080 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.080 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:5.874 - critic/advantages/max:7.501 - critic/advantages/min:-4.435 - critic/returns/mean:0.078 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.108 - critic/values/max:0.754 - critic/values/min:0.000 - critic/vf_explained_var:-15.224 - response_length/mean:252.016 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.765 - timing_s/old_log_prob:4.807 - timing_s/ref:7.335 - timing_s/values:4.082 - timing_s/adv:0.022 - timing_s/update_critic:19.175 - timing_s/update_actor:20.895 - timing_s/step:58.083 - timing_per_token_ms/ref:0.227 - timing_per_token_ms/update_actor:0.648 - timing_per_token_ms/values:0.127 - timing_per_token_ms/update_critic:0.594 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:32259.000 - perf/time_per_step:58.083 - perf/throughput:555.397 - timing_s/total:982.520
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:18 - train/Bandit/success:0.070 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:42.617 - global_seqlen/min:31567.000 - global_seqlen/max:31567.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31567.000 - global_seqlen/balanced_max:31567.000 - global_seqlen/mean:31567.000 - critic/vf_loss:0.075 - critic/vf_clipfrac:0.004 - critic/vpred_mean:0.003 - critic/grad_norm:78.663 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.028 - actor/pg_clipfrac:0.143 - actor/ppo_kl:0.098 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.325 - actor/grad_norm:6.151 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.827 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.099 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-3.546 - critic/advantages/max:10.835 - critic/advantages/min:-6.585 - critic/returns/mean:0.099 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.064 - critic/values/max:-0.000 - critic/values/min:-0.734 - critic/vf_explained_var:-2.792 - response_length/mean:246.609 - response_length/max:330.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.655 - timing_s/old_log_prob:4.881 - timing_s/ref:7.367 - timing_s/values:4.151 - timing_s/adv:0.022 - timing_s/update_critic:19.178 - timing_s/update_actor:20.920 - timing_s/step:58.177 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/update_actor:0.663 - timing_per_token_ms/values:0.132 - timing_per_token_ms/update_critic:0.608 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:31567.000 - perf/time_per_step:58.177 - perf/throughput:542.600 - timing_s/total:1040.701
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:19 - train/Bandit/success:0.070 - train/Bandit/num_actions:0.898 - train/Bandit/action_is_effective:0.898 - train/Bandit/action_is_valid:0.898 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.461 - global_seqlen/min:31931.000 - global_seqlen/max:31931.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31931.000 - global_seqlen/balanced_max:31931.000 - global_seqlen/mean:31931.000 - critic/vf_loss:0.067 - critic/vf_clipfrac:0.007 - critic/vpred_mean:-0.027 - critic/grad_norm:69.588 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.099 - actor/pg_clipfrac:0.106 - actor/ppo_kl:0.068 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:1.253 - actor/grad_norm:15.071 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.857 - actor/lr:0.000 - critic/score/mean:0.080 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.080 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:4.024 - critic/advantages/max:14.489 - critic/advantages/min:-2.403 - critic/returns/mean:0.077 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.083 - critic/values/max:0.621 - critic/values/min:0.000 - critic/vf_explained_var:-3.040 - response_length/mean:249.453 - response_length/max:338.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.660 - timing_s/old_log_prob:4.837 - timing_s/ref:7.366 - timing_s/values:4.132 - timing_s/adv:0.022 - timing_s/update_critic:18.647 - timing_s/update_actor:20.774 - timing_s/step:57.441 - timing_per_token_ms/ref:0.231 - timing_per_token_ms/update_actor:0.651 - timing_per_token_ms/values:0.129 - timing_per_token_ms/update_critic:0.584 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:31931.000 - perf/time_per_step:57.441 - perf/throughput:555.890 - timing_s/total:1098.146
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.7286834716796875 seconds
[36m(TaskRunner pid=850907)[0m step:20 - train/Bandit/success:0.055 - train/Bandit/num_actions:0.953 - train/Bandit/action_is_effective:0.953 - train/Bandit/action_is_valid:0.953 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:41.078 - global_seqlen/min:31370.000 - global_seqlen/max:31370.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31370.000 - global_seqlen/balanced_max:31370.000 - global_seqlen/mean:31370.000 - critic/vf_loss:0.027 - critic/vf_clipfrac:0.018 - critic/vpred_mean:0.124 - critic/grad_norm:33.250 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.029 - actor/pg_clipfrac:0.122 - actor/ppo_kl:0.115 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.239 - actor/grad_norm:3.238 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.845 - actor/lr:0.000 - val-env/Bandit/success:0.012 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.777 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/success:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:37.334 - val-core/unknown/reward/mean@512:0.162 - val-aux/unknown/reward/std@512:0.285 - val-aux/unknown/reward/best@2/mean:0.279 - val-aux/unknown/reward/best@2/std:0.370 - val-aux/unknown/reward/worst@2/mean:0.056 - val-aux/unknown/reward/worst@2/std:0.098 - val-aux/unknown/reward/best@4/mean:0.414 - val-aux/unknown/reward/best@4/std:0.430 - val-aux/unknown/reward/worst@4/mean:0.023 - val-aux/unknown/reward/worst@4/std:0.042 - val-aux/unknown/reward/best@8/mean:0.609 - val-aux/unknown/reward/best@8/std:0.446 - val-aux/unknown/reward/worst@8/mean:0.005 - val-aux/unknown/reward/worst@8/std:0.022 - val-aux/unknown/reward/best@16/mean:0.833 - val-aux/unknown/reward/best@16/std:0.350 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.006 - val-aux/unknown/reward/best@32/mean:0.973 - val-aux/unknown/reward/best@32/std:0.154 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.999 - val-aux/unknown/reward/best@64/std:0.028 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.109 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.109 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.002 - critic/advantages/max:6.557 - critic/advantages/min:-3.830 - critic/returns/mean:0.107 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:-0.061 - critic/values/max:-0.000 - critic/values/min:-0.570 - critic/vf_explained_var:-0.799 - response_length/mean:245.070 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.635 - timing_s/old_log_prob:4.855 - timing_s/ref:7.340 - timing_s/values:4.120 - timing_s/adv:0.017 - timing_s/update_critic:19.006 - timing_s/update_actor:20.852 - timing_s/testing:4.045 - timing_s/step:61.875 - timing_per_token_ms/ref:0.234 - timing_per_token_ms/update_actor:0.665 - timing_per_token_ms/values:0.131 - timing_per_token_ms/update_critic:0.606 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:31370.000 - perf/time_per_step:61.875 - perf/throughput:506.989 - timing_s/total:1160.024
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:21 - train/Bandit/success:0.062 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:39.492 - global_seqlen/min:31167.000 - global_seqlen/max:31167.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31167.000 - global_seqlen/balanced_max:31167.000 - global_seqlen/mean:31167.000 - critic/vf_loss:0.019 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.110 - critic/grad_norm:34.048 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.064 - actor/pg_clipfrac:0.159 - actor/ppo_kl:-0.106 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:1.201 - actor/grad_norm:12.743 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.877 - actor/lr:0.000 - critic/score/mean:0.089 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.089 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-1.639 - critic/advantages/max:3.271 - critic/advantages/min:-5.689 - critic/returns/mean:0.088 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.017 - critic/values/max:0.035 - critic/values/min:-0.297 - critic/vf_explained_var:-0.872 - response_length/mean:243.484 - response_length/max:323.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.458 - timing_s/old_log_prob:4.803 - timing_s/ref:7.328 - timing_s/values:4.094 - timing_s/adv:0.021 - timing_s/update_critic:19.027 - timing_s/update_actor:20.983 - timing_s/step:57.716 - timing_per_token_ms/ref:0.235 - timing_per_token_ms/update_actor:0.673 - timing_per_token_ms/values:0.131 - timing_per_token_ms/update_critic:0.610 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:31167.000 - perf/time_per_step:57.716 - perf/throughput:540.004 - timing_s/total:1217.743
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:22 - train/Bandit/success:0.031 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.781 - global_seqlen/min:31076.000 - global_seqlen/max:31076.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31076.000 - global_seqlen/balanced_max:31076.000 - global_seqlen/mean:31076.000 - critic/vf_loss:0.026 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.097 - critic/grad_norm:37.393 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.029 - actor/pg_clipfrac:0.134 - actor/ppo_kl:0.080 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.156 - actor/grad_norm:9.087 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.907 - actor/lr:0.000 - critic/score/mean:0.109 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.109 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:1.688 - critic/advantages/max:9.534 - critic/advantages/min:-2.235 - critic/returns/mean:0.109 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.037 - critic/values/max:0.480 - critic/values/min:-0.010 - critic/vf_explained_var:-0.563 - response_length/mean:242.773 - response_length/max:335.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.644 - timing_s/old_log_prob:4.771 - timing_s/ref:7.282 - timing_s/values:4.119 - timing_s/adv:0.022 - timing_s/update_critic:18.784 - timing_s/update_actor:20.849 - timing_s/step:57.475 - timing_per_token_ms/ref:0.234 - timing_per_token_ms/update_actor:0.671 - timing_per_token_ms/values:0.133 - timing_per_token_ms/update_critic:0.604 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:31076.000 - perf/time_per_step:57.475 - perf/throughput:540.687 - timing_s/total:1275.222
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:23 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:38.453 - global_seqlen/min:31034.000 - global_seqlen/max:31034.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31034.000 - global_seqlen/balanced_max:31034.000 - global_seqlen/mean:31034.000 - critic/vf_loss:0.017 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.101 - critic/grad_norm:33.072 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.127 - actor/pg_clipfrac:0.147 - actor/ppo_kl:-0.153 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.190 - actor/grad_norm:16.509 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.910 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.609 - critic/advantages/max:3.669 - critic/advantages/min:-5.827 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.010 - critic/values/max:0.187 - critic/values/min:-0.112 - critic/vf_explained_var:-1.153 - response_length/mean:242.445 - response_length/max:336.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.654 - timing_s/old_log_prob:4.765 - timing_s/ref:7.319 - timing_s/values:4.085 - timing_s/adv:0.022 - timing_s/update_critic:19.177 - timing_s/update_actor:21.047 - timing_s/step:58.072 - timing_per_token_ms/ref:0.236 - timing_per_token_ms/update_actor:0.678 - timing_per_token_ms/values:0.132 - timing_per_token_ms/update_critic:0.618 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:31034.000 - perf/time_per_step:58.072 - perf/throughput:534.408 - timing_s/total:1333.297
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:24 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.383 - global_seqlen/min:30897.000 - global_seqlen/max:30897.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30897.000 - global_seqlen/balanced_max:30897.000 - global_seqlen/mean:30897.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.098 - critic/grad_norm:12.685 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.037 - actor/pg_clipfrac:0.100 - actor/ppo_kl:0.173 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.147 - actor/grad_norm:13.391 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.931 - actor/lr:0.000 - critic/score/mean:0.096 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.096 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.108 - critic/advantages/max:3.781 - critic/advantages/min:-6.700 - critic/returns/mean:0.095 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.021 - critic/values/max:0.373 - critic/values/min:-0.076 - critic/vf_explained_var:-2.862 - response_length/mean:241.375 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.668 - timing_s/old_log_prob:4.847 - timing_s/ref:7.326 - timing_s/values:4.122 - timing_s/adv:0.022 - timing_s/update_critic:18.977 - timing_s/update_actor:20.601 - timing_s/step:57.567 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/update_actor:0.667 - timing_per_token_ms/values:0.133 - timing_per_token_ms/update_critic:0.614 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.054 - perf/total_num_tokens:30897.000 - perf/time_per_step:57.567 - perf/throughput:536.718 - timing_s/total:1390.867
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:25 - train/Bandit/success:0.016 - train/Bandit/num_actions:0.844 - train/Bandit/action_is_effective:0.844 - train/Bandit/action_is_valid:0.844 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.141 - global_seqlen/min:31890.000 - global_seqlen/max:31890.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31890.000 - global_seqlen/balanced_max:31890.000 - global_seqlen/mean:31890.000 - critic/vf_loss:0.009 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.046 - critic/grad_norm:20.926 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.273 - actor/pg_clipfrac:0.155 - actor/ppo_kl:-0.127 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:1.292 - actor/grad_norm:23.476 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.953 - actor/lr:0.000 - critic/score/mean:0.067 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.067 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.993 - critic/advantages/max:2.861 - critic/advantages/min:-3.406 - critic/returns/mean:0.062 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.028 - critic/values/max:0.295 - critic/values/min:-0.049 - critic/vf_explained_var:-0.747 - response_length/mean:249.125 - response_length/max:336.000 - response_length/min:221.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.636 - timing_s/old_log_prob:4.858 - timing_s/ref:7.329 - timing_s/values:4.140 - timing_s/adv:0.009 - timing_s/update_critic:18.825 - timing_s/update_actor:20.950 - timing_s/step:57.751 - timing_per_token_ms/ref:0.230 - timing_per_token_ms/update_actor:0.657 - timing_per_token_ms/values:0.130 - timing_per_token_ms/update_critic:0.590 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:31890.000 - perf/time_per_step:57.751 - perf/throughput:552.201 - timing_s/total:1448.621
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:26 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.633 - global_seqlen/min:30417.000 - global_seqlen/max:30417.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30417.000 - global_seqlen/balanced_max:30417.000 - global_seqlen/mean:30417.000 - critic/vf_loss:0.020 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.176 - critic/grad_norm:36.373 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.191 - actor/ppo_kl:-0.111 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:1.216 - actor/grad_norm:44.622 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.961 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:5.576 - critic/advantages/max:6.552 - critic/advantages/min:-6.232 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.038 - critic/values/max:0.398 - critic/values/min:0.000 - critic/vf_explained_var:-20.769 - response_length/mean:237.625 - response_length/max:264.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.623 - timing_s/old_log_prob:4.735 - timing_s/ref:7.341 - timing_s/values:4.211 - timing_s/adv:0.017 - timing_s/update_critic:19.286 - timing_s/update_actor:20.405 - timing_s/step:57.622 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.671 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.634 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:30417.000 - perf/time_per_step:57.622 - perf/throughput:527.874 - timing_s/total:1506.246
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:27 - train/Bandit/success:0.047 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.664 - global_seqlen/min:30549.000 - global_seqlen/max:30549.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30549.000 - global_seqlen/balanced_max:30549.000 - global_seqlen/mean:30549.000 - critic/vf_loss:0.015 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.183 - critic/grad_norm:23.554 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.159 - actor/ppo_kl:0.150 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.164 - actor/grad_norm:10.299 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:404.978 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:1.000 - critic/score/min:-0.100 - critic/rewards/mean:0.100 - critic/rewards/max:1.000 - critic/rewards/min:-0.100 - critic/advantages/mean:1.402 - critic/advantages/max:12.560 - critic/advantages/min:-3.275 - critic/returns/mean:0.099 - critic/returns/max:1.000 - critic/returns/min:-0.100 - critic/values/mean:0.019 - critic/values/max:0.224 - critic/values/min:-0.044 - critic/vf_explained_var:-0.314 - response_length/mean:238.656 - response_length/max:290.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.832 - timing_s/old_log_prob:4.771 - timing_s/ref:7.312 - timing_s/values:4.140 - timing_s/adv:0.019 - timing_s/update_critic:19.698 - timing_s/update_actor:21.264 - timing_s/step:59.038 - timing_per_token_ms/ref:0.239 - timing_per_token_ms/update_actor:0.696 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.645 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.060 - perf/total_num_tokens:30549.000 - perf/time_per_step:59.038 - perf/throughput:517.448 - timing_s/total:1565.288
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:28 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.023 - global_seqlen/min:30595.000 - global_seqlen/max:30595.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30595.000 - global_seqlen/balanced_max:30595.000 - global_seqlen/mean:30595.000 - critic/vf_loss:0.011 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.086 - critic/grad_norm:25.719 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.074 - actor/pg_clipfrac:0.175 - actor/ppo_kl:-0.168 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:1.110 - actor/grad_norm:33.964 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.001 - actor/lr:0.000 - critic/score/mean:0.091 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.091 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.555 - critic/advantages/max:5.272 - critic/advantages/min:-4.815 - critic/returns/mean:0.090 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.006 - critic/values/max:0.108 - critic/values/min:-0.498 - critic/vf_explained_var:-0.058 - response_length/mean:239.016 - response_length/max:307.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.660 - timing_s/old_log_prob:4.802 - timing_s/ref:7.356 - timing_s/values:4.138 - timing_s/adv:0.009 - timing_s/update_critic:19.425 - timing_s/update_actor:21.203 - timing_s/step:58.597 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.693 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.635 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.054 - perf/total_num_tokens:30595.000 - perf/time_per_step:58.597 - perf/throughput:522.123 - timing_s/total:1623.888
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:29 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.297 - global_seqlen/min:30630.000 - global_seqlen/max:30630.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30630.000 - global_seqlen/balanced_max:30630.000 - global_seqlen/mean:30630.000 - critic/vf_loss:0.038 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.117 - critic/grad_norm:49.770 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.199 - actor/ppo_kl:0.205 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.158 - actor/grad_norm:14.946 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.009 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:7.151 - critic/advantages/max:8.389 - critic/advantages/min:-4.336 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.041 - critic/values/max:0.416 - critic/values/min:0.000 - critic/vf_explained_var:-960.683 - response_length/mean:239.289 - response_length/max:265.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.652 - timing_s/old_log_prob:4.723 - timing_s/ref:7.364 - timing_s/values:4.190 - timing_s/adv:0.018 - timing_s/update_critic:19.575 - timing_s/update_actor:20.162 - timing_s/step:57.687 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.658 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.639 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.054 - perf/total_num_tokens:30630.000 - perf/time_per_step:57.687 - perf/throughput:530.969 - timing_s/total:1681.578
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.9464945793151855 seconds
[36m(TaskRunner pid=850907)[0m step:30 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.969 - train/Bandit/action_is_effective:0.969 - train/Bandit/action_is_valid:0.969 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:36.562 - global_seqlen/min:30792.000 - global_seqlen/max:30792.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30792.000 - global_seqlen/balanced_max:30792.000 - global_seqlen/mean:30792.000 - critic/vf_loss:0.007 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.117 - critic/grad_norm:18.801 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.157 - actor/pg_clipfrac:0.188 - actor/ppo_kl:-0.100 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.187 - actor/grad_norm:8.146 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.048 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.980 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:30.529 - val-core/unknown/reward/mean@512:0.172 - val-aux/unknown/reward/std@512:0.311 - val-aux/unknown/reward/best@2/mean:0.298 - val-aux/unknown/reward/best@2/std:0.390 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.126 - val-aux/unknown/reward/best@4/mean:0.459 - val-aux/unknown/reward/best@4/std:0.442 - val-aux/unknown/reward/worst@4/mean:0.016 - val-aux/unknown/reward/worst@4/std:0.036 - val-aux/unknown/reward/best@8/mean:0.665 - val-aux/unknown/reward/best@8/std:0.435 - val-aux/unknown/reward/worst@8/mean:0.002 - val-aux/unknown/reward/worst@8/std:0.014 - val-aux/unknown/reward/best@16/mean:0.886 - val-aux/unknown/reward/best@16/std:0.300 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.003 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.094 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.094 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.692 - critic/advantages/max:4.489 - critic/advantages/min:-5.586 - critic/returns/mean:0.092 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.029 - critic/values/max:0.271 - critic/values/min:-0.027 - critic/vf_explained_var:-3.234 - response_length/mean:240.555 - response_length/max:336.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.656 - timing_s/old_log_prob:4.833 - timing_s/ref:7.333 - timing_s/values:4.124 - timing_s/adv:0.022 - timing_s/update_critic:19.082 - timing_s/update_actor:20.870 - timing_s/testing:4.258 - timing_s/step:62.182 - timing_per_token_ms/ref:0.238 - timing_per_token_ms/update_actor:0.678 - timing_per_token_ms/values:0.134 - timing_per_token_ms/update_critic:0.620 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.054 - perf/total_num_tokens:30792.000 - perf/time_per_step:62.182 - perf/throughput:495.193 - timing_s/total:1743.761
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:31 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.289 - global_seqlen/min:30373.000 - global_seqlen/max:30373.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30373.000 - global_seqlen/balanced_max:30373.000 - global_seqlen/mean:30373.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.100 - critic/grad_norm:12.456 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.164 - actor/ppo_kl:-0.097 - actor/pg_clipfrac_lower:0.011 - actor/entropy_loss:1.141 - actor/grad_norm:17.195 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.046 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.099 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:1.876 - critic/advantages/max:5.253 - critic/advantages/min:-4.909 - critic/returns/mean:0.099 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.007 - critic/values/max:0.142 - critic/values/min:-0.072 - critic/vf_explained_var:-4.388 - response_length/mean:237.281 - response_length/max:292.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.515 - timing_s/old_log_prob:4.788 - timing_s/ref:7.343 - timing_s/values:4.140 - timing_s/adv:0.009 - timing_s/update_critic:18.997 - timing_s/update_actor:20.130 - timing_s/step:56.926 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.663 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.625 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30373.000 - perf/time_per_step:56.926 - perf/throughput:533.555 - timing_s/total:1800.690
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:32 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.906 - global_seqlen/min:30452.000 - global_seqlen/max:30452.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30452.000 - global_seqlen/balanced_max:30452.000 - global_seqlen/mean:30452.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.104 - critic/grad_norm:16.915 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.080 - actor/pg_clipfrac:0.183 - actor/ppo_kl:0.187 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.083 - actor/grad_norm:26.596 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.084 - actor/lr:0.000 - critic/score/mean:0.095 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.095 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.348 - critic/advantages/max:5.168 - critic/advantages/min:-6.171 - critic/returns/mean:0.095 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.034 - critic/values/max:0.350 - critic/values/min:0.000 - critic/vf_explained_var:-6.897 - response_length/mean:237.898 - response_length/max:305.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.662 - timing_s/old_log_prob:4.767 - timing_s/ref:7.372 - timing_s/values:4.164 - timing_s/adv:0.009 - timing_s/update_critic:19.088 - timing_s/update_actor:20.739 - timing_s/step:57.804 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.681 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.627 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30452.000 - perf/time_per_step:57.804 - perf/throughput:526.817 - timing_s/total:1858.497
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:33 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.539 - global_seqlen/min:30277.000 - global_seqlen/max:30277.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30277.000 - global_seqlen/balanced_max:30277.000 - global_seqlen/mean:30277.000 - critic/vf_loss:0.035 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.160 - critic/grad_norm:47.011 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.168 - actor/ppo_kl:-0.173 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:1.108 - actor/grad_norm:17.266 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.096 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:-1.668 - critic/advantages/max:4.533 - critic/advantages/min:-3.083 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:-0.006 - critic/values/max:0.024 - critic/values/min:-0.135 - critic/vf_explained_var:-24.247 - response_length/mean:236.531 - response_length/max:264.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.679 - timing_s/old_log_prob:4.757 - timing_s/ref:7.380 - timing_s/values:4.132 - timing_s/adv:0.017 - timing_s/update_critic:18.989 - timing_s/update_actor:20.463 - timing_s/step:57.423 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.676 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.627 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30277.000 - perf/time_per_step:57.423 - perf/throughput:527.263 - timing_s/total:1915.923
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:34 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.406 - global_seqlen/min:30644.000 - global_seqlen/max:30644.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30644.000 - global_seqlen/balanced_max:30644.000 - global_seqlen/mean:30644.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.074 - critic/grad_norm:17.203 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.160 - actor/ppo_kl:0.133 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.126 - actor/grad_norm:9.969 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.110 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.479 - critic/advantages/max:4.908 - critic/advantages/min:-7.810 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.007 - critic/values/max:0.108 - critic/values/min:-0.092 - critic/vf_explained_var:-1.105 - response_length/mean:239.398 - response_length/max:293.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:2.078 - timing_s/old_log_prob:4.831 - timing_s/ref:7.359 - timing_s/values:4.110 - timing_s/adv:0.020 - timing_s/update_critic:19.300 - timing_s/update_actor:20.616 - timing_s/step:58.317 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.673 - timing_per_token_ms/values:0.134 - timing_per_token_ms/update_critic:0.630 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.068 - perf/total_num_tokens:30644.000 - perf/time_per_step:58.317 - perf/throughput:525.469 - timing_s/total:1974.243
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:35 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.852 - global_seqlen/min:30445.000 - global_seqlen/max:30445.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30445.000 - global_seqlen/balanced_max:30445.000 - global_seqlen/mean:30445.000 - critic/vf_loss:0.007 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.125 - critic/grad_norm:20.423 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.090 - actor/pg_clipfrac:0.139 - actor/ppo_kl:-0.116 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:1.185 - actor/grad_norm:12.954 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.124 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:7.463 - critic/advantages/max:8.758 - critic/advantages/min:-8.483 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.034 - critic/values/max:0.312 - critic/values/min:0.000 - critic/vf_explained_var:-15.799 - response_length/mean:237.844 - response_length/max:334.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.713 - timing_s/old_log_prob:4.841 - timing_s/ref:7.336 - timing_s/values:4.113 - timing_s/adv:0.022 - timing_s/update_critic:19.149 - timing_s/update_actor:21.190 - timing_s/step:58.368 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.696 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.629 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30445.000 - perf/time_per_step:58.368 - perf/throughput:521.601 - timing_s/total:2032.614
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:36 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.750 - global_seqlen/min:30176.000 - global_seqlen/max:30176.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30176.000 - global_seqlen/balanced_max:30176.000 - global_seqlen/mean:30176.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:16.666 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.156 - actor/ppo_kl:0.236 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.185 - actor/grad_norm:17.825 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.128 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:-5.023 - critic/advantages/max:7.969 - critic/advantages/min:-5.805 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:-0.013 - critic/values/max:-0.000 - critic/values/min:-0.233 - critic/vf_explained_var:-115.638 - response_length/mean:235.734 - response_length/max:255.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.697 - timing_s/old_log_prob:4.697 - timing_s/ref:7.339 - timing_s/values:4.180 - timing_s/adv:0.017 - timing_s/update_critic:19.160 - timing_s/update_actor:20.434 - timing_s/step:57.527 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.677 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.635 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30176.000 - perf/time_per_step:57.527 - perf/throughput:524.550 - timing_s/total:2090.145
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:37 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.852 - global_seqlen/min:30189.000 - global_seqlen/max:30189.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30189.000 - global_seqlen/balanced_max:30189.000 - global_seqlen/mean:30189.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.079 - critic/grad_norm:13.834 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.147 - actor/ppo_kl:-0.086 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.179 - actor/grad_norm:17.141 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.134 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:5.633 - critic/advantages/max:6.513 - critic/advantages/min:-3.972 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.014 - critic/values/max:0.170 - critic/values/min:0.000 - critic/vf_explained_var:-132.698 - response_length/mean:235.844 - response_length/max:255.000 - response_length/min:224.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.974 - timing_s/old_log_prob:4.642 - timing_s/ref:7.344 - timing_s/values:4.127 - timing_s/adv:0.017 - timing_s/update_critic:19.087 - timing_s/update_actor:20.111 - timing_s/step:57.306 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.666 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.632 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.065 - perf/total_num_tokens:30189.000 - perf/time_per_step:57.306 - perf/throughput:526.800 - timing_s/total:2147.455
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:38 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.242 - global_seqlen/min:30367.000 - global_seqlen/max:30367.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30367.000 - global_seqlen/balanced_max:30367.000 - global_seqlen/mean:30367.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.090 - critic/grad_norm:9.960 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.150 - actor/ppo_kl:0.023 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:1.236 - actor/grad_norm:20.213 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.107 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:7.301 - critic/advantages/max:8.490 - critic/advantages/min:-6.081 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.018 - critic/values/max:0.221 - critic/values/min:0.000 - critic/vf_explained_var:-201.479 - response_length/mean:237.234 - response_length/max:259.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.739 - timing_s/old_log_prob:4.736 - timing_s/ref:7.356 - timing_s/values:4.182 - timing_s/adv:0.017 - timing_s/update_critic:19.088 - timing_s/update_actor:20.384 - timing_s/step:57.507 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.671 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.629 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.057 - perf/total_num_tokens:30367.000 - perf/time_per_step:57.507 - perf/throughput:528.060 - timing_s/total:2204.965
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:39 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.703 - global_seqlen/min:30298.000 - global_seqlen/max:30298.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30298.000 - global_seqlen/balanced_max:30298.000 - global_seqlen/mean:30298.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.098 - critic/grad_norm:9.809 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.164 - actor/ppo_kl:0.111 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:1.149 - actor/grad_norm:19.598 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.116 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.790 - critic/advantages/max:5.643 - critic/advantages/min:-8.170 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.021 - critic/values/max:0.245 - critic/values/min:0.000 - critic/vf_explained_var:-6.501 - response_length/mean:236.695 - response_length/max:267.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.670 - timing_s/old_log_prob:4.725 - timing_s/ref:7.343 - timing_s/values:4.166 - timing_s/adv:0.018 - timing_s/update_critic:19.178 - timing_s/update_actor:20.447 - timing_s/step:57.549 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.675 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.633 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30298.000 - perf/time_per_step:57.549 - perf/throughput:526.469 - timing_s/total:2262.517
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.9434926509857178 seconds
[36m(TaskRunner pid=850907)[0m step:40 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.852 - global_seqlen/min:30317.000 - global_seqlen/max:30317.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30317.000 - global_seqlen/balanced_max:30317.000 - global_seqlen/mean:30317.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.093 - critic/grad_norm:10.095 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.062 - actor/pg_clipfrac:0.151 - actor/ppo_kl:0.090 - actor/pg_clipfrac_lower:0.012 - actor/entropy_loss:0.979 - actor/grad_norm:13.962 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.128 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.977 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:33.984 - val-core/unknown/reward/mean@512:0.172 - val-aux/unknown/reward/std@512:0.311 - val-aux/unknown/reward/best@2/mean:0.301 - val-aux/unknown/reward/best@2/std:0.391 - val-aux/unknown/reward/worst@2/mean:0.055 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.460 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.016 - val-aux/unknown/reward/worst@4/std:0.037 - val-aux/unknown/reward/best@8/mean:0.668 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:0.003 - val-aux/unknown/reward/worst@8/std:0.016 - val-aux/unknown/reward/best@16/mean:0.884 - val-aux/unknown/reward/best@16/std:0.302 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.004 - val-aux/unknown/reward/best@32/mean:0.986 - val-aux/unknown/reward/best@32/std:0.113 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:7.985 - critic/advantages/max:9.271 - critic/advantages/min:-4.182 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.021 - critic/values/max:0.215 - critic/values/min:0.000 - critic/vf_explained_var:-264.421 - response_length/mean:236.844 - response_length/max:268.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.670 - timing_s/old_log_prob:4.716 - timing_s/ref:7.311 - timing_s/values:4.153 - timing_s/adv:0.018 - timing_s/update_critic:19.130 - timing_s/update_actor:20.307 - timing_s/testing:4.253 - timing_s/step:61.561 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.670 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.631 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30317.000 - perf/time_per_step:61.561 - perf/throughput:492.468 - timing_s/total:2324.081
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:41 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.164 - global_seqlen/min:30485.000 - global_seqlen/max:30485.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30485.000 - global_seqlen/balanced_max:30485.000 - global_seqlen/mean:30485.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.083 - critic/grad_norm:10.862 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.097 - actor/pg_clipfrac:0.185 - actor/ppo_kl:-0.104 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.928 - actor/grad_norm:27.209 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.141 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.929 - critic/advantages/max:4.662 - critic/advantages/min:-8.451 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.020 - critic/values/max:0.273 - critic/values/min:-0.008 - critic/vf_explained_var:-4.611 - response_length/mean:238.156 - response_length/max:337.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.570 - timing_s/old_log_prob:4.994 - timing_s/ref:7.354 - timing_s/values:4.141 - timing_s/adv:0.022 - timing_s/update_critic:19.177 - timing_s/update_actor:20.694 - timing_s/step:57.955 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.679 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.629 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30485.000 - perf/time_per_step:57.955 - perf/throughput:526.013 - timing_s/total:2382.038
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:42 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.438 - global_seqlen/min:30264.000 - global_seqlen/max:30264.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30264.000 - global_seqlen/balanced_max:30264.000 - global_seqlen/mean:30264.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.082 - critic/grad_norm:10.218 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.164 - actor/ppo_kl:0.089 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.836 - actor/grad_norm:33.400 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.161 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:8.464 - critic/advantages/max:9.810 - critic/advantages/min:-7.210 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.019 - critic/values/max:0.239 - critic/values/min:0.000 - critic/vf_explained_var:-226.848 - response_length/mean:236.430 - response_length/max:253.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.709 - timing_s/old_log_prob:4.669 - timing_s/ref:7.334 - timing_s/values:4.133 - timing_s/adv:0.017 - timing_s/update_critic:19.060 - timing_s/update_actor:20.486 - timing_s/step:57.411 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.677 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.630 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30264.000 - perf/time_per_step:57.411 - perf/throughput:527.142 - timing_s/total:2439.453
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:43 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.008 - global_seqlen/min:30337.000 - global_seqlen/max:30337.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30337.000 - global_seqlen/balanced_max:30337.000 - global_seqlen/mean:30337.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.076 - critic/grad_norm:10.160 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.043 - actor/pg_clipfrac:0.142 - actor/ppo_kl:0.206 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.866 - actor/grad_norm:37.258 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.177 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:8.769 - critic/advantages/max:10.187 - critic/advantages/min:-3.647 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.018 - critic/values/max:0.178 - critic/values/min:0.000 - critic/vf_explained_var:-206.662 - response_length/mean:237.000 - response_length/max:260.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.670 - timing_s/old_log_prob:4.625 - timing_s/ref:7.291 - timing_s/values:4.066 - timing_s/adv:0.017 - timing_s/update_critic:19.144 - timing_s/update_actor:20.459 - timing_s/step:57.276 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.674 - timing_per_token_ms/values:0.134 - timing_per_token_ms/update_critic:0.631 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30337.000 - perf/time_per_step:57.276 - perf/throughput:529.660 - timing_s/total:2496.733
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:44 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.016 - global_seqlen/min:30210.000 - global_seqlen/max:30210.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30210.000 - global_seqlen/balanced_max:30210.000 - global_seqlen/mean:30210.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.074 - critic/grad_norm:10.141 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.030 - actor/pg_clipfrac:0.139 - actor/ppo_kl:0.113 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.814 - actor/grad_norm:15.649 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.187 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:8.092 - critic/advantages/max:9.363 - critic/advantages/min:-4.035 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.017 - critic/values/max:0.184 - critic/values/min:0.000 - critic/vf_explained_var:-194.549 - response_length/mean:236.008 - response_length/max:260.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.714 - timing_s/old_log_prob:4.740 - timing_s/ref:7.364 - timing_s/values:4.165 - timing_s/adv:0.017 - timing_s/update_critic:19.043 - timing_s/update_actor:20.588 - timing_s/step:57.635 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.681 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.630 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.057 - perf/total_num_tokens:30210.000 - perf/time_per_step:57.635 - perf/throughput:524.161 - timing_s/total:2554.371
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:45 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.398 - global_seqlen/min:30131.000 - global_seqlen/max:30131.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30131.000 - global_seqlen/balanced_max:30131.000 - global_seqlen/mean:30131.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.067 - critic/grad_norm:9.974 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.170 - actor/ppo_kl:0.157 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.800 - actor/grad_norm:14.772 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.196 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.099 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:7.060 - critic/advantages/max:8.198 - critic/advantages/min:-8.177 - critic/returns/mean:0.099 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.016 - critic/values/max:0.171 - critic/values/min:0.000 - critic/vf_explained_var:-19.765 - response_length/mean:235.391 - response_length/max:253.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.908 - timing_s/old_log_prob:4.710 - timing_s/ref:7.357 - timing_s/values:4.171 - timing_s/adv:0.017 - timing_s/update_critic:19.198 - timing_s/update_actor:20.075 - timing_s/step:57.438 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.666 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.637 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.063 - perf/total_num_tokens:30131.000 - perf/time_per_step:57.438 - perf/throughput:524.582 - timing_s/total:2611.813
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:46 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.078 - global_seqlen/min:30090.000 - global_seqlen/max:30090.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30090.000 - global_seqlen/balanced_max:30090.000 - global_seqlen/mean:30090.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.065 - critic/grad_norm:10.001 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.047 - actor/pg_clipfrac:0.164 - actor/ppo_kl:-0.079 - actor/pg_clipfrac_lower:0.021 - actor/entropy_loss:0.850 - actor/grad_norm:16.678 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.198 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.099 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:6.387 - critic/advantages/max:7.408 - critic/advantages/min:-7.776 - critic/returns/mean:0.099 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.016 - critic/values/max:0.163 - critic/values/min:0.000 - critic/vf_explained_var:-19.186 - response_length/mean:235.070 - response_length/max:254.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.914 - timing_s/old_log_prob:4.650 - timing_s/ref:7.308 - timing_s/values:4.095 - timing_s/adv:0.007 - timing_s/update_critic:19.194 - timing_s/update_actor:20.073 - timing_s/step:57.245 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.667 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.638 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.064 - perf/total_num_tokens:30090.000 - perf/time_per_step:57.245 - perf/throughput:525.638 - timing_s/total:2669.061
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:47 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.578 - global_seqlen/min:30282.000 - global_seqlen/max:30282.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30282.000 - global_seqlen/balanced_max:30282.000 - global_seqlen/mean:30282.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.065 - critic/grad_norm:9.195 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.158 - actor/ppo_kl:0.103 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:0.783 - actor/grad_norm:30.287 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.170 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:8.096 - critic/advantages/max:9.389 - critic/advantages/min:-3.495 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.016 - critic/values/max:0.158 - critic/values/min:0.000 - critic/vf_explained_var:-158.914 - response_length/mean:236.570 - response_length/max:252.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.683 - timing_s/old_log_prob:4.708 - timing_s/ref:7.338 - timing_s/values:4.052 - timing_s/adv:0.007 - timing_s/update_critic:19.136 - timing_s/update_actor:20.785 - timing_s/step:57.713 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.686 - timing_per_token_ms/values:0.134 - timing_per_token_ms/update_critic:0.632 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30282.000 - perf/time_per_step:57.713 - perf/throughput:524.700 - timing_s/total:2726.777
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:48 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.164 - global_seqlen/min:30101.000 - global_seqlen/max:30101.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30101.000 - global_seqlen/balanced_max:30101.000 - global_seqlen/mean:30101.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.116 - critic/grad_norm:10.213 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.144 - actor/ppo_kl:-0.056 - actor/pg_clipfrac_lower:0.015 - actor/entropy_loss:0.794 - actor/grad_norm:15.426 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.196 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.099 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:8.572 - critic/advantages/max:9.932 - critic/advantages/min:-7.580 - critic/returns/mean:0.099 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.020 - critic/values/max:0.197 - critic/values/min:0.000 - critic/vf_explained_var:-30.619 - response_length/mean:235.156 - response_length/max:254.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.676 - timing_s/old_log_prob:4.688 - timing_s/ref:7.276 - timing_s/values:4.062 - timing_s/adv:0.017 - timing_s/update_critic:19.753 - timing_s/update_actor:20.112 - timing_s/step:57.588 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.668 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.656 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30101.000 - perf/time_per_step:57.588 - perf/throughput:522.693 - timing_s/total:2784.369
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:49 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.125 - global_seqlen/min:30096.000 - global_seqlen/max:30096.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30096.000 - global_seqlen/balanced_max:30096.000 - global_seqlen/mean:30096.000 - critic/vf_loss:0.013 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.067 - critic/grad_norm:25.513 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.171 - actor/ppo_kl:-0.033 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.672 - actor/grad_norm:8.297 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.115 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.849 - critic/advantages/max:4.506 - critic/advantages/min:-9.709 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.164 - critic/values/min:0.000 - critic/vf_explained_var:-3.549 - response_length/mean:235.117 - response_length/max:247.000 - response_length/min:225.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.961 - timing_s/old_log_prob:4.750 - timing_s/ref:7.372 - timing_s/values:4.179 - timing_s/adv:0.007 - timing_s/update_critic:19.103 - timing_s/update_actor:20.094 - timing_s/step:57.470 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.668 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.635 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.065 - perf/total_num_tokens:30096.000 - perf/time_per_step:57.470 - perf/throughput:523.686 - timing_s/total:2841.842
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.9264957904815674 seconds
[36m(TaskRunner pid=850907)[0m step:50 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.758 - global_seqlen/min:30177.000 - global_seqlen/max:30177.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30177.000 - global_seqlen/balanced_max:30177.000 - global_seqlen/mean:30177.000 - critic/vf_loss:0.017 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.165 - critic/grad_norm:30.192 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.147 - actor/ppo_kl:-0.016 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:0.608 - actor/grad_norm:20.797 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.096 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.996 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:30.051 - val-core/unknown/reward/mean@512:0.173 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.302 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.016 - val-aux/unknown/reward/worst@4/std:0.036 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:0.002 - val-aux/unknown/reward/worst@8/std:0.015 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.003 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:29.223 - critic/advantages/max:33.772 - critic/advantages/min:-4.059 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.061 - critic/values/max:0.504 - critic/values/min:0.000 - critic/vf_explained_var:-2360.215 - response_length/mean:235.750 - response_length/max:249.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.926 - timing_s/old_log_prob:4.654 - timing_s/ref:7.357 - timing_s/values:4.109 - timing_s/adv:0.018 - timing_s/update_critic:19.449 - timing_s/update_actor:20.903 - timing_s/testing:4.248 - timing_s/step:62.675 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.693 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.644 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.064 - perf/total_num_tokens:30177.000 - perf/time_per_step:62.675 - perf/throughput:481.481 - timing_s/total:2904.520
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:51 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.609 - global_seqlen/min:30030.000 - global_seqlen/max:30030.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30030.000 - global_seqlen/balanced_max:30030.000 - global_seqlen/mean:30030.000 - critic/vf_loss:0.025 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.088 - critic/grad_norm:38.569 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.163 - actor/ppo_kl:0.127 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.619 - actor/grad_norm:24.765 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.123 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:16.899 - critic/advantages/max:19.435 - critic/advantages/min:-3.094 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.031 - critic/values/max:0.279 - critic/values/min:0.000 - critic/vf_explained_var:-659.653 - response_length/mean:234.602 - response_length/max:251.000 - response_length/min:224.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.509 - timing_s/old_log_prob:4.676 - timing_s/ref:7.346 - timing_s/values:4.136 - timing_s/adv:0.017 - timing_s/update_critic:19.553 - timing_s/update_actor:20.858 - timing_s/step:58.098 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.695 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.651 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30030.000 - perf/time_per_step:58.098 - perf/throughput:516.884 - timing_s/total:2962.621
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:52 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.609 - global_seqlen/min:29774.000 - global_seqlen/max:29774.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29774.000 - global_seqlen/balanced_max:29774.000 - global_seqlen/mean:29774.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.118 - critic/grad_norm:11.598 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.183 - actor/ppo_kl:0.110 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.542 - actor/grad_norm:15.831 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.155 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:9.635 - critic/advantages/max:10.987 - critic/advantages/min:-3.722 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.017 - critic/values/max:0.182 - critic/values/min:0.000 - critic/vf_explained_var:-199.454 - response_length/mean:232.602 - response_length/max:255.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.698 - timing_s/old_log_prob:4.685 - timing_s/ref:7.330 - timing_s/values:4.145 - timing_s/adv:0.017 - timing_s/update_critic:19.545 - timing_s/update_actor:20.246 - timing_s/step:57.668 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.680 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.656 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.057 - perf/total_num_tokens:29774.000 - perf/time_per_step:57.668 - perf/throughput:516.298 - timing_s/total:3020.292
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:53 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.641 - global_seqlen/min:29778.000 - global_seqlen/max:29778.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29778.000 - global_seqlen/balanced_max:29778.000 - global_seqlen/mean:29778.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.097 - critic/grad_norm:12.213 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.112 - actor/pg_clipfrac:0.198 - actor/ppo_kl:0.007 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.439 - actor/grad_norm:4.513 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.164 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.216 - critic/advantages/max:3.723 - critic/advantages/min:-7.552 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.012 - critic/values/max:0.144 - critic/values/min:-0.001 - critic/vf_explained_var:-2.708 - response_length/mean:232.633 - response_length/max:305.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.704 - timing_s/old_log_prob:4.795 - timing_s/ref:7.310 - timing_s/values:4.073 - timing_s/adv:0.020 - timing_s/update_critic:18.836 - timing_s/update_actor:20.349 - timing_s/step:57.089 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.683 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.633 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.057 - perf/total_num_tokens:29778.000 - perf/time_per_step:57.089 - perf/throughput:521.603 - timing_s/total:3077.385
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:54 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.711 - global_seqlen/min:29659.000 - global_seqlen/max:29659.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29659.000 - global_seqlen/balanced_max:29659.000 - global_seqlen/mean:29659.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.111 - critic/grad_norm:12.830 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.205 - actor/ppo_kl:0.016 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.445 - actor/grad_norm:7.828 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.188 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:16.981 - critic/advantages/max:19.288 - critic/advantages/min:-8.319 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.031 - critic/values/max:0.373 - critic/values/min:0.000 - critic/vf_explained_var:-716.494 - response_length/mean:231.695 - response_length/max:243.000 - response_length/min:225.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.720 - timing_s/old_log_prob:4.686 - timing_s/ref:7.337 - timing_s/values:4.134 - timing_s/adv:0.016 - timing_s/update_critic:19.327 - timing_s/update_actor:20.619 - timing_s/step:57.844 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.695 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.652 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - perf/total_num_tokens:29659.000 - perf/time_per_step:57.844 - perf/throughput:512.738 - timing_s/total:3135.233
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:55 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.398 - global_seqlen/min:29619.000 - global_seqlen/max:29619.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29619.000 - global_seqlen/balanced_max:29619.000 - global_seqlen/mean:29619.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.102 - critic/grad_norm:14.076 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.171 - actor/ppo_kl:0.020 - actor/pg_clipfrac_lower:0.019 - actor/entropy_loss:0.472 - actor/grad_norm:47.090 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.176 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.429 - critic/advantages/max:3.890 - critic/advantages/min:-4.655 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.005 - critic/values/max:0.097 - critic/values/min:0.000 - critic/vf_explained_var:-20.733 - response_length/mean:231.391 - response_length/max:257.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.952 - timing_s/old_log_prob:4.666 - timing_s/ref:7.327 - timing_s/values:4.138 - timing_s/adv:0.017 - timing_s/update_critic:19.542 - timing_s/update_actor:20.673 - timing_s/step:58.320 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.698 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.660 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.066 - perf/total_num_tokens:29619.000 - perf/time_per_step:58.320 - perf/throughput:507.873 - timing_s/total:3193.556
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:56 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.383 - global_seqlen/min:30001.000 - global_seqlen/max:30001.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30001.000 - global_seqlen/balanced_max:30001.000 - global_seqlen/mean:30001.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.115 - critic/grad_norm:14.320 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.102 - actor/pg_clipfrac:0.177 - actor/ppo_kl:-0.046 - actor/pg_clipfrac_lower:0.007 - actor/entropy_loss:0.453 - actor/grad_norm:6.741 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.203 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.749 - critic/advantages/max:5.510 - critic/advantages/min:-7.870 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.020 - critic/values/max:0.192 - critic/values/min:-0.005 - critic/vf_explained_var:-6.025 - response_length/mean:234.375 - response_length/max:339.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.970 - timing_s/old_log_prob:4.858 - timing_s/ref:7.380 - timing_s/values:4.166 - timing_s/adv:0.010 - timing_s/update_critic:19.510 - timing_s/update_actor:21.305 - timing_s/step:59.203 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.710 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.650 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.066 - perf/total_num_tokens:30001.000 - perf/time_per_step:59.203 - perf/throughput:506.747 - timing_s/total:3252.762
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:57 - train/Bandit/success:0.016 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.438 - global_seqlen/min:29880.000 - global_seqlen/max:29880.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29880.000 - global_seqlen/balanced_max:29880.000 - global_seqlen/mean:29880.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.156 - critic/grad_norm:16.413 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.181 - actor/ppo_kl:0.061 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.510 - actor/grad_norm:16.856 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.152 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:11.209 - critic/advantages/max:12.918 - critic/advantages/min:-7.119 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.028 - critic/values/max:0.258 - critic/values/min:0.000 - critic/vf_explained_var:-32.395 - response_length/mean:233.422 - response_length/max:247.000 - response_length/min:225.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.709 - timing_s/old_log_prob:4.682 - timing_s/ref:7.371 - timing_s/values:4.126 - timing_s/adv:0.017 - timing_s/update_critic:19.618 - timing_s/update_actor:20.846 - timing_s/step:58.372 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.698 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.657 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.057 - perf/total_num_tokens:29880.000 - perf/time_per_step:58.372 - perf/throughput:511.889 - timing_s/total:3311.136
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:58 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.273 - global_seqlen/min:29859.000 - global_seqlen/max:29859.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29859.000 - global_seqlen/balanced_max:29859.000 - global_seqlen/mean:29859.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.095 - critic/grad_norm:10.321 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.118 - actor/pg_clipfrac:0.168 - actor/ppo_kl:-0.116 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.513 - actor/grad_norm:65.897 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.223 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.228 - critic/advantages/max:1.745 - critic/advantages/min:-7.731 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.004 - critic/values/max:0.072 - critic/values/min:-0.125 - critic/vf_explained_var:-0.223 - response_length/mean:233.266 - response_length/max:327.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.705 - timing_s/old_log_prob:4.833 - timing_s/ref:7.327 - timing_s/values:4.119 - timing_s/adv:0.022 - timing_s/update_critic:19.701 - timing_s/update_actor:21.328 - timing_s/step:59.037 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.714 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.660 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.057 - perf/total_num_tokens:29859.000 - perf/time_per_step:59.037 - perf/throughput:505.768 - timing_s/total:3370.176
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:59 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.812 - global_seqlen/min:29800.000 - global_seqlen/max:29800.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29800.000 - global_seqlen/balanced_max:29800.000 - global_seqlen/mean:29800.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.082 - critic/grad_norm:7.991 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.212 - actor/ppo_kl:0.308 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.510 - actor/grad_norm:11.978 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.231 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:5.450 - critic/advantages/max:6.220 - critic/advantages/min:-3.430 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.010 - critic/values/max:0.122 - critic/values/min:-0.000 - critic/vf_explained_var:-67.556 - response_length/mean:232.805 - response_length/max:253.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.966 - timing_s/old_log_prob:4.773 - timing_s/ref:7.378 - timing_s/values:4.180 - timing_s/adv:0.017 - timing_s/update_critic:19.623 - timing_s/update_actor:21.006 - timing_s/step:58.946 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/update_actor:0.705 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.658 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.066 - perf/total_num_tokens:29800.000 - perf/time_per_step:58.946 - perf/throughput:505.551 - timing_s/total:3429.125
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.9768829345703125 seconds
[36m(TaskRunner pid=850907)[0m step:60 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.445 - global_seqlen/min:30009.000 - global_seqlen/max:30009.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30009.000 - global_seqlen/balanced_max:30009.000 - global_seqlen/mean:30009.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.096 - critic/grad_norm:7.767 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.170 - actor/pg_clipfrac:0.179 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:0.506 - actor/grad_norm:7.831 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.242 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:1.000 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:28.529 - val-core/unknown/reward/mean@512:0.173 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.302 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.015 - val-aux/unknown/reward/worst@4/std:0.036 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:0.002 - val-aux/unknown/reward/worst@8/std:0.014 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.003 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.096 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.096 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.343 - critic/advantages/max:1.732 - critic/advantages/min:-6.209 - critic/returns/mean:0.095 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.006 - critic/values/max:0.084 - critic/values/min:-0.158 - critic/vf_explained_var:-0.136 - response_length/mean:234.438 - response_length/max:336.000 - response_length/min:225.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.666 - timing_s/old_log_prob:4.807 - timing_s/ref:7.336 - timing_s/values:4.295 - timing_s/adv:0.022 - timing_s/update_critic:19.513 - timing_s/update_actor:21.324 - timing_s/testing:4.280 - timing_s/step:63.246 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.711 - timing_per_token_ms/values:0.143 - timing_per_token_ms/update_critic:0.650 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30009.000 - perf/time_per_step:63.246 - perf/throughput:474.479 - timing_s/total:3492.374
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:61 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.641 - global_seqlen/min:29906.000 - global_seqlen/max:29906.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29906.000 - global_seqlen/balanced_max:29906.000 - global_seqlen/mean:29906.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.098 - critic/grad_norm:8.166 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.153 - actor/ppo_kl:-0.037 - actor/pg_clipfrac_lower:0.018 - actor/entropy_loss:0.536 - actor/grad_norm:21.396 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.251 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:4.597 - critic/advantages/max:5.265 - critic/advantages/min:-3.587 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.008 - critic/values/max:0.103 - critic/values/min:0.000 - critic/vf_explained_var:-42.317 - response_length/mean:233.633 - response_length/max:258.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.582 - timing_s/old_log_prob:4.720 - timing_s/ref:7.331 - timing_s/values:4.091 - timing_s/adv:0.017 - timing_s/update_critic:19.614 - timing_s/update_actor:20.799 - timing_s/step:58.158 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.695 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.656 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:29906.000 - perf/time_per_step:58.158 - perf/throughput:514.217 - timing_s/total:3550.535
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:62 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.625 - global_seqlen/min:30032.000 - global_seqlen/max:30032.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30032.000 - global_seqlen/balanced_max:30032.000 - global_seqlen/mean:30032.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.093 - critic/grad_norm:8.324 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.179 - actor/pg_clipfrac:0.143 - actor/ppo_kl:-0.171 - actor/pg_clipfrac_lower:0.016 - actor/entropy_loss:0.490 - actor/grad_norm:2.500 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.270 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.509 - critic/advantages/max:1.881 - critic/advantages/min:-6.392 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.006 - critic/values/max:0.130 - critic/values/min:-0.142 - critic/vf_explained_var:-0.215 - response_length/mean:234.617 - response_length/max:337.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.678 - timing_s/old_log_prob:4.873 - timing_s/ref:7.359 - timing_s/values:4.150 - timing_s/adv:0.022 - timing_s/update_critic:19.795 - timing_s/update_actor:21.377 - timing_s/step:59.257 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.712 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.659 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - perf/total_num_tokens:30032.000 - perf/time_per_step:59.257 - perf/throughput:506.813 - timing_s/total:3609.795
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:63 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.680 - global_seqlen/min:29783.000 - global_seqlen/max:29783.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29783.000 - global_seqlen/balanced_max:29783.000 - global_seqlen/mean:29783.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.091 - critic/grad_norm:8.350 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.125 - actor/ppo_kl:-0.251 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.340 - actor/grad_norm:9.998 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.270 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:4.260 - critic/advantages/max:7.326 - critic/advantages/min:-2.377 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.006 - critic/values/max:0.075 - critic/values/min:-0.026 - critic/vf_explained_var:-27.886 - response_length/mean:232.672 - response_length/max:255.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.581 - timing_s/old_log_prob:4.696 - timing_s/ref:7.366 - timing_s/values:4.097 - timing_s/adv:0.017 - timing_s/update_critic:19.228 - timing_s/update_actor:20.538 - timing_s/step:57.527 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.690 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.646 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:29783.000 - perf/time_per_step:57.527 - perf/throughput:517.720 - timing_s/total:3667.326
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:64 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.297 - train/Bandit/action_is_effective:0.297 - train/Bandit/action_is_valid:0.297 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:40.836 - global_seqlen/min:31339.000 - global_seqlen/max:31339.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31339.000 - global_seqlen/balanced_max:31339.000 - global_seqlen/mean:31339.000 - critic/vf_loss:0.013 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.064 - critic/grad_norm:22.642 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.090 - actor/pg_clipfrac:0.129 - actor/ppo_kl:0.152 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.429 - actor/grad_norm:25.334 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.272 - actor/lr:0.000 - critic/score/mean:-0.041 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.041 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.232 - critic/advantages/max:2.313 - critic/advantages/min:-1.367 - critic/returns/mean:-0.043 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.002 - critic/values/max:0.087 - critic/values/min:-0.232 - critic/vf_explained_var:-0.008 - response_length/mean:244.805 - response_length/max:335.000 - response_length/min:225.000 - response_length/clip_ratio:0.055 - prompt_length/mean:0.031 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.031 - timing_s/gen:1.472 - timing_s/old_log_prob:4.821 - timing_s/ref:7.274 - timing_s/values:4.112 - timing_s/adv:0.022 - timing_s/update_critic:19.161 - timing_s/update_actor:20.786 - timing_s/step:57.652 - timing_per_token_ms/ref:0.232 - timing_per_token_ms/update_actor:0.663 - timing_per_token_ms/values:0.131 - timing_per_token_ms/update_critic:0.611 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:31339.000 - perf/time_per_step:57.652 - perf/throughput:543.586 - timing_s/total:3724.982
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:65 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.477 - train/Bandit/action_is_effective:0.477 - train/Bandit/action_is_valid:0.477 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:42.156 - global_seqlen/min:31508.000 - global_seqlen/max:31508.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31508.000 - global_seqlen/balanced_max:31508.000 - global_seqlen/mean:31508.000 - critic/vf_loss:0.013 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.046 - critic/grad_norm:21.098 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.050 - actor/pg_clipfrac:0.155 - actor/ppo_kl:0.135 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.605 - actor/grad_norm:63.101 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.282 - actor/lr:0.000 - critic/score/mean:-0.005 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.005 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.852 - critic/advantages/max:1.987 - critic/advantages/min:-2.149 - critic/returns/mean:-0.008 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.018 - critic/values/max:-0.000 - critic/values/min:-0.352 - critic/vf_explained_var:-0.064 - response_length/mean:246.141 - response_length/max:336.000 - response_length/min:222.000 - response_length/clip_ratio:0.039 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.421 - timing_s/old_log_prob:4.862 - timing_s/ref:7.341 - timing_s/values:4.138 - timing_s/adv:0.022 - timing_s/update_critic:18.878 - timing_s/update_actor:21.114 - timing_s/step:57.779 - timing_per_token_ms/ref:0.233 - timing_per_token_ms/update_actor:0.670 - timing_per_token_ms/values:0.131 - timing_per_token_ms/update_critic:0.599 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:31508.000 - perf/time_per_step:57.779 - perf/throughput:545.324 - timing_s/total:3782.764
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:66 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.031 - global_seqlen/min:30340.000 - global_seqlen/max:30340.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30340.000 - global_seqlen/balanced_max:30340.000 - global_seqlen/mean:30340.000 - critic/vf_loss:0.022 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.111 - critic/grad_norm:33.778 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.150 - actor/ppo_kl:-0.209 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.559 - actor/grad_norm:7.250 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.279 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:5.546 - critic/advantages/max:6.532 - critic/advantages/min:-5.625 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.032 - critic/values/max:0.314 - critic/values/min:0.000 - critic/vf_explained_var:-10.347 - response_length/mean:237.023 - response_length/max:250.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.438 - timing_s/old_log_prob:4.691 - timing_s/ref:7.365 - timing_s/values:4.136 - timing_s/adv:0.012 - timing_s/update_critic:19.543 - timing_s/update_actor:20.873 - timing_s/step:58.061 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.688 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.644 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:30340.000 - perf/time_per_step:58.061 - perf/throughput:522.552 - timing_s/total:3840.828
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:67 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.758 - global_seqlen/min:30433.000 - global_seqlen/max:30433.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30433.000 - global_seqlen/balanced_max:30433.000 - global_seqlen/mean:30433.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.128 - critic/grad_norm:12.264 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.063 - actor/pg_clipfrac:0.123 - actor/ppo_kl:-0.056 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.668 - actor/grad_norm:6.649 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.295 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:5.244 - critic/advantages/max:6.169 - critic/advantages/min:-8.961 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.023 - critic/values/max:0.221 - critic/values/min:-0.025 - critic/vf_explained_var:-8.456 - response_length/mean:237.750 - response_length/max:291.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.449 - timing_s/old_log_prob:4.756 - timing_s/ref:7.557 - timing_s/values:4.117 - timing_s/adv:0.020 - timing_s/update_critic:19.307 - timing_s/update_actor:21.235 - timing_s/step:58.445 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/update_actor:0.698 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.634 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.048 - perf/total_num_tokens:30433.000 - perf/time_per_step:58.445 - perf/throughput:520.710 - timing_s/total:3899.277
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:68 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.375 - global_seqlen/min:30384.000 - global_seqlen/max:30384.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30384.000 - global_seqlen/balanced_max:30384.000 - global_seqlen/mean:30384.000 - critic/vf_loss:0.020 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.107 - critic/grad_norm:32.398 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.075 - actor/pg_clipfrac:0.146 - actor/ppo_kl:-0.106 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:0.528 - actor/grad_norm:5.166 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.293 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.170 - critic/advantages/max:2.058 - critic/advantages/min:-9.116 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.011 - critic/values/max:-0.000 - critic/values/min:-0.312 - critic/vf_explained_var:-0.784 - response_length/mean:237.367 - response_length/max:333.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.426 - timing_s/old_log_prob:4.846 - timing_s/ref:7.339 - timing_s/values:4.102 - timing_s/adv:0.022 - timing_s/update_critic:19.050 - timing_s/update_actor:20.816 - timing_s/step:57.605 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.685 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.627 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:30384.000 - perf/time_per_step:57.605 - perf/throughput:527.455 - timing_s/total:3956.885
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:69 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.141 - global_seqlen/min:30482.000 - global_seqlen/max:30482.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30482.000 - global_seqlen/balanced_max:30482.000 - global_seqlen/mean:30482.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.083 - critic/grad_norm:15.643 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.092 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.609 - actor/grad_norm:4.172 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.301 - actor/lr:0.000 - critic/score/mean:0.092 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.092 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.779 - critic/advantages/max:4.607 - critic/advantages/min:-5.389 - critic/returns/mean:0.092 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.025 - critic/values/max:0.214 - critic/values/min:0.000 - critic/vf_explained_var:-2.531 - response_length/mean:238.133 - response_length/max:270.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:0.973 - timing_s/old_log_prob:4.991 - timing_s/ref:7.446 - timing_s/values:4.201 - timing_s/adv:0.009 - timing_s/update_critic:18.598 - timing_s/update_actor:20.811 - timing_s/step:57.031 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.683 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.610 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.032 - perf/total_num_tokens:30482.000 - perf/time_per_step:57.031 - perf/throughput:534.478 - timing_s/total:4013.920
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 2.6799190044403076 seconds
[36m(TaskRunner pid=850907)[0m step:70 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.539 - global_seqlen/min:30405.000 - global_seqlen/max:30405.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30405.000 - global_seqlen/balanced_max:30405.000 - global_seqlen/mean:30405.000 - critic/vf_loss:0.015 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.124 - critic/grad_norm:26.610 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.115 - actor/ppo_kl:0.129 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.587 - actor/grad_norm:13.351 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.306 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.973 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:32.154 - val-core/unknown/reward/mean@512:0.171 - val-aux/unknown/reward/std@512:0.309 - val-aux/unknown/reward/best@2/mean:0.296 - val-aux/unknown/reward/best@2/std:0.388 - val-aux/unknown/reward/worst@2/mean:0.053 - val-aux/unknown/reward/worst@2/std:0.119 - val-aux/unknown/reward/best@4/mean:0.455 - val-aux/unknown/reward/best@4/std:0.441 - val-aux/unknown/reward/worst@4/mean:0.016 - val-aux/unknown/reward/worst@4/std:0.037 - val-aux/unknown/reward/best@8/mean:0.658 - val-aux/unknown/reward/best@8/std:0.437 - val-aux/unknown/reward/worst@8/mean:0.002 - val-aux/unknown/reward/worst@8/std:0.015 - val-aux/unknown/reward/best@16/mean:0.878 - val-aux/unknown/reward/best@16/std:0.309 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.003 - val-aux/unknown/reward/best@32/mean:0.983 - val-aux/unknown/reward/best@32/std:0.123 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:-11.424 - critic/advantages/max:5.766 - critic/advantages/min:-13.303 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:-0.022 - critic/values/max:-0.000 - critic/values/min:-0.225 - critic/vf_explained_var:-298.682 - response_length/mean:237.531 - response_length/max:262.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:0.955 - timing_s/old_log_prob:4.711 - timing_s/ref:7.318 - timing_s/values:4.098 - timing_s/adv:0.018 - timing_s/update_critic:19.187 - timing_s/update_actor:20.353 - timing_s/testing:3.039 - timing_s/step:59.682 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.669 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.631 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.031 - perf/total_num_tokens:30405.000 - perf/time_per_step:59.682 - perf/throughput:509.452 - timing_s/total:4073.605
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:71 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.031 - global_seqlen/min:30212.000 - global_seqlen/max:30212.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30212.000 - global_seqlen/balanced_max:30212.000 - global_seqlen/mean:30212.000 - critic/vf_loss:0.016 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.130 - critic/grad_norm:27.966 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.137 - actor/ppo_kl:-0.081 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.671 - actor/grad_norm:10.151 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.308 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.064 - critic/advantages/max:4.257 - critic/advantages/min:-8.666 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.004 - critic/values/max:0.070 - critic/values/min:-0.076 - critic/vf_explained_var:-0.195 - response_length/mean:236.023 - response_length/max:254.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.383 - timing_s/old_log_prob:4.708 - timing_s/ref:7.352 - timing_s/values:4.071 - timing_s/adv:0.017 - timing_s/update_critic:19.015 - timing_s/update_actor:20.219 - timing_s/step:56.768 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.669 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.629 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:30212.000 - perf/time_per_step:56.768 - perf/throughput:532.198 - timing_s/total:4130.376
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:72 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.094 - global_seqlen/min:29964.000 - global_seqlen/max:29964.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29964.000 - global_seqlen/balanced_max:29964.000 - global_seqlen/mean:29964.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.082 - critic/grad_norm:13.443 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.005 - actor/pg_clipfrac:0.142 - actor/ppo_kl:0.147 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.698 - actor/grad_norm:8.836 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.327 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.137 - critic/advantages/max:3.907 - critic/advantages/min:-10.033 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.003 - critic/values/max:0.065 - critic/values/min:-0.053 - critic/vf_explained_var:-0.258 - response_length/mean:234.086 - response_length/max:257.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.540 - timing_s/old_log_prob:4.683 - timing_s/ref:7.315 - timing_s/values:4.143 - timing_s/adv:0.017 - timing_s/update_critic:18.607 - timing_s/update_actor:19.979 - timing_s/step:56.288 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.667 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.621 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29964.000 - perf/time_per_step:56.288 - perf/throughput:532.334 - timing_s/total:4186.667
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:73 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.766 - global_seqlen/min:30178.000 - global_seqlen/max:30178.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30178.000 - global_seqlen/balanced_max:30178.000 - global_seqlen/mean:30178.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.094 - critic/grad_norm:10.088 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.132 - actor/pg_clipfrac:0.119 - actor/ppo_kl:-0.125 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.721 - actor/grad_norm:15.725 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.338 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.713 - critic/advantages/max:3.244 - critic/advantages/min:-7.574 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.011 - critic/values/max:0.133 - critic/values/min:-0.197 - critic/vf_explained_var:-0.824 - response_length/mean:235.758 - response_length/max:332.000 - response_length/min:225.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.581 - timing_s/old_log_prob:4.811 - timing_s/ref:7.340 - timing_s/values:4.071 - timing_s/adv:0.022 - timing_s/update_critic:19.008 - timing_s/update_actor:20.695 - timing_s/step:57.533 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.686 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.630 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30178.000 - perf/time_per_step:57.533 - perf/throughput:524.535 - timing_s/total:4244.204
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:74 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.547 - global_seqlen/min:30022.000 - global_seqlen/max:30022.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30022.000 - global_seqlen/balanced_max:30022.000 - global_seqlen/mean:30022.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.079 - critic/grad_norm:16.588 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.139 - actor/ppo_kl:0.034 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.819 - actor/grad_norm:7.034 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.338 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.043 - critic/advantages/max:3.599 - critic/advantages/min:-6.908 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.143 - critic/values/min:-0.101 - critic/vf_explained_var:-1.617 - response_length/mean:234.539 - response_length/max:333.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.484 - timing_s/old_log_prob:4.802 - timing_s/ref:7.338 - timing_s/values:4.097 - timing_s/adv:0.022 - timing_s/update_critic:19.476 - timing_s/update_actor:21.576 - timing_s/step:58.797 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.719 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.649 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:30022.000 - perf/time_per_step:58.797 - perf/throughput:510.603 - timing_s/total:4303.004
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:75 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.250 - global_seqlen/min:29984.000 - global_seqlen/max:29984.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29984.000 - global_seqlen/balanced_max:29984.000 - global_seqlen/mean:29984.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.096 - critic/grad_norm:12.672 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.131 - actor/ppo_kl:-0.014 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.861 - actor/grad_norm:15.335 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.335 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.891 - critic/advantages/max:6.532 - critic/advantages/min:-3.750 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.008 - critic/values/max:0.113 - critic/values/min:-0.028 - critic/vf_explained_var:-44.123 - response_length/mean:234.242 - response_length/max:273.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.654 - timing_s/old_log_prob:4.696 - timing_s/ref:7.321 - timing_s/values:4.109 - timing_s/adv:0.018 - timing_s/update_critic:19.641 - timing_s/update_actor:20.864 - timing_s/step:58.307 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.696 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.655 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:29984.000 - perf/time_per_step:58.307 - perf/throughput:514.248 - timing_s/total:4361.314
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:76 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.234 - global_seqlen/min:29854.000 - global_seqlen/max:29854.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29854.000 - global_seqlen/balanced_max:29854.000 - global_seqlen/mean:29854.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.106 - critic/grad_norm:13.853 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.065 - actor/pg_clipfrac:0.137 - actor/ppo_kl:0.159 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.845 - actor/grad_norm:17.550 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.332 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-3.199 - critic/advantages/max:7.164 - critic/advantages/min:-11.250 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.012 - critic/values/max:-0.000 - critic/values/min:-0.281 - critic/vf_explained_var:-3.213 - response_length/mean:233.227 - response_length/max:309.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.478 - timing_s/old_log_prob:4.793 - timing_s/ref:7.341 - timing_s/values:4.152 - timing_s/adv:0.021 - timing_s/update_critic:19.513 - timing_s/update_actor:21.119 - timing_s/step:58.420 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.707 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.654 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:29854.000 - perf/time_per_step:58.420 - perf/throughput:511.020 - timing_s/total:4419.738
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:77 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.195 - global_seqlen/min:29721.000 - global_seqlen/max:29721.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29721.000 - global_seqlen/balanced_max:29721.000 - global_seqlen/mean:29721.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.073 - critic/grad_norm:15.730 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.159 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.854 - actor/grad_norm:16.536 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.347 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-1.354 - critic/advantages/max:2.508 - critic/advantages/min:-12.076 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.004 - critic/values/max:0.008 - critic/values/min:-0.218 - critic/vf_explained_var:-0.267 - response_length/mean:232.188 - response_length/max:246.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.467 - timing_s/old_log_prob:4.713 - timing_s/ref:7.447 - timing_s/values:4.252 - timing_s/adv:0.007 - timing_s/update_critic:19.659 - timing_s/update_actor:20.895 - timing_s/step:58.442 - timing_per_token_ms/ref:0.251 - timing_per_token_ms/update_actor:0.703 - timing_per_token_ms/values:0.143 - timing_per_token_ms/update_critic:0.661 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:29721.000 - perf/time_per_step:58.442 - perf/throughput:508.554 - timing_s/total:4478.184
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:78 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.711 - global_seqlen/min:30043.000 - global_seqlen/max:30043.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30043.000 - global_seqlen/balanced_max:30043.000 - global_seqlen/mean:30043.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.067 - critic/grad_norm:13.577 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.065 - actor/pg_clipfrac:0.159 - actor/ppo_kl:0.023 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.822 - actor/grad_norm:4.761 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.347 - actor/lr:0.000 - critic/score/mean:0.095 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.095 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:5.826 - critic/advantages/max:6.839 - critic/advantages/min:-6.375 - critic/returns/mean:0.094 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.029 - critic/values/max:0.275 - critic/values/min:-0.138 - critic/vf_explained_var:-4.982 - response_length/mean:234.695 - response_length/max:330.000 - response_length/min:225.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.489 - timing_s/old_log_prob:4.877 - timing_s/ref:7.359 - timing_s/values:4.103 - timing_s/adv:0.009 - timing_s/update_critic:19.394 - timing_s/update_actor:20.698 - timing_s/step:57.931 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.689 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.646 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30043.000 - perf/time_per_step:57.931 - perf/throughput:518.598 - timing_s/total:4536.118
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:79 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.586 - global_seqlen/min:29643.000 - global_seqlen/max:29643.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29643.000 - global_seqlen/balanced_max:29643.000 - global_seqlen/mean:29643.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.100 - critic/grad_norm:12.928 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.138 - actor/ppo_kl:0.152 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.751 - actor/grad_norm:16.292 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.340 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:11.778 - critic/advantages/max:13.370 - critic/advantages/min:-3.409 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.017 - critic/values/max:0.179 - critic/values/min:0.000 - critic/vf_explained_var:-213.146 - response_length/mean:231.578 - response_length/max:245.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.468 - timing_s/old_log_prob:4.669 - timing_s/ref:7.303 - timing_s/values:4.031 - timing_s/adv:0.016 - timing_s/update_critic:19.017 - timing_s/update_actor:20.126 - timing_s/step:56.633 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.679 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.642 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:29643.000 - perf/time_per_step:56.633 - perf/throughput:523.423 - timing_s/total:4592.753
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.0969080924987793 seconds
[36m(TaskRunner pid=850907)[0m step:80 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.773 - global_seqlen/min:29923.000 - global_seqlen/max:29923.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29923.000 - global_seqlen/balanced_max:29923.000 - global_seqlen/mean:29923.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.122 - critic/grad_norm:16.419 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.169 - actor/ppo_kl:0.063 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.734 - actor/grad_norm:5.356 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.324 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.914 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:28.939 - val-core/unknown/reward/mean@512:0.164 - val-aux/unknown/reward/std@512:0.297 - val-aux/unknown/reward/best@2/mean:0.288 - val-aux/unknown/reward/best@2/std:0.381 - val-aux/unknown/reward/worst@2/mean:0.055 - val-aux/unknown/reward/worst@2/std:0.119 - val-aux/unknown/reward/best@4/mean:0.438 - val-aux/unknown/reward/best@4/std:0.437 - val-aux/unknown/reward/worst@4/mean:0.018 - val-aux/unknown/reward/worst@4/std:0.038 - val-aux/unknown/reward/best@8/mean:0.640 - val-aux/unknown/reward/best@8/std:0.441 - val-aux/unknown/reward/worst@8/mean:0.003 - val-aux/unknown/reward/worst@8/std:0.018 - val-aux/unknown/reward/best@16/mean:0.856 - val-aux/unknown/reward/best@16/std:0.330 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.004 - val-aux/unknown/reward/best@32/mean:0.974 - val-aux/unknown/reward/best@32/std:0.151 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.999 - val-aux/unknown/reward/best@64/std:0.028 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:9.899 - critic/advantages/max:11.415 - critic/advantages/min:-9.802 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.032 - critic/values/max:0.289 - critic/values/min:0.000 - critic/vf_explained_var:-21.998 - response_length/mean:233.766 - response_length/max:265.000 - response_length/min:227.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.545 - timing_s/old_log_prob:4.705 - timing_s/ref:7.345 - timing_s/values:4.150 - timing_s/adv:0.018 - timing_s/update_critic:19.058 - timing_s/update_actor:20.510 - timing_s/testing:3.560 - timing_s/step:60.895 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.685 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.637 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:29923.000 - perf/time_per_step:60.895 - perf/throughput:491.387 - timing_s/total:4653.649
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:81 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.609 - global_seqlen/min:30030.000 - global_seqlen/max:30030.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30030.000 - global_seqlen/balanced_max:30030.000 - global_seqlen/mean:30030.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.091 - critic/grad_norm:6.736 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.131 - actor/ppo_kl:0.187 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.819 - actor/grad_norm:24.415 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.343 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.727 - critic/advantages/max:4.287 - critic/advantages/min:-3.480 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.006 - critic/values/max:0.085 - critic/values/min:0.000 - critic/vf_explained_var:-25.813 - response_length/mean:234.602 - response_length/max:253.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.422 - timing_s/old_log_prob:4.692 - timing_s/ref:7.335 - timing_s/values:4.209 - timing_s/adv:0.017 - timing_s/update_critic:19.419 - timing_s/update_actor:20.545 - timing_s/step:57.642 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.684 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.647 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:30030.000 - perf/time_per_step:57.642 - perf/throughput:520.971 - timing_s/total:4711.294
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:82 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.094 - global_seqlen/min:30092.000 - global_seqlen/max:30092.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30092.000 - global_seqlen/balanced_max:30092.000 - global_seqlen/mean:30092.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.079 - critic/grad_norm:6.006 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.112 - actor/ppo_kl:0.185 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.826 - actor/grad_norm:9.436 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.350 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.679 - critic/advantages/max:2.006 - critic/advantages/min:-9.917 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.005 - critic/values/max:0.084 - critic/values/min:-0.066 - critic/vf_explained_var:-0.595 - response_length/mean:235.086 - response_length/max:251.000 - response_length/min:227.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.844 - timing_s/old_log_prob:4.768 - timing_s/ref:7.376 - timing_s/values:4.158 - timing_s/adv:0.017 - timing_s/update_critic:18.571 - timing_s/update_actor:20.811 - timing_s/step:57.547 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.692 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.617 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.061 - perf/total_num_tokens:30092.000 - perf/time_per_step:57.547 - perf/throughput:522.914 - timing_s/total:4768.844
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:83 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.367 - global_seqlen/min:30383.000 - global_seqlen/max:30383.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30383.000 - global_seqlen/balanced_max:30383.000 - global_seqlen/mean:30383.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.088 - critic/grad_norm:6.259 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.109 - actor/ppo_kl:0.008 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.602 - actor/grad_norm:23.857 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.361 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.795 - critic/advantages/max:4.642 - critic/advantages/min:-3.508 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.007 - critic/values/max:0.092 - critic/values/min:-0.003 - critic/vf_explained_var:-32.502 - response_length/mean:237.359 - response_length/max:254.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.551 - timing_s/old_log_prob:4.688 - timing_s/ref:7.336 - timing_s/values:4.181 - timing_s/adv:0.017 - timing_s/update_critic:19.176 - timing_s/update_actor:20.230 - timing_s/step:57.184 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.666 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.631 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30383.000 - perf/time_per_step:57.184 - perf/throughput:531.319 - timing_s/total:4826.031
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:84 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.320 - global_seqlen/min:30633.000 - global_seqlen/max:30633.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30633.000 - global_seqlen/balanced_max:30633.000 - global_seqlen/mean:30633.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.089 - critic/grad_norm:6.126 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.111 - actor/ppo_kl:0.127 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.656 - actor/grad_norm:20.996 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.364 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:4.180 - critic/advantages/max:4.904 - critic/advantages/min:-4.205 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.008 - critic/values/max:0.103 - critic/values/min:0.000 - critic/vf_explained_var:-39.588 - response_length/mean:239.312 - response_length/max:262.000 - response_length/min:228.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.529 - timing_s/old_log_prob:4.729 - timing_s/ref:7.356 - timing_s/values:4.121 - timing_s/adv:0.018 - timing_s/update_critic:18.679 - timing_s/update_actor:20.015 - timing_s/step:56.450 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.653 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.610 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30633.000 - perf/time_per_step:56.450 - perf/throughput:542.659 - timing_s/total:4882.485
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:85 - train/Bandit/success:0.016 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.594 - global_seqlen/min:30540.000 - global_seqlen/max:30540.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30540.000 - global_seqlen/balanced_max:30540.000 - global_seqlen/mean:30540.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.082 - critic/grad_norm:5.515 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.111 - actor/ppo_kl:-0.058 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.677 - actor/grad_norm:10.971 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.385 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.953 - critic/advantages/max:3.105 - critic/advantages/min:-10.056 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.007 - critic/values/max:0.095 - critic/values/min:-0.015 - critic/vf_explained_var:-0.694 - response_length/mean:238.586 - response_length/max:267.000 - response_length/min:227.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.565 - timing_s/old_log_prob:4.774 - timing_s/ref:7.299 - timing_s/values:4.148 - timing_s/adv:0.008 - timing_s/update_critic:19.550 - timing_s/update_actor:20.776 - timing_s/step:58.124 - timing_per_token_ms/ref:0.239 - timing_per_token_ms/update_actor:0.680 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.640 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30540.000 - perf/time_per_step:58.124 - perf/throughput:525.425 - timing_s/total:4940.612
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:86 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.758 - global_seqlen/min:30177.000 - global_seqlen/max:30177.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30177.000 - global_seqlen/balanced_max:30177.000 - global_seqlen/mean:30177.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.083 - critic/grad_norm:6.027 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.106 - actor/ppo_kl:0.027 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.771 - actor/grad_norm:16.093 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.358 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:4.398 - critic/advantages/max:5.657 - critic/advantages/min:-3.576 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.007 - critic/values/max:0.088 - critic/values/min:-0.006 - critic/vf_explained_var:-31.419 - response_length/mean:235.750 - response_length/max:254.000 - response_length/min:225.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.546 - timing_s/old_log_prob:4.636 - timing_s/ref:7.344 - timing_s/values:4.138 - timing_s/adv:0.007 - timing_s/update_critic:19.477 - timing_s/update_actor:20.739 - timing_s/step:57.891 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.687 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.645 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30177.000 - perf/time_per_step:57.891 - perf/throughput:521.276 - timing_s/total:4998.507
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:87 - train/Bandit/success:0.039 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.461 - global_seqlen/min:30395.000 - global_seqlen/max:30395.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30395.000 - global_seqlen/balanced_max:30395.000 - global_seqlen/mean:30395.000 - critic/vf_loss:0.013 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.126 - critic/grad_norm:13.934 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.130 - actor/ppo_kl:0.190 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.758 - actor/grad_norm:6.698 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.382 - actor/lr:0.000 - critic/score/mean:0.120 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.120 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.292 - critic/advantages/max:6.829 - critic/advantages/min:-1.051 - critic/returns/mean:0.119 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.006 - critic/values/max:0.091 - critic/values/min:0.000 - critic/vf_explained_var:-0.013 - response_length/mean:237.453 - response_length/max:262.000 - response_length/min:227.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.511 - timing_s/old_log_prob:4.716 - timing_s/ref:7.330 - timing_s/values:4.029 - timing_s/adv:0.017 - timing_s/update_critic:19.277 - timing_s/update_actor:20.574 - timing_s/step:57.459 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.677 - timing_per_token_ms/values:0.133 - timing_per_token_ms/update_critic:0.634 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30395.000 - perf/time_per_step:57.459 - perf/throughput:528.984 - timing_s/total:5055.969
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:88 - train/Bandit/success:0.516 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.016 - global_seqlen/min:30082.000 - global_seqlen/max:30082.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30082.000 - global_seqlen/balanced_max:30082.000 - global_seqlen/mean:30082.000 - critic/vf_loss:0.042 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.061 - critic/grad_norm:26.597 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.188 - actor/ppo_kl:0.473 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.773 - actor/grad_norm:7.636 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.378 - actor/lr:0.000 - critic/score/mean:0.119 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.119 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.825 - critic/advantages/max:4.454 - critic/advantages/min:-0.679 - critic/returns/mean:0.119 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.032 - critic/values/max:0.291 - critic/values/min:0.000 - critic/vf_explained_var:-0.107 - response_length/mean:235.008 - response_length/max:254.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.805 - timing_s/old_log_prob:4.761 - timing_s/ref:7.388 - timing_s/values:4.170 - timing_s/adv:0.007 - timing_s/update_critic:19.235 - timing_s/update_actor:20.552 - timing_s/step:57.922 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.683 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.639 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.060 - perf/total_num_tokens:30082.000 - perf/time_per_step:57.922 - perf/throughput:519.356 - timing_s/total:5113.894
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:89 - train/Bandit/success:0.281 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.867 - global_seqlen/min:30575.000 - global_seqlen/max:30575.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30575.000 - global_seqlen/balanced_max:30575.000 - global_seqlen/mean:30575.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.053 - critic/grad_norm:14.949 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.148 - actor/ppo_kl:-0.042 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.682 - actor/grad_norm:7.210 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.387 - actor/lr:0.000 - critic/score/mean:0.072 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.072 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:2.679 - critic/advantages/max:3.721 - critic/advantages/min:-2.343 - critic/returns/mean:0.072 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.022 - critic/values/max:0.192 - critic/values/min:0.000 - critic/vf_explained_var:-1.428 - response_length/mean:238.859 - response_length/max:253.000 - response_length/min:229.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.621 - timing_s/old_log_prob:4.732 - timing_s/ref:7.366 - timing_s/values:4.186 - timing_s/adv:0.012 - timing_s/update_critic:19.039 - timing_s/update_actor:20.443 - timing_s/step:57.403 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.669 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.623 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:30575.000 - perf/time_per_step:57.403 - perf/throughput:532.641 - timing_s/total:5171.299
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 2.951564073562622 seconds
[36m(TaskRunner pid=850907)[0m step:90 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:37.211 - global_seqlen/min:30875.000 - global_seqlen/max:30875.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30875.000 - global_seqlen/balanced_max:30875.000 - global_seqlen/mean:30875.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.100 - critic/grad_norm:14.572 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.170 - actor/pg_clipfrac:0.148 - actor/ppo_kl:-0.179 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.628 - actor/grad_norm:4.621 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.384 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:0.992 - val-env/BanditTest/num_actions:0.996 - val-env/BanditTest/action_is_effective:0.996 - val-env/BanditTest/action_is_valid:0.996 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:33.900 - val-core/unknown/reward/mean@512:0.173 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.302 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.014 - val-aux/unknown/reward/worst@4/std:0.039 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:-0.000 - val-aux/unknown/reward/worst@8/std:0.021 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:-0.004 - val-aux/unknown/reward/worst@16/std:0.020 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:-0.007 - val-aux/unknown/reward/worst@32/std:0.025 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.012 - val-aux/unknown/reward/worst@64/std:0.032 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.023 - val-aux/unknown/reward/worst@128/std:0.042 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.040 - val-aux/unknown/reward/worst@256/std:0.049 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.095 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.095 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.395 - critic/advantages/max:5.317 - critic/advantages/min:-5.433 - critic/returns/mean:0.094 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.030 - critic/values/max:0.231 - critic/values/min:-0.013 - critic/vf_explained_var:-4.122 - response_length/mean:241.203 - response_length/max:329.000 - response_length/min:230.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.556 - timing_s/old_log_prob:4.818 - timing_s/ref:7.367 - timing_s/values:4.071 - timing_s/adv:0.022 - timing_s/update_critic:19.116 - timing_s/update_actor:20.621 - timing_s/testing:3.312 - timing_s/step:60.886 - timing_per_token_ms/ref:0.239 - timing_per_token_ms/update_actor:0.668 - timing_per_token_ms/values:0.132 - timing_per_token_ms/update_critic:0.619 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30875.000 - perf/time_per_step:60.886 - perf/throughput:507.099 - timing_s/total:5232.187
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:91 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.852 - global_seqlen/min:30445.000 - global_seqlen/max:30445.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30445.000 - global_seqlen/balanced_max:30445.000 - global_seqlen/mean:30445.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.103 - critic/grad_norm:13.841 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.117 - actor/ppo_kl:0.091 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.612 - actor/grad_norm:16.206 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.399 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:6.827 - critic/advantages/max:7.959 - critic/advantages/min:-3.088 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.012 - critic/values/max:0.120 - critic/values/min:0.000 - critic/vf_explained_var:-91.346 - response_length/mean:237.844 - response_length/max:260.000 - response_length/min:227.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.324 - timing_s/old_log_prob:4.661 - timing_s/ref:7.298 - timing_s/values:4.169 - timing_s/adv:0.017 - timing_s/update_critic:18.941 - timing_s/update_actor:20.496 - timing_s/step:56.907 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.673 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.622 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.043 - perf/total_num_tokens:30445.000 - perf/time_per_step:56.907 - perf/throughput:534.996 - timing_s/total:5289.097
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:92 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:36.000 - global_seqlen/min:30720.000 - global_seqlen/max:30720.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30720.000 - global_seqlen/balanced_max:30720.000 - global_seqlen/mean:30720.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.102 - critic/grad_norm:12.291 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.078 - actor/pg_clipfrac:0.111 - actor/ppo_kl:-0.069 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.579 - actor/grad_norm:5.462 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.399 - actor/lr:0.000 - critic/score/mean:0.092 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.092 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.611 - critic/advantages/max:3.263 - critic/advantages/min:-5.227 - critic/returns/mean:0.091 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.018 - critic/values/max:0.159 - critic/values/min:-0.105 - critic/vf_explained_var:-1.096 - response_length/mean:239.992 - response_length/max:326.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.806 - timing_s/old_log_prob:4.873 - timing_s/ref:7.358 - timing_s/values:4.159 - timing_s/adv:0.021 - timing_s/update_critic:18.925 - timing_s/update_actor:20.798 - timing_s/step:57.944 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.677 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.616 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.059 - perf/total_num_tokens:30720.000 - perf/time_per_step:57.944 - perf/throughput:530.167 - timing_s/total:5347.043
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:93 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.070 - global_seqlen/min:30473.000 - global_seqlen/max:30473.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30473.000 - global_seqlen/balanced_max:30473.000 - global_seqlen/mean:30473.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.094 - critic/grad_norm:12.507 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.095 - actor/ppo_kl:-0.038 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.617 - actor/grad_norm:6.902 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.805 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.116 - critic/advantages/max:3.524 - critic/advantages/min:-8.395 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.005 - critic/values/max:0.065 - critic/values/min:-0.117 - critic/vf_explained_var:-0.207 - response_length/mean:238.062 - response_length/max:262.000 - response_length/min:227.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.772 - timing_s/old_log_prob:4.760 - timing_s/ref:7.667 - timing_s/values:4.171 - timing_s/adv:0.017 - timing_s/update_critic:19.300 - timing_s/update_actor:20.019 - timing_s/step:57.711 - timing_per_token_ms/ref:0.252 - timing_per_token_ms/update_actor:0.657 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.633 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - perf/total_num_tokens:30473.000 - perf/time_per_step:57.711 - perf/throughput:528.028 - timing_s/total:5404.757
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:94 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.719 - global_seqlen/min:30684.000 - global_seqlen/max:30684.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30684.000 - global_seqlen/balanced_max:30684.000 - global_seqlen/mean:30684.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.095 - critic/grad_norm:7.923 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.103 - actor/ppo_kl:0.033 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.522 - actor/grad_norm:3.062 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.862 - actor/lr:0.000 - critic/score/mean:0.092 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.092 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.266 - critic/advantages/max:1.681 - critic/advantages/min:-5.384 - critic/returns/mean:0.092 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.009 - critic/values/max:0.090 - critic/values/min:-0.002 - critic/vf_explained_var:-0.294 - response_length/mean:239.711 - response_length/max:251.000 - response_length/min:229.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.776 - timing_s/old_log_prob:4.686 - timing_s/ref:7.362 - timing_s/values:4.170 - timing_s/adv:0.017 - timing_s/update_critic:18.889 - timing_s/update_actor:20.541 - timing_s/step:57.444 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.669 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.616 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - perf/total_num_tokens:30684.000 - perf/time_per_step:57.444 - perf/throughput:534.157 - timing_s/total:5462.203
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:95 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:36.797 - global_seqlen/min:30822.000 - global_seqlen/max:30822.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30822.000 - global_seqlen/balanced_max:30822.000 - global_seqlen/mean:30822.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.076 - critic/grad_norm:10.288 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.087 - actor/ppo_kl:-0.010 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.563 - actor/grad_norm:3.287 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.883 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.412 - critic/advantages/max:5.463 - critic/advantages/min:-7.839 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.001 - critic/values/max:0.044 - critic/values/min:-0.270 - critic/vf_explained_var:0.126 - response_length/mean:240.789 - response_length/max:337.000 - response_length/min:229.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.512 - timing_s/old_log_prob:4.866 - timing_s/ref:7.325 - timing_s/values:4.141 - timing_s/adv:0.022 - timing_s/update_critic:18.678 - timing_s/update_actor:20.810 - timing_s/step:57.359 - timing_per_token_ms/ref:0.238 - timing_per_token_ms/update_actor:0.675 - timing_per_token_ms/values:0.134 - timing_per_token_ms/update_critic:0.606 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:30822.000 - perf/time_per_step:57.359 - perf/throughput:537.354 - timing_s/total:5519.565
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:96 - train/Bandit/success:0.008 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:36.250 - global_seqlen/min:30752.000 - global_seqlen/max:30752.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30752.000 - global_seqlen/balanced_max:30752.000 - global_seqlen/mean:30752.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.096 - critic/grad_norm:10.173 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.061 - actor/pg_clipfrac:0.101 - actor/ppo_kl:-0.006 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.560 - actor/grad_norm:3.659 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.901 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:6.339 - critic/advantages/max:7.565 - critic/advantages/min:-9.041 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.026 - critic/values/max:0.203 - critic/values/min:0.000 - critic/vf_explained_var:-7.766 - response_length/mean:240.242 - response_length/max:324.000 - response_length/min:228.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.614 - timing_s/old_log_prob:4.808 - timing_s/ref:7.385 - timing_s/values:4.142 - timing_s/adv:0.021 - timing_s/update_critic:19.026 - timing_s/update_actor:20.696 - timing_s/step:57.695 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.673 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.619 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30752.000 - perf/time_per_step:57.695 - perf/throughput:533.010 - timing_s/total:5577.263
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:97 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.391 - global_seqlen/min:30642.000 - global_seqlen/max:30642.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30642.000 - global_seqlen/balanced_max:30642.000 - global_seqlen/mean:30642.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.103 - critic/grad_norm:9.022 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.051 - actor/pg_clipfrac:0.117 - actor/ppo_kl:-0.198 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.671 - actor/grad_norm:4.048 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.929 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.782 - critic/advantages/max:2.204 - critic/advantages/min:-7.908 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.008 - critic/values/max:0.085 - critic/values/min:-0.162 - critic/vf_explained_var:-0.433 - response_length/mean:239.383 - response_length/max:326.000 - response_length/min:228.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.560 - timing_s/old_log_prob:4.833 - timing_s/ref:7.337 - timing_s/values:4.133 - timing_s/adv:0.021 - timing_s/update_critic:19.104 - timing_s/update_actor:20.908 - timing_s/step:57.900 - timing_per_token_ms/ref:0.239 - timing_per_token_ms/update_actor:0.682 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.623 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30642.000 - perf/time_per_step:57.900 - perf/throughput:529.222 - timing_s/total:5635.166
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:98 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.992 - global_seqlen/min:30079.000 - global_seqlen/max:30079.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30079.000 - global_seqlen/balanced_max:30079.000 - global_seqlen/mean:30079.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:9.600 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.105 - actor/ppo_kl:0.097 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.724 - actor/grad_norm:10.649 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.946 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:4.072 - critic/advantages/max:4.691 - critic/advantages/min:-3.274 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.006 - critic/values/max:0.072 - critic/values/min:0.000 - critic/vf_explained_var:-20.826 - response_length/mean:234.977 - response_length/max:248.000 - response_length/min:225.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.533 - timing_s/old_log_prob:4.712 - timing_s/ref:7.384 - timing_s/values:4.174 - timing_s/adv:0.016 - timing_s/update_critic:19.261 - timing_s/update_actor:20.691 - timing_s/step:57.775 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.688 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.640 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30079.000 - perf/time_per_step:57.775 - perf/throughput:520.623 - timing_s/total:5692.944
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:99 - train/Bandit/success:0.008 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/success:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.594 - global_seqlen/min:30156.000 - global_seqlen/max:30156.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30156.000 - global_seqlen/balanced_max:30156.000 - global_seqlen/mean:30156.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.090 - critic/grad_norm:9.622 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.091 - actor/ppo_kl:0.056 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.748 - actor/grad_norm:11.155 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.959 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:0.100 - critic/score/min:0.000 - critic/rewards/mean:0.099 - critic/rewards/max:0.100 - critic/rewards/min:0.000 - critic/advantages/mean:10.983 - critic/advantages/max:12.742 - critic/advantages/min:-8.645 - critic/returns/mean:0.099 - critic/returns/max:0.100 - critic/returns/min:0.000 - critic/values/mean:0.023 - critic/values/max:0.206 - critic/values/min:0.000 - critic/vf_explained_var:-38.529 - response_length/mean:235.586 - response_length/max:260.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.573 - timing_s/old_log_prob:4.759 - timing_s/ref:7.358 - timing_s/values:4.149 - timing_s/adv:0.017 - timing_s/update_critic:19.572 - timing_s/update_actor:20.943 - timing_s/step:58.376 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.694 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.649 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30156.000 - perf/time_per_step:58.376 - perf/throughput:516.584 - timing_s/total:5751.324
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.2955522537231445 seconds
[36m(TaskRunner pid=850907)[0m step:100 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.234 - global_seqlen/min:30110.000 - global_seqlen/max:30110.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30110.000 - global_seqlen/balanced_max:30110.000 - global_seqlen/mean:30110.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.095 - critic/grad_norm:9.444 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.080 - actor/pg_clipfrac:0.133 - actor/ppo_kl:-0.039 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.696 - actor/grad_norm:4.145 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.891 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.996 - val-env/Bandit/action_is_effective:0.996 - val-env/Bandit/action_is_valid:0.996 - val-env/BanditTest/success:1.000 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:31.838 - val-core/unknown/reward/mean@512:0.173 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.302 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.014 - val-aux/unknown/reward/worst@4/std:0.037 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:0.000 - val-aux/unknown/reward/worst@8/std:0.019 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:-0.003 - val-aux/unknown/reward/worst@16/std:0.018 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:-0.007 - val-aux/unknown/reward/worst@32/std:0.025 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.012 - val-aux/unknown/reward/worst@64/std:0.032 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.022 - val-aux/unknown/reward/worst@128/std:0.042 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.040 - val-aux/unknown/reward/worst@256/std:0.049 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.531 - critic/advantages/max:1.873 - critic/advantages/min:-7.459 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.006 - critic/values/max:0.084 - critic/values/min:-0.127 - critic/vf_explained_var:-0.283 - response_length/mean:235.227 - response_length/max:324.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.847 - timing_s/old_log_prob:4.815 - timing_s/ref:7.356 - timing_s/values:4.234 - timing_s/adv:0.021 - timing_s/update_critic:19.375 - timing_s/update_actor:20.871 - timing_s/testing:3.602 - timing_s/step:62.124 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.693 - timing_per_token_ms/values:0.141 - timing_per_token_ms/update_critic:0.643 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.061 - perf/total_num_tokens:30110.000 - perf/time_per_step:62.124 - perf/throughput:484.679 - timing_s/total:5813.450
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:101 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.680 - global_seqlen/min:30039.000 - global_seqlen/max:30039.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30039.000 - global_seqlen/balanced_max:30039.000 - global_seqlen/mean:30039.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.074 - critic/grad_norm:9.728 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.116 - actor/ppo_kl:0.051 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.674 - actor/grad_norm:75.785 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.914 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.087 - critic/advantages/max:2.145 - critic/advantages/min:-8.708 - critic/returns/mean:0.097 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.004 - critic/values/max:0.059 - critic/values/min:-0.019 - critic/vf_explained_var:-0.177 - response_length/mean:234.672 - response_length/max:251.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.331 - timing_s/old_log_prob:4.708 - timing_s/ref:7.353 - timing_s/values:4.134 - timing_s/adv:0.017 - timing_s/update_critic:19.475 - timing_s/update_actor:20.636 - timing_s/step:57.658 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.687 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.648 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:30039.000 - perf/time_per_step:57.658 - perf/throughput:520.984 - timing_s/total:5871.111
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:102 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.344 - global_seqlen/min:29868.000 - global_seqlen/max:29868.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29868.000 - global_seqlen/balanced_max:29868.000 - global_seqlen/mean:29868.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.077 - critic/grad_norm:9.805 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.109 - actor/ppo_kl:0.164 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.720 - actor/grad_norm:13.871 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.925 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:15.392 - critic/advantages/max:17.607 - critic/advantages/min:-3.320 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.020 - critic/values/max:0.187 - critic/values/min:0.000 - critic/vf_explained_var:-270.780 - response_length/mean:233.336 - response_length/max:257.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.489 - timing_s/old_log_prob:4.801 - timing_s/ref:7.378 - timing_s/values:4.136 - timing_s/adv:0.017 - timing_s/update_critic:19.290 - timing_s/update_actor:20.727 - timing_s/step:57.840 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.694 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.646 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:29868.000 - perf/time_per_step:57.840 - perf/throughput:516.387 - timing_s/total:5928.954
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:103 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.977 - train/Bandit/action_is_effective:0.977 - train/Bandit/action_is_valid:0.977 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.625 - global_seqlen/min:30160.000 - global_seqlen/max:30160.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30160.000 - global_seqlen/balanced_max:30160.000 - global_seqlen/mean:30160.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.080 - critic/grad_norm:8.185 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.179 - actor/pg_clipfrac:0.134 - actor/ppo_kl:-0.129 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.761 - actor/grad_norm:3.687 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.946 - actor/lr:0.000 - critic/score/mean:0.095 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.095 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.004 - critic/advantages/max:1.392 - critic/advantages/min:-5.897 - critic/returns/mean:0.094 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.004 - critic/values/max:0.066 - critic/values/min:-0.179 - critic/vf_explained_var:0.091 - response_length/mean:235.617 - response_length/max:338.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.479 - timing_s/old_log_prob:4.844 - timing_s/ref:7.376 - timing_s/values:4.129 - timing_s/adv:0.022 - timing_s/update_critic:19.303 - timing_s/update_actor:20.994 - timing_s/step:58.152 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.696 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.640 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:30160.000 - perf/time_per_step:58.152 - perf/throughput:518.641 - timing_s/total:5987.108
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:104 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.453 - global_seqlen/min:30010.000 - global_seqlen/max:30010.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30010.000 - global_seqlen/balanced_max:30010.000 - global_seqlen/mean:30010.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.064 - critic/grad_norm:9.907 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.089 - actor/pg_clipfrac:0.123 - actor/ppo_kl:0.108 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.687 - actor/grad_norm:6.417 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.970 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.880 - critic/advantages/max:1.706 - critic/advantages/min:-9.675 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.002 - critic/values/max:0.050 - critic/values/min:-0.193 - critic/vf_explained_var:0.092 - response_length/mean:234.445 - response_length/max:317.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.577 - timing_s/old_log_prob:4.892 - timing_s/ref:7.344 - timing_s/values:4.105 - timing_s/adv:0.021 - timing_s/update_critic:18.856 - timing_s/update_actor:20.549 - timing_s/step:57.348 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.685 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.628 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:30010.000 - perf/time_per_step:57.348 - perf/throughput:523.293 - timing_s/total:6044.460
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:105 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.938 - global_seqlen/min:29816.000 - global_seqlen/max:29816.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29816.000 - global_seqlen/balanced_max:29816.000 - global_seqlen/mean:29816.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.074 - critic/grad_norm:9.287 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.069 - actor/pg_clipfrac:0.107 - actor/ppo_kl:-0.055 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.665 - actor/grad_norm:5.202 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.953 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:6.348 - critic/advantages/max:7.327 - critic/advantages/min:-10.869 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.017 - critic/values/max:0.175 - critic/values/min:-0.118 - critic/vf_explained_var:-4.826 - response_length/mean:232.930 - response_length/max:325.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.475 - timing_s/old_log_prob:4.823 - timing_s/ref:7.334 - timing_s/values:4.125 - timing_s/adv:0.021 - timing_s/update_critic:19.474 - timing_s/update_actor:20.913 - timing_s/step:58.171 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.701 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.653 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:29816.000 - perf/time_per_step:58.171 - perf/throughput:512.555 - timing_s/total:6102.636
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:106 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.148 - global_seqlen/min:29843.000 - global_seqlen/max:29843.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29843.000 - global_seqlen/balanced_max:29843.000 - global_seqlen/mean:29843.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.111 - critic/grad_norm:9.094 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.046 - actor/pg_clipfrac:0.125 - actor/ppo_kl:-0.102 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.636 - actor/grad_norm:4.156 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.969 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.366 - critic/advantages/max:6.193 - critic/advantages/min:-10.274 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.007 - critic/values/max:0.085 - critic/values/min:-0.271 - critic/vf_explained_var:-0.578 - response_length/mean:233.141 - response_length/max:315.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.725 - timing_s/old_log_prob:4.876 - timing_s/ref:7.362 - timing_s/values:4.151 - timing_s/adv:0.021 - timing_s/update_critic:19.022 - timing_s/update_actor:21.194 - timing_s/step:58.353 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.710 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.637 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - perf/total_num_tokens:29843.000 - perf/time_per_step:58.353 - perf/throughput:511.418 - timing_s/total:6160.993
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:107 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.773 - train/Bandit/action_is_effective:0.773 - train/Bandit/action_is_valid:0.773 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:48.867 - global_seqlen/min:32367.000 - global_seqlen/max:32367.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32367.000 - global_seqlen/balanced_max:32367.000 - global_seqlen/mean:32367.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.052 - critic/grad_norm:7.740 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.448 - actor/pg_clipfrac:0.128 - actor/ppo_kl:-0.006 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:0.540 - actor/grad_norm:15.942 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:405.990 - actor/lr:0.000 - critic/score/mean:0.055 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.055 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.764 - critic/advantages/max:2.138 - critic/advantages/min:-2.344 - critic/returns/mean:0.042 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.001 - critic/values/max:0.091 - critic/values/min:-0.241 - critic/vf_explained_var:0.097 - response_length/mean:252.859 - response_length/max:328.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.568 - timing_s/old_log_prob:4.852 - timing_s/ref:7.359 - timing_s/values:4.178 - timing_s/adv:0.022 - timing_s/update_critic:19.773 - timing_s/update_actor:21.029 - timing_s/step:58.784 - timing_per_token_ms/ref:0.227 - timing_per_token_ms/update_actor:0.650 - timing_per_token_ms/values:0.129 - timing_per_token_ms/update_critic:0.611 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.048 - perf/total_num_tokens:32367.000 - perf/time_per_step:58.784 - perf/throughput:550.607 - timing_s/total:6219.781
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:108 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.914 - global_seqlen/min:29685.000 - global_seqlen/max:29685.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29685.000 - global_seqlen/balanced_max:29685.000 - global_seqlen/mean:29685.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.108 - critic/grad_norm:11.258 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.123 - actor/ppo_kl:0.186 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.637 - actor/grad_norm:15.971 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.005 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:-0.810 - critic/advantages/max:3.900 - critic/advantages/min:-2.902 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:-0.001 - critic/values/max:0.023 - critic/values/min:-0.056 - critic/vf_explained_var:-1.851 - response_length/mean:231.891 - response_length/max:243.000 - response_length/min:221.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.546 - timing_s/old_log_prob:4.733 - timing_s/ref:7.336 - timing_s/values:4.166 - timing_s/adv:0.016 - timing_s/update_critic:19.076 - timing_s/update_actor:20.423 - timing_s/step:57.300 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.688 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.643 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:29685.000 - perf/time_per_step:57.300 - perf/throughput:518.060 - timing_s/total:6277.085
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:109 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.766 - global_seqlen/min:30050.000 - global_seqlen/max:30050.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30050.000 - global_seqlen/balanced_max:30050.000 - global_seqlen/mean:30050.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.095 - critic/grad_norm:6.016 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.088 - actor/pg_clipfrac:0.109 - actor/ppo_kl:-0.096 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.619 - actor/grad_norm:27.102 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.013 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.862 - critic/advantages/max:5.000 - critic/advantages/min:-9.642 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.143 - critic/values/min:-0.069 - critic/vf_explained_var:-2.375 - response_length/mean:234.758 - response_length/max:337.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.573 - timing_s/old_log_prob:4.875 - timing_s/ref:7.358 - timing_s/values:4.151 - timing_s/adv:0.023 - timing_s/update_critic:18.852 - timing_s/update_actor:21.005 - timing_s/step:57.841 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.699 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.627 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30050.000 - perf/time_per_step:57.841 - perf/throughput:519.531 - timing_s/total:6334.929
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.118894100189209 seconds
[36m(TaskRunner pid=850907)[0m step:110 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.891 - global_seqlen/min:29938.000 - global_seqlen/max:29938.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29938.000 - global_seqlen/balanced_max:29938.000 - global_seqlen/mean:29938.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.105 - critic/grad_norm:14.054 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.026 - actor/pg_clipfrac:0.134 - actor/ppo_kl:0.161 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.610 - actor/grad_norm:21.285 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.018 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.984 - val-env/Bandit/action_is_effective:0.984 - val-env/Bandit/action_is_valid:0.984 - val-env/BanditTest/success:0.988 - val-env/BanditTest/num_actions:0.996 - val-env/BanditTest/action_is_effective:0.996 - val-env/BanditTest/action_is_valid:0.996 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:29.607 - val-core/unknown/reward/mean@512:0.172 - val-aux/unknown/reward/std@512:0.314 - val-aux/unknown/reward/best@2/mean:0.301 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.050 - val-aux/unknown/reward/worst@2/std:0.132 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.444 - val-aux/unknown/reward/worst@4/mean:0.011 - val-aux/unknown/reward/worst@4/std:0.042 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:-0.006 - val-aux/unknown/reward/worst@8/std:0.031 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:-0.015 - val-aux/unknown/reward/worst@16/std:0.036 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:-0.026 - val-aux/unknown/reward/worst@32/std:0.044 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.047 - val-aux/unknown/reward/worst@64/std:0.050 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.072 - val-aux/unknown/reward/worst@128/std:0.045 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.091 - val-aux/unknown/reward/worst@256/std:0.029 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:6.418 - critic/advantages/max:8.705 - critic/advantages/min:-3.831 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.009 - critic/values/max:0.104 - critic/values/min:-0.013 - critic/vf_explained_var:-52.253 - response_length/mean:233.883 - response_length/max:251.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.594 - timing_s/old_log_prob:4.724 - timing_s/ref:7.329 - timing_s/values:4.156 - timing_s/adv:0.017 - timing_s/update_critic:18.760 - timing_s/update_actor:20.088 - timing_s/testing:3.434 - timing_s/step:60.107 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.671 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.627 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:29938.000 - perf/time_per_step:60.107 - perf/throughput:498.080 - timing_s/total:6395.038
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:111 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.383 - global_seqlen/min:29745.000 - global_seqlen/max:29745.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29745.000 - global_seqlen/balanced_max:29745.000 - global_seqlen/mean:29745.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.088 - critic/grad_norm:7.193 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.120 - actor/ppo_kl:-0.020 - actor/pg_clipfrac_lower:0.003 - actor/entropy_loss:0.579 - actor/grad_norm:24.164 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.036 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:-5.369 - critic/advantages/max:6.100 - critic/advantages/min:-6.116 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:-0.007 - critic/values/max:-0.000 - critic/values/min:-0.116 - critic/vf_explained_var:-36.087 - response_length/mean:232.359 - response_length/max:243.000 - response_length/min:223.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.319 - timing_s/old_log_prob:4.706 - timing_s/ref:7.353 - timing_s/values:4.138 - timing_s/adv:0.016 - timing_s/update_critic:19.456 - timing_s/update_actor:20.559 - timing_s/step:57.552 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.691 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.654 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:29745.000 - perf/time_per_step:57.552 - perf/throughput:516.841 - timing_s/total:6452.592
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:112 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.984 - global_seqlen/min:29694.000 - global_seqlen/max:29694.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29694.000 - global_seqlen/balanced_max:29694.000 - global_seqlen/mean:29694.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:4.833 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.172 - actor/ppo_kl:0.137 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.560 - actor/grad_norm:7.320 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.043 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:10.652 - critic/advantages/max:12.113 - critic/advantages/min:-3.320 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.013 - critic/values/max:0.142 - critic/values/min:0.000 - critic/vf_explained_var:-131.058 - response_length/mean:231.977 - response_length/max:245.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.511 - timing_s/old_log_prob:4.708 - timing_s/ref:7.365 - timing_s/values:4.196 - timing_s/adv:0.016 - timing_s/update_critic:18.737 - timing_s/update_actor:20.394 - timing_s/step:56.931 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/update_actor:0.687 - timing_per_token_ms/values:0.141 - timing_per_token_ms/update_critic:0.631 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29694.000 - perf/time_per_step:56.931 - perf/throughput:521.575 - timing_s/total:6509.525
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:113 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.648 - global_seqlen/min:29651.000 - global_seqlen/max:29651.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29651.000 - global_seqlen/balanced_max:29651.000 - global_seqlen/mean:29651.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.089 - critic/grad_norm:4.811 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.141 - actor/ppo_kl:0.062 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.611 - actor/grad_norm:7.604 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.057 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:12.006 - critic/advantages/max:13.633 - critic/advantages/min:-2.625 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.014 - critic/values/max:0.140 - critic/values/min:0.000 - critic/vf_explained_var:-144.031 - response_length/mean:231.641 - response_length/max:242.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.504 - timing_s/old_log_prob:4.713 - timing_s/ref:7.350 - timing_s/values:4.113 - timing_s/adv:0.016 - timing_s/update_critic:19.206 - timing_s/update_actor:20.821 - timing_s/step:57.727 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/update_actor:0.702 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.648 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29651.000 - perf/time_per_step:57.727 - perf/throughput:513.642 - timing_s/total:6567.254
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:114 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.297 - global_seqlen/min:29606.000 - global_seqlen/max:29606.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29606.000 - global_seqlen/balanced_max:29606.000 - global_seqlen/mean:29606.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:4.717 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.121 - actor/ppo_kl:0.075 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.644 - actor/grad_norm:14.804 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.073 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:12.959 - critic/advantages/max:14.693 - critic/advantages/min:-3.338 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.014 - critic/values/max:0.142 - critic/values/min:0.000 - critic/vf_explained_var:-138.324 - response_length/mean:231.289 - response_length/max:244.000 - response_length/min:223.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.497 - timing_s/old_log_prob:4.733 - timing_s/ref:7.366 - timing_s/values:4.118 - timing_s/adv:0.017 - timing_s/update_critic:19.714 - timing_s/update_actor:20.674 - timing_s/step:58.123 - timing_per_token_ms/ref:0.249 - timing_per_token_ms/update_actor:0.698 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.666 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29606.000 - perf/time_per_step:58.123 - perf/throughput:509.365 - timing_s/total:6625.380
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:115 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.070 - global_seqlen/min:29833.000 - global_seqlen/max:29833.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29833.000 - global_seqlen/balanced_max:29833.000 - global_seqlen/mean:29833.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.085 - critic/grad_norm:4.345 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.172 - actor/pg_clipfrac:0.132 - actor/ppo_kl:-0.177 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.671 - actor/grad_norm:5.657 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.083 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.013 - critic/advantages/max:3.533 - critic/advantages/min:-6.171 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.145 - critic/values/min:-0.029 - critic/vf_explained_var:-1.549 - response_length/mean:233.062 - response_length/max:334.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.526 - timing_s/old_log_prob:4.824 - timing_s/ref:7.330 - timing_s/values:4.077 - timing_s/adv:0.022 - timing_s/update_critic:19.635 - timing_s/update_actor:21.401 - timing_s/step:58.820 - timing_per_token_ms/ref:0.246 - timing_per_token_ms/update_actor:0.717 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.658 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29833.000 - perf/time_per_step:58.820 - perf/throughput:507.189 - timing_s/total:6684.204
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:116 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.516 - global_seqlen/min:29634.000 - global_seqlen/max:29634.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29634.000 - global_seqlen/balanced_max:29634.000 - global_seqlen/mean:29634.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.086 - critic/grad_norm:4.624 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.107 - actor/ppo_kl:0.044 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.650 - actor/grad_norm:27.636 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.083 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:11.811 - critic/advantages/max:13.404 - critic/advantages/min:-3.377 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.013 - critic/values/max:0.141 - critic/values/min:0.000 - critic/vf_explained_var:-131.969 - response_length/mean:231.508 - response_length/max:244.000 - response_length/min:224.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.487 - timing_s/old_log_prob:4.637 - timing_s/ref:7.351 - timing_s/values:4.171 - timing_s/adv:0.010 - timing_s/update_critic:19.812 - timing_s/update_actor:20.045 - timing_s/step:57.517 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/update_actor:0.676 - timing_per_token_ms/values:0.141 - timing_per_token_ms/update_critic:0.669 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:29634.000 - perf/time_per_step:57.517 - perf/throughput:515.225 - timing_s/total:6741.724
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:117 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.469 - global_seqlen/min:29756.000 - global_seqlen/max:29756.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29756.000 - global_seqlen/balanced_max:29756.000 - global_seqlen/mean:29756.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.082 - critic/grad_norm:4.824 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.136 - actor/ppo_kl:0.017 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.712 - actor/grad_norm:80.040 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.090 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.900 - critic/advantages/max:5.663 - critic/advantages/min:-10.555 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.141 - critic/values/min:-0.022 - critic/vf_explained_var:-3.878 - response_length/mean:232.461 - response_length/max:257.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.763 - timing_s/old_log_prob:4.750 - timing_s/ref:7.364 - timing_s/values:4.169 - timing_s/adv:0.017 - timing_s/update_critic:19.061 - timing_s/update_actor:20.514 - timing_s/step:57.643 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.689 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.641 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.059 - perf/total_num_tokens:29756.000 - perf/time_per_step:57.643 - perf/throughput:516.211 - timing_s/total:6799.371
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:118 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.594 - global_seqlen/min:29772.000 - global_seqlen/max:29772.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29772.000 - global_seqlen/balanced_max:29772.000 - global_seqlen/mean:29772.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.085 - critic/grad_norm:4.469 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.104 - actor/pg_clipfrac:0.116 - actor/ppo_kl:0.153 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.660 - actor/grad_norm:2.988 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.095 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.001 - critic/advantages/max:4.626 - critic/advantages/min:-8.537 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.140 - critic/values/min:-0.056 - critic/vf_explained_var:-3.043 - response_length/mean:232.586 - response_length/max:308.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.718 - timing_s/old_log_prob:4.877 - timing_s/ref:7.358 - timing_s/values:4.146 - timing_s/adv:0.021 - timing_s/update_critic:19.107 - timing_s/update_actor:21.079 - timing_s/step:58.310 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.708 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.642 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - perf/total_num_tokens:29772.000 - perf/time_per_step:58.310 - perf/throughput:510.581 - timing_s/total:6857.684
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:119 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.656 - global_seqlen/min:29780.000 - global_seqlen/max:29780.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29780.000 - global_seqlen/balanced_max:29780.000 - global_seqlen/mean:29780.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.088 - critic/grad_norm:4.636 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.151 - actor/ppo_kl:-0.084 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.660 - actor/grad_norm:6.168 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.099 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:10.870 - critic/advantages/max:12.433 - critic/advantages/min:-3.649 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.014 - critic/values/max:0.149 - critic/values/min:-0.000 - critic/vf_explained_var:-143.979 - response_length/mean:232.648 - response_length/max:252.000 - response_length/min:222.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.522 - timing_s/old_log_prob:4.693 - timing_s/ref:7.299 - timing_s/values:4.086 - timing_s/adv:0.017 - timing_s/update_critic:19.246 - timing_s/update_actor:20.392 - timing_s/step:57.258 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.685 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.646 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29780.000 - perf/time_per_step:57.258 - perf/throughput:520.099 - timing_s/total:6914.946
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.267794132232666 seconds
[36m(TaskRunner pid=850907)[0m step:120 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.250 - global_seqlen/min:29600.000 - global_seqlen/max:29600.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29600.000 - global_seqlen/balanced_max:29600.000 - global_seqlen/mean:29600.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.088 - critic/grad_norm:4.685 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.026 - actor/pg_clipfrac:0.164 - actor/ppo_kl:-0.133 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.646 - actor/grad_norm:9.881 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:406.102 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:1.000 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:27.291 - val-core/unknown/reward/mean@512:0.173 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.302 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.015 - val-aux/unknown/reward/worst@4/std:0.036 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:0.002 - val-aux/unknown/reward/worst@8/std:0.014 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.003 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:12.119 - critic/advantages/max:13.738 - critic/advantages/min:-3.556 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.014 - critic/values/max:0.146 - critic/values/min:0.000 - critic/vf_explained_var:-138.735 - response_length/mean:231.242 - response_length/max:247.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.528 - timing_s/old_log_prob:4.682 - timing_s/ref:7.366 - timing_s/values:4.175 - timing_s/adv:0.016 - timing_s/update_critic:19.156 - timing_s/update_actor:20.641 - timing_s/testing:3.583 - timing_s/step:61.151 - timing_per_token_ms/ref:0.249 - timing_per_token_ms/update_actor:0.697 - timing_per_token_ms/values:0.141 - timing_per_token_ms/update_critic:0.647 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:29600.000 - perf/time_per_step:61.151 - perf/throughput:484.048 - timing_s/total:6976.100
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:121 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.242 - global_seqlen/min:29727.000 - global_seqlen/max:29727.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29727.000 - global_seqlen/balanced_max:29727.000 - global_seqlen/mean:29727.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.086 - critic/grad_norm:4.653 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.139 - actor/ppo_kl:0.086 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.630 - actor/grad_norm:9.647 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.328 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:11.662 - critic/advantages/max:13.277 - critic/advantages/min:-3.761 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.014 - critic/values/max:0.148 - critic/values/min:0.000 - critic/vf_explained_var:-142.844 - response_length/mean:232.234 - response_length/max:247.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.476 - timing_s/old_log_prob:4.679 - timing_s/ref:7.340 - timing_s/values:4.150 - timing_s/adv:0.013 - timing_s/update_critic:18.754 - timing_s/update_actor:20.522 - timing_s/step:56.938 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.690 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.631 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:29727.000 - perf/time_per_step:56.938 - perf/throughput:522.093 - timing_s/total:7033.041
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:122 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.336 - global_seqlen/min:29611.000 - global_seqlen/max:29611.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29611.000 - global_seqlen/balanced_max:29611.000 - global_seqlen/mean:29611.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.084 - critic/grad_norm:4.620 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.105 - actor/ppo_kl:0.033 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.743 - actor/grad_norm:25.634 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.395 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:11.251 - critic/advantages/max:12.759 - critic/advantages/min:-3.934 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.013 - critic/values/max:0.146 - critic/values/min:0.000 - critic/vf_explained_var:-130.545 - response_length/mean:231.328 - response_length/max:242.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.557 - timing_s/old_log_prob:4.807 - timing_s/ref:7.394 - timing_s/values:4.105 - timing_s/adv:0.016 - timing_s/update_critic:19.269 - timing_s/update_actor:20.443 - timing_s/step:57.594 - timing_per_token_ms/ref:0.250 - timing_per_token_ms/update_actor:0.690 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.651 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:29611.000 - perf/time_per_step:57.594 - perf/throughput:514.132 - timing_s/total:7090.638
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:123 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.016 - global_seqlen/min:29698.000 - global_seqlen/max:29698.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29698.000 - global_seqlen/balanced_max:29698.000 - global_seqlen/mean:29698.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.082 - critic/grad_norm:4.642 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.097 - actor/ppo_kl:-0.019 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.701 - actor/grad_norm:15.299 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.393 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:12.004 - critic/advantages/max:13.652 - critic/advantages/min:-3.600 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.013 - critic/values/max:0.139 - critic/values/min:0.000 - critic/vf_explained_var:-127.636 - response_length/mean:232.008 - response_length/max:244.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.518 - timing_s/old_log_prob:4.713 - timing_s/ref:7.382 - timing_s/values:4.178 - timing_s/adv:0.016 - timing_s/update_critic:19.024 - timing_s/update_actor:20.232 - timing_s/step:57.067 - timing_per_token_ms/ref:0.249 - timing_per_token_ms/update_actor:0.681 - timing_per_token_ms/values:0.141 - timing_per_token_ms/update_critic:0.641 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29698.000 - perf/time_per_step:57.067 - perf/throughput:520.409 - timing_s/total:7147.708
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:124 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:26.453 - global_seqlen/min:29498.000 - global_seqlen/max:29498.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29498.000 - global_seqlen/balanced_max:29498.000 - global_seqlen/mean:29498.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.096 - critic/grad_norm:6.285 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.142 - actor/ppo_kl:-0.036 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.752 - actor/grad_norm:22.866 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.415 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:10.850 - critic/advantages/max:12.257 - critic/advantages/min:-3.401 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.012 - critic/values/max:0.136 - critic/values/min:0.000 - critic/vf_explained_var:-114.594 - response_length/mean:230.445 - response_length/max:244.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.500 - timing_s/old_log_prob:4.685 - timing_s/ref:7.335 - timing_s/values:4.109 - timing_s/adv:0.007 - timing_s/update_critic:19.542 - timing_s/update_actor:20.155 - timing_s/step:57.337 - timing_per_token_ms/ref:0.249 - timing_per_token_ms/update_actor:0.683 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.663 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29498.000 - perf/time_per_step:57.337 - perf/throughput:514.466 - timing_s/total:7205.049
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:125 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.234 - global_seqlen/min:29726.000 - global_seqlen/max:29726.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29726.000 - global_seqlen/balanced_max:29726.000 - global_seqlen/mean:29726.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.081 - critic/grad_norm:8.265 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.092 - actor/ppo_kl:0.067 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.739 - actor/grad_norm:8.269 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.452 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.469 - critic/advantages/max:3.777 - critic/advantages/min:-11.025 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.004 - critic/values/max:0.066 - critic/values/min:-0.040 - critic/vf_explained_var:-0.359 - response_length/mean:232.227 - response_length/max:252.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.768 - timing_s/old_log_prob:4.706 - timing_s/ref:7.352 - timing_s/values:4.145 - timing_s/adv:0.017 - timing_s/update_critic:18.935 - timing_s/update_actor:20.678 - timing_s/step:57.605 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.696 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.637 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.059 - perf/total_num_tokens:29726.000 - perf/time_per_step:57.605 - perf/throughput:516.030 - timing_s/total:7262.657
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:126 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:27.172 - global_seqlen/min:29590.000 - global_seqlen/max:29590.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29590.000 - global_seqlen/balanced_max:29590.000 - global_seqlen/mean:29590.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.092 - critic/grad_norm:8.679 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.115 - actor/ppo_kl:0.058 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.611 - actor/grad_norm:9.342 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.464 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:16.543 - critic/advantages/max:18.746 - critic/advantages/min:-3.063 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.019 - critic/values/max:0.189 - critic/values/min:0.000 - critic/vf_explained_var:-274.953 - response_length/mean:231.164 - response_length/max:245.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.574 - timing_s/old_log_prob:4.678 - timing_s/ref:7.341 - timing_s/values:4.109 - timing_s/adv:0.016 - timing_s/update_critic:19.134 - timing_s/update_actor:20.430 - timing_s/step:57.285 - timing_per_token_ms/ref:0.248 - timing_per_token_ms/update_actor:0.690 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.647 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:29590.000 - perf/time_per_step:57.285 - perf/throughput:516.541 - timing_s/total:7319.946
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:127 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:28.859 - global_seqlen/min:29806.000 - global_seqlen/max:29806.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29806.000 - global_seqlen/balanced_max:29806.000 - global_seqlen/mean:29806.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.096 - critic/grad_norm:7.938 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.139 - actor/ppo_kl:0.058 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.608 - actor/grad_norm:60.665 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.457 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:5.172 - critic/advantages/max:5.904 - critic/advantages/min:-3.261 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.007 - critic/values/max:0.083 - critic/values/min:0.000 - critic/vf_explained_var:-31.061 - response_length/mean:232.852 - response_length/max:246.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.574 - timing_s/old_log_prob:4.730 - timing_s/ref:7.350 - timing_s/values:4.156 - timing_s/adv:0.017 - timing_s/update_critic:19.279 - timing_s/update_actor:20.435 - timing_s/step:57.544 - timing_per_token_ms/ref:0.247 - timing_per_token_ms/update_actor:0.686 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.647 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.053 - perf/total_num_tokens:29806.000 - perf/time_per_step:57.544 - perf/throughput:517.971 - timing_s/total:7377.493
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:128 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.039 - global_seqlen/min:30085.000 - global_seqlen/max:30085.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30085.000 - global_seqlen/balanced_max:30085.000 - global_seqlen/mean:30085.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.079 - critic/grad_norm:8.541 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.141 - actor/ppo_kl:0.093 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.635 - actor/grad_norm:22.370 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.477 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.872 - critic/advantages/max:7.699 - critic/advantages/min:-3.287 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.005 - critic/values/max:0.070 - critic/values/min:-0.029 - critic/vf_explained_var:-18.597 - response_length/mean:235.023 - response_length/max:248.000 - response_length/min:226.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.654 - timing_s/old_log_prob:4.743 - timing_s/ref:7.379 - timing_s/values:4.112 - timing_s/adv:0.016 - timing_s/update_critic:19.336 - timing_s/update_actor:20.098 - timing_s/step:57.342 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.668 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.643 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30085.000 - perf/time_per_step:57.342 - perf/throughput:524.662 - timing_s/total:7434.838
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:129 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.477 - global_seqlen/min:29885.000 - global_seqlen/max:29885.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29885.000 - global_seqlen/balanced_max:29885.000 - global_seqlen/mean:29885.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.081 - critic/grad_norm:8.412 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.104 - actor/ppo_kl:0.139 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.694 - actor/grad_norm:9.226 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.497 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:16.771 - critic/advantages/max:19.195 - critic/advantages/min:-3.361 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.019 - critic/values/max:0.180 - critic/values/min:0.000 - critic/vf_explained_var:-257.760 - response_length/mean:233.461 - response_length/max:244.000 - response_length/min:225.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.486 - timing_s/old_log_prob:4.669 - timing_s/ref:7.320 - timing_s/values:4.174 - timing_s/adv:0.016 - timing_s/update_critic:19.087 - timing_s/update_actor:19.951 - timing_s/step:56.706 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.668 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.639 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:29885.000 - perf/time_per_step:56.706 - perf/throughput:527.012 - timing_s/total:7491.548
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.321732759475708 seconds
[36m(TaskRunner pid=850907)[0m step:130 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.445 - global_seqlen/min:30009.000 - global_seqlen/max:30009.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30009.000 - global_seqlen/balanced_max:30009.000 - global_seqlen/mean:30009.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:7.592 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.100 - actor/ppo_kl:-0.085 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.729 - actor/grad_norm:13.896 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.515 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:1.000 - val-env/Bandit/action_is_effective:1.000 - val-env/Bandit/action_is_valid:1.000 - val-env/BanditTest/success:1.000 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:31.258 - val-core/unknown/reward/mean@512:0.173 - val-aux/unknown/reward/std@512:0.313 - val-aux/unknown/reward/best@2/mean:0.302 - val-aux/unknown/reward/best@2/std:0.393 - val-aux/unknown/reward/worst@2/mean:0.054 - val-aux/unknown/reward/worst@2/std:0.130 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.443 - val-aux/unknown/reward/worst@4/mean:0.015 - val-aux/unknown/reward/worst@4/std:0.036 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:0.002 - val-aux/unknown/reward/worst@8/std:0.014 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:0.000 - val-aux/unknown/reward/worst@16/std:0.003 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:0.000 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:0.000 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:0.000 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:0.000 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:4.659 - critic/advantages/max:5.370 - critic/advantages/min:-3.379 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.006 - critic/values/max:0.070 - critic/values/min:-0.000 - critic/vf_explained_var:-20.841 - response_length/mean:234.438 - response_length/max:249.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.769 - timing_s/old_log_prob:4.694 - timing_s/ref:7.336 - timing_s/values:4.111 - timing_s/adv:0.016 - timing_s/update_critic:19.043 - timing_s/update_actor:20.079 - timing_s/testing:3.655 - timing_s/step:60.707 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.669 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.635 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.059 - perf/total_num_tokens:30009.000 - perf/time_per_step:60.707 - perf/throughput:494.324 - timing_s/total:7552.257
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:131 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.102 - global_seqlen/min:30221.000 - global_seqlen/max:30221.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30221.000 - global_seqlen/balanced_max:30221.000 - global_seqlen/mean:30221.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.070 - critic/grad_norm:8.428 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.081 - actor/ppo_kl:0.198 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.697 - actor/grad_norm:14.737 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.530 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.558 - critic/advantages/max:9.234 - critic/advantages/min:-3.334 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.004 - critic/values/max:0.058 - critic/values/min:-0.040 - critic/vf_explained_var:-11.724 - response_length/mean:236.086 - response_length/max:251.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.388 - timing_s/old_log_prob:4.723 - timing_s/ref:7.361 - timing_s/values:4.198 - timing_s/adv:0.017 - timing_s/update_critic:18.333 - timing_s/update_actor:19.550 - timing_s/step:55.574 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.647 - timing_per_token_ms/values:0.139 - timing_per_token_ms/update_critic:0.607 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:30221.000 - perf/time_per_step:55.574 - perf/throughput:543.800 - timing_s/total:7607.834
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:132 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:29.797 - global_seqlen/min:29926.000 - global_seqlen/max:29926.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29926.000 - global_seqlen/balanced_max:29926.000 - global_seqlen/mean:29926.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.073 - critic/grad_norm:8.202 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.117 - actor/ppo_kl:0.067 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.775 - actor/grad_norm:11.509 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.522 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:16.441 - critic/advantages/max:18.843 - critic/advantages/min:-3.370 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.018 - critic/values/max:0.169 - critic/values/min:0.000 - critic/vf_explained_var:-228.143 - response_length/mean:233.789 - response_length/max:245.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.538 - timing_s/old_log_prob:4.674 - timing_s/ref:7.328 - timing_s/values:4.138 - timing_s/adv:0.016 - timing_s/update_critic:19.153 - timing_s/update_actor:20.158 - timing_s/step:57.008 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.674 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.640 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:29926.000 - perf/time_per_step:57.008 - perf/throughput:524.940 - timing_s/total:7664.846
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:133 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.562 - global_seqlen/min:30024.000 - global_seqlen/max:30024.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30024.000 - global_seqlen/balanced_max:30024.000 - global_seqlen/mean:30024.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.079 - critic/grad_norm:7.479 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.112 - actor/ppo_kl:-0.047 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.790 - actor/grad_norm:7.389 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.530 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.799 - critic/advantages/max:2.154 - critic/advantages/min:-11.641 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.005 - critic/values/max:0.064 - critic/values/min:0.000 - critic/vf_explained_var:-0.511 - response_length/mean:234.547 - response_length/max:250.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.522 - timing_s/old_log_prob:4.678 - timing_s/ref:7.353 - timing_s/values:4.058 - timing_s/adv:0.017 - timing_s/update_critic:18.832 - timing_s/update_actor:20.266 - timing_s/step:56.729 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.675 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.627 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30024.000 - perf/time_per_step:56.729 - perf/throughput:529.252 - timing_s/total:7721.578
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:134 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.266 - global_seqlen/min:30114.000 - global_seqlen/max:30114.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30114.000 - global_seqlen/balanced_max:30114.000 - global_seqlen/mean:30114.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.068 - critic/grad_norm:8.166 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.122 - actor/pg_clipfrac:0.122 - actor/ppo_kl:-0.246 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.793 - actor/grad_norm:4.921 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.532 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.864 - critic/advantages/max:1.256 - critic/advantages/min:-8.102 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.003 - critic/values/max:0.060 - critic/values/min:-0.092 - critic/vf_explained_var:-0.044 - response_length/mean:235.258 - response_length/max:331.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.547 - timing_s/old_log_prob:4.814 - timing_s/ref:7.336 - timing_s/values:4.118 - timing_s/adv:0.021 - timing_s/update_critic:19.391 - timing_s/update_actor:20.966 - timing_s/step:58.196 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.696 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.644 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30114.000 - perf/time_per_step:58.196 - perf/throughput:517.458 - timing_s/total:7779.777
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:135 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:30.492 - global_seqlen/min:30015.000 - global_seqlen/max:30015.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30015.000 - global_seqlen/balanced_max:30015.000 - global_seqlen/mean:30015.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.079 - critic/grad_norm:7.930 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.097 - actor/ppo_kl:0.147 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.759 - actor/grad_norm:23.346 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.523 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:15.343 - critic/advantages/max:17.636 - critic/advantages/min:-3.907 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.019 - critic/values/max:0.178 - critic/values/min:0.000 - critic/vf_explained_var:-239.397 - response_length/mean:234.484 - response_length/max:266.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.485 - timing_s/old_log_prob:4.747 - timing_s/ref:7.315 - timing_s/values:4.201 - timing_s/adv:0.018 - timing_s/update_critic:18.722 - timing_s/update_actor:20.525 - timing_s/step:57.017 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.684 - timing_per_token_ms/values:0.140 - timing_per_token_ms/update_critic:0.624 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:30015.000 - perf/time_per_step:57.017 - perf/throughput:526.419 - timing_s/total:7836.797
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:136 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.102 - global_seqlen/min:30093.000 - global_seqlen/max:30093.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30093.000 - global_seqlen/balanced_max:30093.000 - global_seqlen/mean:30093.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.085 - critic/grad_norm:7.041 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.116 - actor/ppo_kl:-0.206 - actor/pg_clipfrac_lower:0.011 - actor/entropy_loss:0.710 - actor/grad_norm:12.262 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.529 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:5.102 - critic/advantages/max:5.880 - critic/advantages/min:-3.809 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.006 - critic/values/max:0.076 - critic/values/min:0.000 - critic/vf_explained_var:-24.346 - response_length/mean:235.094 - response_length/max:262.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.553 - timing_s/old_log_prob:4.710 - timing_s/ref:7.358 - timing_s/values:4.141 - timing_s/adv:0.017 - timing_s/update_critic:19.386 - timing_s/update_actor:20.374 - timing_s/step:57.543 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.677 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.644 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30093.000 - perf/time_per_step:57.543 - perf/throughput:522.962 - timing_s/total:7894.344
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:137 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.641 - global_seqlen/min:30162.000 - global_seqlen/max:30162.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30162.000 - global_seqlen/balanced_max:30162.000 - global_seqlen/mean:30162.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.068 - critic/grad_norm:8.067 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.091 - actor/ppo_kl:0.090 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.749 - actor/grad_norm:15.046 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.501 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:3.430 - critic/advantages/max:4.184 - critic/advantages/min:-3.844 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.004 - critic/values/max:0.061 - critic/values/min:-0.002 - critic/vf_explained_var:-10.786 - response_length/mean:235.633 - response_length/max:269.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.524 - timing_s/old_log_prob:4.704 - timing_s/ref:7.334 - timing_s/values:4.170 - timing_s/adv:0.018 - timing_s/update_critic:19.053 - timing_s/update_actor:20.277 - timing_s/step:57.085 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.672 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.632 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30162.000 - perf/time_per_step:57.085 - perf/throughput:528.370 - timing_s/total:7951.433
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:138 - train/Bandit/success:0.000 - train/Bandit/num_actions:1.000 - train/Bandit/action_is_effective:1.000 - train/Bandit/action_is_valid:1.000 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.180 - global_seqlen/min:30231.000 - global_seqlen/max:30231.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30231.000 - global_seqlen/balanced_max:30231.000 - global_seqlen/mean:30231.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.094 - critic/grad_norm:7.649 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.123 - actor/ppo_kl:-0.160 - actor/pg_clipfrac_lower:0.007 - actor/entropy_loss:0.721 - actor/grad_norm:9.848 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.533 - actor/lr:0.000 - critic/score/mean:0.100 - critic/score/max:0.100 - critic/score/min:0.100 - critic/rewards/mean:0.100 - critic/rewards/max:0.100 - critic/rewards/min:0.100 - critic/advantages/mean:14.759 - critic/advantages/max:20.247 - critic/advantages/min:-3.857 - critic/returns/mean:0.100 - critic/returns/max:0.100 - critic/returns/min:0.100 - critic/values/mean:0.019 - critic/values/max:0.170 - critic/values/min:-0.026 - critic/vf_explained_var:-226.074 - response_length/mean:236.172 - response_length/max:260.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.656 - timing_s/old_log_prob:4.736 - timing_s/ref:7.305 - timing_s/values:4.007 - timing_s/adv:0.016 - timing_s/update_critic:19.359 - timing_s/update_actor:19.974 - timing_s/step:57.055 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.661 - timing_per_token_ms/values:0.133 - timing_per_token_ms/update_critic:0.640 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.055 - perf/total_num_tokens:30231.000 - perf/time_per_step:57.055 - perf/throughput:529.853 - timing_s/total:8008.492
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:139 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.180 - global_seqlen/min:30103.000 - global_seqlen/max:30103.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30103.000 - global_seqlen/balanced_max:30103.000 - global_seqlen/mean:30103.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.113 - critic/grad_norm:8.177 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.118 - actor/pg_clipfrac:0.120 - actor/ppo_kl:0.045 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.694 - actor/grad_norm:3.464 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.538 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.697 - critic/advantages/max:2.430 - critic/advantages/min:-8.058 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.002 - critic/values/max:0.045 - critic/values/min:-0.095 - critic/vf_explained_var:0.066 - response_length/mean:235.172 - response_length/max:323.000 - response_length/min:221.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.788 - timing_s/old_log_prob:4.811 - timing_s/ref:7.350 - timing_s/values:4.140 - timing_s/adv:0.009 - timing_s/update_critic:18.893 - timing_s/update_actor:20.830 - timing_s/step:57.825 - timing_per_token_ms/ref:0.244 - timing_per_token_ms/update_actor:0.692 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.628 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.059 - perf/total_num_tokens:30103.000 - perf/time_per_step:57.825 - perf/throughput:520.588 - timing_s/total:8066.319
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 2.2248876094818115 seconds
[36m(TaskRunner pid=850907)[0m step:140 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.797 - global_seqlen/min:30310.000 - global_seqlen/max:30310.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30310.000 - global_seqlen/balanced_max:30310.000 - global_seqlen/mean:30310.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.068 - critic/grad_norm:8.619 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.071 - actor/pg_clipfrac:0.135 - actor/ppo_kl:-0.199 - actor/pg_clipfrac_lower:0.006 - actor/entropy_loss:0.744 - actor/grad_norm:15.089 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.541 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.961 - val-env/Bandit/action_is_effective:0.961 - val-env/Bandit/action_is_valid:0.961 - val-env/BanditTest/success:1.000 - val-env/BanditTest/num_actions:1.000 - val-env/BanditTest/action_is_effective:1.000 - val-env/BanditTest/action_is_valid:1.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:33.078 - val-core/unknown/reward/mean@512:0.169 - val-aux/unknown/reward/std@512:0.315 - val-aux/unknown/reward/best@2/mean:0.300 - val-aux/unknown/reward/best@2/std:0.394 - val-aux/unknown/reward/worst@2/mean:0.046 - val-aux/unknown/reward/worst@2/std:0.134 - val-aux/unknown/reward/best@4/mean:0.464 - val-aux/unknown/reward/best@4/std:0.444 - val-aux/unknown/reward/worst@4/mean:0.004 - val-aux/unknown/reward/worst@4/std:0.047 - val-aux/unknown/reward/best@8/mean:0.671 - val-aux/unknown/reward/best@8/std:0.434 - val-aux/unknown/reward/worst@8/mean:-0.014 - val-aux/unknown/reward/worst@8/std:0.039 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:-0.030 - val-aux/unknown/reward/worst@16/std:0.046 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:-0.049 - val-aux/unknown/reward/worst@32/std:0.050 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.074 - val-aux/unknown/reward/worst@64/std:0.044 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.092 - val-aux/unknown/reward/worst@128/std:0.028 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.099 - val-aux/unknown/reward/worst@256/std:0.010 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.092 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.092 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.388 - critic/advantages/max:4.115 - critic/advantages/min:-4.950 - critic/returns/mean:0.091 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.022 - critic/values/max:0.195 - critic/values/min:0.000 - critic/vf_explained_var:-1.905 - response_length/mean:236.789 - response_length/max:331.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.894 - timing_s/old_log_prob:4.882 - timing_s/ref:7.300 - timing_s/values:4.120 - timing_s/adv:0.022 - timing_s/update_critic:19.110 - timing_s/update_actor:20.931 - timing_s/testing:2.577 - timing_s/step:60.841 - timing_per_token_ms/ref:0.241 - timing_per_token_ms/update_actor:0.691 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.630 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.062 - perf/total_num_tokens:30310.000 - perf/time_per_step:60.841 - perf/throughput:498.187 - timing_s/total:8127.162
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:141 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:31.789 - global_seqlen/min:30181.000 - global_seqlen/max:30181.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30181.000 - global_seqlen/balanced_max:30181.000 - global_seqlen/mean:30181.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.115 - critic/grad_norm:8.676 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.139 - actor/ppo_kl:-0.079 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.706 - actor/grad_norm:37.725 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.551 - actor/lr:0.000 - critic/score/mean:0.083 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.083 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.250 - critic/advantages/max:1.780 - critic/advantages/min:-4.101 - critic/returns/mean:0.082 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.010 - critic/values/max:0.106 - critic/values/min:-0.163 - critic/vf_explained_var:-0.150 - response_length/mean:235.781 - response_length/max:334.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.572 - timing_s/old_log_prob:4.827 - timing_s/ref:7.313 - timing_s/values:4.117 - timing_s/adv:0.022 - timing_s/update_critic:18.520 - timing_s/update_actor:20.677 - timing_s/step:57.052 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.685 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.614 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30181.000 - perf/time_per_step:57.052 - perf/throughput:529.011 - timing_s/total:8184.217
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:142 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.914 - train/Bandit/action_is_effective:0.914 - train/Bandit/action_is_valid:0.914 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:34.703 - global_seqlen/min:30554.000 - global_seqlen/max:30554.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30554.000 - global_seqlen/balanced_max:30554.000 - global_seqlen/mean:30554.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.071 - critic/grad_norm:12.272 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.101 - actor/pg_clipfrac:0.106 - actor/ppo_kl:-0.092 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.647 - actor/grad_norm:3.326 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.601 - actor/lr:0.000 - critic/score/mean:0.083 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.083 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.949 - critic/advantages/max:1.365 - critic/advantages/min:-4.876 - critic/returns/mean:0.080 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.011 - critic/values/max:-0.000 - critic/values/min:-0.287 - critic/vf_explained_var:0.068 - response_length/mean:238.695 - response_length/max:329.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.484 - timing_s/old_log_prob:4.808 - timing_s/ref:7.329 - timing_s/values:4.103 - timing_s/adv:0.022 - timing_s/update_critic:18.773 - timing_s/update_actor:20.599 - timing_s/step:57.120 - timing_per_token_ms/ref:0.240 - timing_per_token_ms/update_actor:0.674 - timing_per_token_ms/values:0.134 - timing_per_token_ms/update_critic:0.614 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:30554.000 - perf/time_per_step:57.120 - perf/throughput:534.907 - timing_s/total:8241.340
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:143 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.531 - train/Bandit/action_is_effective:0.531 - train/Bandit/action_is_valid:0.531 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:51.562 - global_seqlen/min:32712.000 - global_seqlen/max:32712.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32712.000 - global_seqlen/balanced_max:32712.000 - global_seqlen/mean:32712.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.004 - critic/grad_norm:9.944 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.178 - actor/pg_clipfrac:0.107 - actor/ppo_kl:-0.002 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.610 - actor/grad_norm:25.464 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.604 - actor/lr:0.000 - critic/score/mean:0.006 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.006 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.356 - critic/advantages/max:2.045 - critic/advantages/min:-1.889 - critic/returns/mean:-0.002 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.015 - critic/values/max:0.010 - critic/values/min:-0.303 - critic/vf_explained_var:0.060 - response_length/mean:255.539 - response_length/max:336.000 - response_length/min:228.000 - response_length/clip_ratio:0.055 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.556 - timing_s/old_log_prob:4.828 - timing_s/ref:7.353 - timing_s/values:4.152 - timing_s/adv:0.010 - timing_s/update_critic:19.164 - timing_s/update_actor:20.820 - timing_s/step:57.886 - timing_per_token_ms/ref:0.225 - timing_per_token_ms/update_actor:0.636 - timing_per_token_ms/values:0.127 - timing_per_token_ms/update_critic:0.586 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.048 - perf/total_num_tokens:32712.000 - perf/time_per_step:57.886 - perf/throughput:565.109 - timing_s/total:8299.230
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:144 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.844 - train/Bandit/action_is_effective:0.844 - train/Bandit/action_is_valid:0.844 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:43.516 - global_seqlen/min:31682.000 - global_seqlen/max:31682.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31682.000 - global_seqlen/balanced_max:31682.000 - global_seqlen/mean:31682.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.061 - critic/grad_norm:11.661 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.351 - actor/pg_clipfrac:0.108 - actor/ppo_kl:-0.056 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.609 - actor/grad_norm:7.634 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.608 - actor/lr:0.000 - critic/score/mean:0.069 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.069 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.383 - critic/advantages/max:2.167 - critic/advantages/min:-3.007 - critic/returns/mean:0.061 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.011 - critic/values/max:0.153 - critic/values/min:-0.119 - critic/vf_explained_var:-0.070 - response_length/mean:247.477 - response_length/max:336.000 - response_length/min:223.000 - response_length/clip_ratio:0.047 - prompt_length/mean:0.039 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.039 - timing_s/gen:1.517 - timing_s/old_log_prob:4.813 - timing_s/ref:7.324 - timing_s/values:4.105 - timing_s/adv:0.022 - timing_s/update_critic:19.120 - timing_s/update_actor:20.687 - timing_s/step:57.591 - timing_per_token_ms/ref:0.231 - timing_per_token_ms/update_actor:0.653 - timing_per_token_ms/values:0.130 - timing_per_token_ms/update_critic:0.603 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.048 - perf/total_num_tokens:31682.000 - perf/time_per_step:57.591 - perf/throughput:550.119 - timing_s/total:8356.824
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:145 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.961 - train/Bandit/action_is_effective:0.961 - train/Bandit/action_is_valid:0.961 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:35.156 - global_seqlen/min:30612.000 - global_seqlen/max:30612.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30612.000 - global_seqlen/balanced_max:30612.000 - global_seqlen/mean:30612.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:11.999 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.131 - actor/pg_clipfrac:0.120 - actor/ppo_kl:-0.031 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.633 - actor/grad_norm:2.495 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.610 - actor/lr:0.000 - critic/score/mean:0.092 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.092 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.126 - critic/advantages/max:3.891 - critic/advantages/min:-6.249 - critic/returns/mean:0.090 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.017 - critic/values/max:0.158 - critic/values/min:-0.079 - critic/vf_explained_var:-0.845 - response_length/mean:239.148 - response_length/max:332.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.492 - timing_s/old_log_prob:4.845 - timing_s/ref:7.270 - timing_s/values:4.193 - timing_s/adv:0.016 - timing_s/update_critic:19.359 - timing_s/update_actor:21.000 - timing_s/step:58.179 - timing_per_token_ms/ref:0.237 - timing_per_token_ms/update_actor:0.686 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.632 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:30612.000 - perf/time_per_step:58.179 - perf/throughput:526.165 - timing_s/total:8415.006
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:146 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.125 - global_seqlen/min:30352.000 - global_seqlen/max:30352.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30352.000 - global_seqlen/balanced_max:30352.000 - global_seqlen/mean:30352.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.092 - critic/grad_norm:11.635 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.085 - actor/pg_clipfrac:0.095 - actor/ppo_kl:-0.149 - actor/pg_clipfrac_lower:0.012 - actor/entropy_loss:0.549 - actor/grad_norm:8.217 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.576 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:6.402 - critic/advantages/max:7.530 - critic/advantages/min:-12.373 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.018 - critic/values/max:0.160 - critic/values/min:-0.056 - critic/vf_explained_var:-4.741 - response_length/mean:237.117 - response_length/max:309.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.567 - timing_s/old_log_prob:4.829 - timing_s/ref:7.380 - timing_s/values:4.112 - timing_s/adv:0.020 - timing_s/update_critic:19.174 - timing_s/update_actor:20.613 - timing_s/step:57.699 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.679 - timing_per_token_ms/values:0.135 - timing_per_token_ms/update_critic:0.632 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30352.000 - perf/time_per_step:57.699 - perf/throughput:526.038 - timing_s/total:8472.709
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:147 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.750 - global_seqlen/min:30304.000 - global_seqlen/max:30304.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30304.000 - global_seqlen/balanced_max:30304.000 - global_seqlen/mean:30304.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.087 - critic/grad_norm:11.333 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.061 - actor/pg_clipfrac:0.107 - actor/ppo_kl:0.242 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.583 - actor/grad_norm:5.576 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.559 - actor/lr:0.000 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:7.398 - critic/advantages/max:8.692 - critic/advantages/min:-14.343 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.017 - critic/values/max:0.156 - critic/values/min:-0.070 - critic/vf_explained_var:-4.115 - response_length/mean:236.742 - response_length/max:321.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.579 - timing_s/old_log_prob:4.863 - timing_s/ref:7.427 - timing_s/values:4.188 - timing_s/adv:0.009 - timing_s/update_critic:19.083 - timing_s/update_actor:20.464 - timing_s/step:57.616 - timing_per_token_ms/ref:0.245 - timing_per_token_ms/update_actor:0.675 - timing_per_token_ms/values:0.138 - timing_per_token_ms/update_critic:0.630 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:30304.000 - perf/time_per_step:57.616 - perf/throughput:525.962 - timing_s/total:8530.329
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:148 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.984 - train/Bandit/action_is_effective:0.984 - train/Bandit/action_is_valid:0.984 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:32.578 - global_seqlen/min:30282.000 - global_seqlen/max:30282.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30282.000 - global_seqlen/balanced_max:30282.000 - global_seqlen/mean:30282.000 - critic/vf_loss:0.003 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.081 - critic/grad_norm:11.364 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.103 - actor/pg_clipfrac:0.088 - actor/ppo_kl:-0.127 - actor/pg_clipfrac_lower:0.024 - actor/entropy_loss:0.670 - actor/grad_norm:4.682 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.566 - actor/lr:0.000 - critic/score/mean:0.097 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.097 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.406 - critic/advantages/max:5.243 - critic/advantages/min:-8.973 - critic/returns/mean:0.096 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.016 - critic/values/max:0.157 - critic/values/min:-0.060 - critic/vf_explained_var:-1.908 - response_length/mean:236.570 - response_length/max:321.000 - response_length/min:228.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.531 - timing_s/old_log_prob:4.845 - timing_s/ref:7.355 - timing_s/values:4.142 - timing_s/adv:0.021 - timing_s/update_critic:19.305 - timing_s/update_actor:20.667 - timing_s/step:57.871 - timing_per_token_ms/ref:0.243 - timing_per_token_ms/update_actor:0.683 - timing_per_token_ms/values:0.137 - timing_per_token_ms/update_critic:0.638 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.051 - perf/total_num_tokens:30282.000 - perf/time_per_step:57.871 - perf/throughput:523.263 - timing_s/total:8588.204
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:149 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.812 - train/Bandit/action_is_effective:0.812 - train/Bandit/action_is_valid:0.812 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:45.906 - global_seqlen/min:31988.000 - global_seqlen/max:31988.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:31988.000 - global_seqlen/balanced_max:31988.000 - global_seqlen/mean:31988.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.055 - critic/grad_norm:12.419 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.382 - actor/pg_clipfrac:0.126 - actor/ppo_kl:0.003 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.573 - actor/grad_norm:3.852 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.550 - actor/lr:0.000 - critic/score/mean:0.062 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.062 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.542 - critic/advantages/max:2.469 - critic/advantages/min:-2.751 - critic/returns/mean:0.053 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.013 - critic/values/max:0.142 - critic/values/min:-0.080 - critic/vf_explained_var:-0.110 - response_length/mean:249.891 - response_length/max:325.000 - response_length/min:227.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.527 - timing_s/old_log_prob:4.772 - timing_s/ref:7.335 - timing_s/values:4.098 - timing_s/adv:0.021 - timing_s/update_critic:19.014 - timing_s/update_actor:20.778 - timing_s/step:57.549 - timing_per_token_ms/ref:0.229 - timing_per_token_ms/update_actor:0.650 - timing_per_token_ms/values:0.128 - timing_per_token_ms/update_critic:0.594 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.048 - perf/total_num_tokens:31988.000 - perf/time_per_step:57.549 - perf/throughput:555.839 - timing_s/total:8645.756
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.12465238571167 seconds
[36m(TaskRunner pid=850907)[0m step:150 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.992 - train/Bandit/action_is_effective:0.992 - train/Bandit/action_is_valid:0.992 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:33.586 - global_seqlen/min:30411.000 - global_seqlen/max:30411.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:30411.000 - global_seqlen/balanced_max:30411.000 - global_seqlen/mean:30411.000 - critic/vf_loss:0.004 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.093 - critic/grad_norm:11.608 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.085 - actor/ppo_kl:-0.100 - actor/pg_clipfrac_lower:0.011 - actor/entropy_loss:0.562 - actor/grad_norm:5.088 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.578 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.633 - val-env/Bandit/action_is_effective:0.633 - val-env/Bandit/action_is_valid:0.633 - val-env/BanditTest/success:0.992 - val-env/BanditTest/num_actions:0.992 - val-env/BanditTest/action_is_effective:0.992 - val-env/BanditTest/action_is_valid:0.992 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:47.268 - val-core/unknown/reward/mean@512:0.136 - val-aux/unknown/reward/std@512:0.331 - val-aux/unknown/reward/best@2/mean:0.280 - val-aux/unknown/reward/best@2/std:0.407 - val-aux/unknown/reward/worst@2/mean:-0.004 - val-aux/unknown/reward/worst@2/std:0.146 - val-aux/unknown/reward/best@4/mean:0.456 - val-aux/unknown/reward/best@4/std:0.451 - val-aux/unknown/reward/worst@4/mean:-0.053 - val-aux/unknown/reward/worst@4/std:0.056 - val-aux/unknown/reward/best@8/mean:0.670 - val-aux/unknown/reward/best@8/std:0.435 - val-aux/unknown/reward/worst@8/mean:-0.080 - val-aux/unknown/reward/worst@8/std:0.040 - val-aux/unknown/reward/best@16/mean:0.888 - val-aux/unknown/reward/best@16/std:0.298 - val-aux/unknown/reward/worst@16/mean:-0.096 - val-aux/unknown/reward/worst@16/std:0.020 - val-aux/unknown/reward/best@32/mean:0.987 - val-aux/unknown/reward/best@32/std:0.109 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.003 - val-aux/unknown/reward/best@64/mean:1.000 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:1.000 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:1.000 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:6.898 - critic/advantages/max:8.141 - critic/advantages/min:-15.790 - critic/returns/mean:0.098 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.016 - critic/values/max:0.146 - critic/values/min:-0.086 - critic/vf_explained_var:-3.742 - response_length/mean:237.578 - response_length/max:306.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.521 - timing_s/old_log_prob:4.804 - timing_s/ref:7.358 - timing_s/values:4.129 - timing_s/adv:0.020 - timing_s/update_critic:19.113 - timing_s/update_actor:20.472 - timing_s/testing:3.442 - timing_s/step:60.862 - timing_per_token_ms/ref:0.242 - timing_per_token_ms/update_actor:0.673 - timing_per_token_ms/values:0.136 - timing_per_token_ms/update_critic:0.628 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.050 - perf/total_num_tokens:30411.000 - perf/time_per_step:60.862 - perf/throughput:499.672 - timing_s/total:8706.621
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:151 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.758 - train/Bandit/action_is_effective:0.758 - train/Bandit/action_is_valid:0.758 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:49.438 - global_seqlen/min:32440.000 - global_seqlen/max:32440.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32440.000 - global_seqlen/balanced_max:32440.000 - global_seqlen/mean:32440.000 - critic/vf_loss:0.008 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.033 - critic/grad_norm:15.443 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.509 - actor/pg_clipfrac:0.143 - actor/ppo_kl:0.018 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.524 - actor/grad_norm:5.940 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.593 - actor/lr:0.000 - critic/score/mean:0.052 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.052 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.321 - critic/advantages/max:3.560 - critic/advantages/min:-2.391 - critic/returns/mean:0.041 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.029 - critic/values/max:0.226 - critic/values/min:0.000 - critic/vf_explained_var:-0.625 - response_length/mean:253.430 - response_length/max:319.000 - response_length/min:225.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.330 - timing_s/old_log_prob:4.769 - timing_s/ref:7.401 - timing_s/values:4.189 - timing_s/adv:0.021 - timing_s/update_critic:18.861 - timing_s/update_actor:21.022 - timing_s/step:57.595 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/update_actor:0.648 - timing_per_token_ms/values:0.129 - timing_per_token_ms/update_critic:0.581 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.041 - perf/total_num_tokens:32440.000 - perf/time_per_step:57.595 - perf/throughput:563.239 - timing_s/total:8764.219
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:152 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.672 - train/Bandit/action_is_effective:0.672 - train/Bandit/action_is_valid:0.672 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:57.250 - global_seqlen/min:33440.000 - global_seqlen/max:33440.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33440.000 - global_seqlen/balanced_max:33440.000 - global_seqlen/mean:33440.000 - critic/vf_loss:0.010 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.080 - critic/grad_norm:17.371 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.595 - actor/pg_clipfrac:0.184 - actor/ppo_kl:0.564 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.433 - actor/grad_norm:8.030 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.581 - actor/lr:0.000 - critic/score/mean:0.034 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.034 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.427 - critic/advantages/max:2.447 - critic/advantages/min:-1.254 - critic/returns/mean:0.022 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.030 - critic/values/max:0.192 - critic/values/min:0.000 - critic/vf_explained_var:-0.655 - response_length/mean:261.242 - response_length/max:321.000 - response_length/min:227.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.739 - timing_s/old_log_prob:4.824 - timing_s/ref:7.344 - timing_s/values:4.089 - timing_s/adv:0.021 - timing_s/update_critic:18.493 - timing_s/update_actor:20.597 - timing_s/step:57.111 - timing_per_token_ms/ref:0.220 - timing_per_token_ms/update_actor:0.616 - timing_per_token_ms/values:0.122 - timing_per_token_ms/update_critic:0.553 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:33440.000 - perf/time_per_step:57.111 - perf/throughput:585.524 - timing_s/total:8821.333
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:153 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.727 - train/Bandit/action_is_effective:0.727 - train/Bandit/action_is_valid:0.727 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:50.680 - global_seqlen/min:32599.000 - global_seqlen/max:32599.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32599.000 - global_seqlen/balanced_max:32599.000 - global_seqlen/mean:32599.000 - critic/vf_loss:0.013 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.036 - critic/grad_norm:19.379 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.536 - actor/pg_clipfrac:0.156 - actor/ppo_kl:0.238 - actor/pg_clipfrac_lower:0.006 - actor/entropy_loss:0.490 - actor/grad_norm:30.156 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.602 - actor/lr:0.000 - critic/score/mean:0.045 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.045 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.058 - critic/advantages/max:1.483 - critic/advantages/min:-1.845 - critic/returns/mean:0.034 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.012 - critic/values/max:-0.000 - critic/values/min:-0.148 - critic/vf_explained_var:0.129 - response_length/mean:254.672 - response_length/max:317.000 - response_length/min:221.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.455 - timing_s/old_log_prob:4.792 - timing_s/ref:7.357 - timing_s/values:4.094 - timing_s/adv:0.021 - timing_s/update_critic:18.610 - timing_s/update_actor:20.546 - timing_s/step:56.878 - timing_per_token_ms/ref:0.226 - timing_per_token_ms/update_actor:0.630 - timing_per_token_ms/values:0.126 - timing_per_token_ms/update_critic:0.571 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:32599.000 - perf/time_per_step:56.878 - perf/throughput:573.136 - timing_s/total:8878.214
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:154 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.367 - train/Bandit/action_is_effective:0.367 - train/Bandit/action_is_valid:0.367 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:76.008 - global_seqlen/min:35841.000 - global_seqlen/max:35841.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35841.000 - global_seqlen/balanced_max:35841.000 - global_seqlen/mean:35841.000 - critic/vf_loss:0.008 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.012 - critic/grad_norm:14.306 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.556 - actor/pg_clipfrac:0.235 - actor/ppo_kl:1.180 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.295 - actor/grad_norm:13.936 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.604 - actor/lr:0.000 - critic/score/mean:-0.027 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.027 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.084 - critic/advantages/max:2.617 - critic/advantages/min:-1.029 - critic/returns/mean:-0.038 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.009 - critic/values/max:0.004 - critic/values/min:-0.074 - critic/vf_explained_var:0.062 - response_length/mean:279.992 - response_length/max:312.000 - response_length/min:229.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.597 - timing_s/old_log_prob:4.797 - timing_s/ref:7.330 - timing_s/values:4.096 - timing_s/adv:0.021 - timing_s/update_critic:19.015 - timing_s/update_actor:20.590 - timing_s/step:57.449 - timing_per_token_ms/ref:0.205 - timing_per_token_ms/update_actor:0.574 - timing_per_token_ms/values:0.114 - timing_per_token_ms/update_critic:0.531 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:35841.000 - perf/time_per_step:57.449 - perf/throughput:623.872 - timing_s/total:8935.667
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:155 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.375 - train/Bandit/action_is_effective:0.375 - train/Bandit/action_is_valid:0.375 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:74.969 - global_seqlen/min:35708.000 - global_seqlen/max:35708.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:35708.000 - global_seqlen/balanced_max:35708.000 - global_seqlen/mean:35708.000 - critic/vf_loss:0.009 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.036 - critic/grad_norm:18.152 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.576 - actor/pg_clipfrac:0.242 - actor/ppo_kl:0.692 - actor/pg_clipfrac_lower:0.011 - actor/entropy_loss:0.310 - actor/grad_norm:4.762 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.614 - actor/lr:0.000 - critic/score/mean:-0.025 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.025 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.088 - critic/advantages/max:2.525 - critic/advantages/min:-1.257 - critic/returns/mean:-0.037 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.014 - critic/values/max:-0.000 - critic/values/min:-0.204 - critic/vf_explained_var:0.073 - response_length/mean:278.961 - response_length/max:311.000 - response_length/min:223.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.549 - timing_s/old_log_prob:4.828 - timing_s/ref:7.369 - timing_s/values:4.157 - timing_s/adv:0.021 - timing_s/update_critic:19.140 - timing_s/update_actor:20.857 - timing_s/step:57.925 - timing_per_token_ms/ref:0.206 - timing_per_token_ms/update_actor:0.584 - timing_per_token_ms/values:0.116 - timing_per_token_ms/update_critic:0.536 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.043 - perf/total_num_tokens:35708.000 - perf/time_per_step:57.925 - perf/throughput:616.457 - timing_s/total:8993.595
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:156 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.500 - train/Bandit/action_is_effective:0.500 - train/Bandit/action_is_valid:0.500 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:67.109 - global_seqlen/min:34702.000 - global_seqlen/max:34702.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34702.000 - global_seqlen/balanced_max:34702.000 - global_seqlen/mean:34702.000 - critic/vf_loss:0.010 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.021 - critic/grad_norm:18.468 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.573 - actor/pg_clipfrac:0.203 - actor/ppo_kl:0.341 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.383 - actor/grad_norm:14.572 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:396.621 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.000 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.790 - critic/advantages/max:5.110 - critic/advantages/min:-1.506 - critic/returns/mean:-0.013 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.052 - critic/values/max:0.273 - critic/values/min:0.000 - critic/vf_explained_var:-1.213 - response_length/mean:271.102 - response_length/max:311.000 - response_length/min:229.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.544 - timing_s/old_log_prob:4.833 - timing_s/ref:7.339 - timing_s/values:4.136 - timing_s/adv:0.020 - timing_s/update_critic:19.223 - timing_s/update_actor:20.528 - timing_s/step:57.626 - timing_per_token_ms/ref:0.211 - timing_per_token_ms/update_actor:0.592 - timing_per_token_ms/values:0.119 - timing_per_token_ms/update_critic:0.554 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:34702.000 - perf/time_per_step:57.626 - perf/throughput:602.193 - timing_s/total:9051.225
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:157 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.750 - train/Bandit/action_is_effective:0.750 - train/Bandit/action_is_valid:0.750 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:49.898 - global_seqlen/min:32499.000 - global_seqlen/max:32499.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32499.000 - global_seqlen/balanced_max:32499.000 - global_seqlen/mean:32499.000 - critic/vf_loss:0.021 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.051 - critic/grad_norm:27.129 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.519 - actor/pg_clipfrac:0.113 - actor/ppo_kl:0.027 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.461 - actor/grad_norm:7.037 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.219 - actor/lr:0.000 - critic/score/mean:0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.704 - critic/advantages/max:2.727 - critic/advantages/min:-1.696 - critic/returns/mean:0.039 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.024 - critic/values/max:0.171 - critic/values/min:0.000 - critic/vf_explained_var:-0.444 - response_length/mean:253.891 - response_length/max:313.000 - response_length/min:226.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.488 - timing_s/old_log_prob:4.842 - timing_s/ref:7.357 - timing_s/values:4.149 - timing_s/adv:0.021 - timing_s/update_critic:19.085 - timing_s/update_actor:20.539 - timing_s/step:57.483 - timing_per_token_ms/ref:0.226 - timing_per_token_ms/update_actor:0.632 - timing_per_token_ms/values:0.128 - timing_per_token_ms/update_critic:0.587 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:32499.000 - perf/time_per_step:57.483 - perf/throughput:565.362 - timing_s/total:9108.712
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:158 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.617 - train/Bandit/action_is_effective:0.617 - train/Bandit/action_is_valid:0.617 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:58.711 - global_seqlen/min:33627.000 - global_seqlen/max:33627.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33627.000 - global_seqlen/balanced_max:33627.000 - global_seqlen/mean:33627.000 - critic/vf_loss:0.018 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.071 - critic/grad_norm:20.874 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.590 - actor/pg_clipfrac:0.162 - actor/ppo_kl:0.196 - actor/pg_clipfrac_lower:0.004 - actor/entropy_loss:0.379 - actor/grad_norm:5.208 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.229 - actor/lr:0.000 - critic/score/mean:0.023 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.023 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.991 - critic/advantages/max:4.832 - critic/advantages/min:-1.404 - critic/returns/mean:0.011 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.054 - critic/values/max:0.291 - critic/values/min:0.000 - critic/vf_explained_var:-1.467 - response_length/mean:262.703 - response_length/max:311.000 - response_length/min:229.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.515 - timing_s/old_log_prob:4.772 - timing_s/ref:7.332 - timing_s/values:4.118 - timing_s/adv:0.021 - timing_s/update_critic:19.363 - timing_s/update_actor:20.476 - timing_s/step:57.599 - timing_per_token_ms/ref:0.218 - timing_per_token_ms/update_actor:0.609 - timing_per_token_ms/values:0.122 - timing_per_token_ms/update_critic:0.576 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:33627.000 - perf/time_per_step:57.599 - perf/throughput:583.815 - timing_s/total:9166.314
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:159 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.492 - train/Bandit/action_is_effective:0.492 - train/Bandit/action_is_valid:0.492 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:67.836 - global_seqlen/min:34795.000 - global_seqlen/max:34795.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34795.000 - global_seqlen/balanced_max:34795.000 - global_seqlen/mean:34795.000 - critic/vf_loss:0.018 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.023 - critic/grad_norm:25.137 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.639 - actor/pg_clipfrac:0.196 - actor/ppo_kl:0.293 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.363 - actor/grad_norm:7.035 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.241 - actor/lr:0.000 - critic/score/mean:-0.002 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.002 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.767 - critic/advantages/max:2.310 - critic/advantages/min:-1.026 - critic/returns/mean:-0.015 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.007 - critic/values/max:0.063 - critic/values/min:-0.006 - critic/vf_explained_var:-0.049 - response_length/mean:271.828 - response_length/max:312.000 - response_length/min:228.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.805 - timing_s/old_log_prob:4.729 - timing_s/ref:7.432 - timing_s/values:4.183 - timing_s/adv:0.021 - timing_s/update_critic:18.664 - timing_s/update_actor:20.544 - timing_s/step:57.380 - timing_per_token_ms/ref:0.214 - timing_per_token_ms/update_actor:0.590 - timing_per_token_ms/values:0.120 - timing_per_token_ms/update_critic:0.536 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:34795.000 - perf/time_per_step:57.380 - perf/throughput:606.393 - timing_s/total:9223.698
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.298022747039795 seconds
[36m(TaskRunner pid=850907)[0m step:160 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.500 - train/Bandit/action_is_effective:0.500 - train/Bandit/action_is_valid:0.500 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:66.828 - global_seqlen/min:34666.000 - global_seqlen/max:34666.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34666.000 - global_seqlen/balanced_max:34666.000 - global_seqlen/mean:34666.000 - critic/vf_loss:0.010 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.041 - critic/grad_norm:18.999 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.599 - actor/pg_clipfrac:0.193 - actor/ppo_kl:0.672 - actor/pg_clipfrac_lower:0.001 - actor/entropy_loss:0.323 - actor/grad_norm:8.628 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.247 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.562 - val-env/Bandit/action_is_effective:0.562 - val-env/Bandit/action_is_valid:0.562 - val-env/BanditTest/success:0.035 - val-env/BanditTest/num_actions:0.035 - val-env/BanditTest/action_is_effective:0.035 - val-env/BanditTest/action_is_valid:0.035 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/BanditTest/non-zero/success:1.000 - val-env/BanditTest/non-zero/num_actions:1.000 - val-env/BanditTest/non-zero/action_is_effective:1.000 - val-env/BanditTest/non-zero/action_is_valid:1.000 - val-env/response_length:79.645 - val-core/unknown/reward/mean@512:-0.036 - val-aux/unknown/reward/std@512:0.120 - val-aux/unknown/reward/best@2/mean:0.003 - val-aux/unknown/reward/best@2/std:0.129 - val-aux/unknown/reward/worst@2/mean:-0.086 - val-aux/unknown/reward/worst@2/std:0.051 - val-aux/unknown/reward/best@4/mean:0.068 - val-aux/unknown/reward/best@4/std:0.161 - val-aux/unknown/reward/worst@4/mean:-0.099 - val-aux/unknown/reward/worst@4/std:0.013 - val-aux/unknown/reward/best@8/mean:0.124 - val-aux/unknown/reward/best@8/std:0.182 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:0.170 - val-aux/unknown/reward/best@16/std:0.242 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.239 - val-aux/unknown/reward/best@32/std:0.325 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.370 - val-aux/unknown/reward/best@64/std:0.412 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.564 - val-aux/unknown/reward/best@128/std:0.450 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:0.771 - val-aux/unknown/reward/best@256/std:0.392 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:1.000 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.000 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.000 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.331 - critic/advantages/max:3.102 - critic/advantages/min:-1.236 - critic/returns/mean:-0.013 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.020 - critic/values/max:0.125 - critic/values/min:0.000 - critic/vf_explained_var:-0.238 - response_length/mean:270.820 - response_length/max:310.000 - response_length/min:226.000 - response_length/clip_ratio:0.031 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.528 - timing_s/old_log_prob:4.799 - timing_s/ref:7.332 - timing_s/values:4.175 - timing_s/adv:0.020 - timing_s/update_critic:18.693 - timing_s/update_actor:20.491 - timing_s/testing:3.615 - timing_s/step:60.657 - timing_per_token_ms/ref:0.212 - timing_per_token_ms/update_actor:0.591 - timing_per_token_ms/values:0.120 - timing_per_token_ms/update_critic:0.539 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:34666.000 - perf/time_per_step:60.657 - perf/throughput:571.505 - timing_s/total:9284.358
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:161 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.500 - train/Bandit/action_is_effective:0.500 - train/Bandit/action_is_valid:0.500 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:65.930 - global_seqlen/min:34551.000 - global_seqlen/max:34551.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34551.000 - global_seqlen/balanced_max:34551.000 - global_seqlen/mean:34551.000 - critic/vf_loss:0.015 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.042 - critic/grad_norm:23.649 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.583 - actor/pg_clipfrac:0.203 - actor/ppo_kl:0.340 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.350 - actor/grad_norm:6.169 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.230 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.000 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.132 - critic/advantages/max:5.537 - critic/advantages/min:-1.360 - critic/returns/mean:-0.013 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.060 - critic/values/max:0.297 - critic/values/min:0.000 - critic/vf_explained_var:-1.553 - response_length/mean:269.922 - response_length/max:309.000 - response_length/min:227.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.372 - timing_s/old_log_prob:4.808 - timing_s/ref:7.332 - timing_s/values:4.107 - timing_s/adv:0.020 - timing_s/update_critic:18.461 - timing_s/update_actor:20.819 - timing_s/step:56.922 - timing_per_token_ms/ref:0.212 - timing_per_token_ms/update_actor:0.603 - timing_per_token_ms/values:0.119 - timing_per_token_ms/update_critic:0.534 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.040 - perf/total_num_tokens:34551.000 - perf/time_per_step:56.922 - perf/throughput:606.987 - timing_s/total:9341.284
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:162 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.617 - train/Bandit/action_is_effective:0.617 - train/Bandit/action_is_valid:0.617 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:57.891 - global_seqlen/min:33522.000 - global_seqlen/max:33522.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33522.000 - global_seqlen/balanced_max:33522.000 - global_seqlen/mean:33522.000 - critic/vf_loss:0.024 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.027 - critic/grad_norm:26.172 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.616 - actor/pg_clipfrac:0.189 - actor/ppo_kl:0.460 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.346 - actor/grad_norm:5.119 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.241 - actor/lr:0.000 - critic/score/mean:0.023 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.023 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.218 - critic/advantages/max:4.930 - critic/advantages/min:-1.052 - critic/returns/mean:0.011 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.075 - critic/values/max:0.373 - critic/values/min:0.000 - critic/vf_explained_var:-2.677 - response_length/mean:261.867 - response_length/max:311.000 - response_length/min:225.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.552 - timing_s/old_log_prob:4.803 - timing_s/ref:7.352 - timing_s/values:4.040 - timing_s/adv:0.020 - timing_s/update_critic:18.939 - timing_s/update_actor:20.358 - timing_s/step:57.068 - timing_per_token_ms/ref:0.219 - timing_per_token_ms/update_actor:0.607 - timing_per_token_ms/values:0.121 - timing_per_token_ms/update_critic:0.565 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:33522.000 - perf/time_per_step:57.068 - perf/throughput:587.407 - timing_s/total:9398.355
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:163 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.500 - train/Bandit/action_is_effective:0.500 - train/Bandit/action_is_valid:0.500 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:65.961 - global_seqlen/min:34555.000 - global_seqlen/max:34555.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34555.000 - global_seqlen/balanced_max:34555.000 - global_seqlen/mean:34555.000 - critic/vf_loss:0.006 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.033 - critic/grad_norm:13.465 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.626 - actor/pg_clipfrac:0.238 - actor/ppo_kl:0.883 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.248 - actor/grad_norm:22.106 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.247 - actor/lr:0.000 - critic/score/mean:-0.000 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.000 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.024 - critic/advantages/max:2.573 - critic/advantages/min:-0.941 - critic/returns/mean:-0.013 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.014 - critic/values/max:0.088 - critic/values/min:0.000 - critic/vf_explained_var:-0.166 - response_length/mean:269.906 - response_length/max:308.000 - response_length/min:225.000 - response_length/clip_ratio:0.117 - prompt_length/mean:0.055 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.055 - timing_s/gen:1.572 - timing_s/old_log_prob:4.772 - timing_s/ref:7.262 - timing_s/values:4.021 - timing_s/adv:0.020 - timing_s/update_critic:18.716 - timing_s/update_actor:20.481 - timing_s/step:56.849 - timing_per_token_ms/ref:0.210 - timing_per_token_ms/update_actor:0.593 - timing_per_token_ms/values:0.116 - timing_per_token_ms/update_critic:0.542 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:34555.000 - perf/time_per_step:56.849 - perf/throughput:607.838 - timing_s/total:9455.207
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:164 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.750 - train/Bandit/action_is_effective:0.750 - train/Bandit/action_is_valid:0.750 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:48.562 - global_seqlen/min:32328.000 - global_seqlen/max:32328.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32328.000 - global_seqlen/balanced_max:32328.000 - global_seqlen/mean:32328.000 - critic/vf_loss:0.039 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.065 - critic/grad_norm:34.232 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.543 - actor/pg_clipfrac:0.182 - actor/ppo_kl:0.806 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.118 - actor/grad_norm:2.183 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.256 - actor/lr:0.000 - critic/score/mean:0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.357 - critic/advantages/max:3.454 - critic/advantages/min:-1.348 - critic/returns/mean:0.040 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.042 - critic/values/max:0.249 - critic/values/min:0.000 - critic/vf_explained_var:-1.287 - response_length/mean:252.555 - response_length/max:308.000 - response_length/min:229.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.490 - timing_s/old_log_prob:4.814 - timing_s/ref:7.341 - timing_s/values:4.113 - timing_s/adv:0.020 - timing_s/update_critic:18.847 - timing_s/update_actor:20.458 - timing_s/step:57.087 - timing_per_token_ms/ref:0.227 - timing_per_token_ms/update_actor:0.633 - timing_per_token_ms/values:0.127 - timing_per_token_ms/update_critic:0.583 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:32328.000 - perf/time_per_step:57.087 - perf/throughput:566.295 - timing_s/total:9512.296
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:165 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.500 - train/Bandit/action_is_effective:0.500 - train/Bandit/action_is_valid:0.500 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:65.359 - global_seqlen/min:34478.000 - global_seqlen/max:34478.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34478.000 - global_seqlen/balanced_max:34478.000 - global_seqlen/mean:34478.000 - critic/vf_loss:0.039 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.043 - critic/grad_norm:34.977 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.626 - actor/pg_clipfrac:0.343 - actor/ppo_kl:0.960 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.095 - actor/grad_norm:1.594 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.264 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.000 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:3.001 - critic/advantages/max:5.177 - critic/advantages/min:-0.906 - critic/returns/mean:-0.012 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.067 - critic/values/max:0.305 - critic/values/min:0.000 - critic/vf_explained_var:-1.921 - response_length/mean:269.242 - response_length/max:305.000 - response_length/min:231.000 - response_length/clip_ratio:0.133 - prompt_length/mean:0.117 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.117 - timing_s/gen:1.543 - timing_s/old_log_prob:4.666 - timing_s/ref:7.242 - timing_s/values:4.078 - timing_s/adv:0.020 - timing_s/update_critic:18.429 - timing_s/update_actor:20.078 - timing_s/step:56.059 - timing_per_token_ms/ref:0.210 - timing_per_token_ms/update_actor:0.582 - timing_per_token_ms/values:0.118 - timing_per_token_ms/update_critic:0.535 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:34478.000 - perf/time_per_step:56.059 - perf/throughput:615.031 - timing_s/total:9568.359
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:166 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.250 - train/Bandit/action_is_effective:0.250 - train/Bandit/action_is_valid:0.250 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:83.867 - global_seqlen/min:36847.000 - global_seqlen/max:36847.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36847.000 - global_seqlen/balanced_max:36847.000 - global_seqlen/mean:36847.000 - critic/vf_loss:0.019 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.001 - critic/grad_norm:22.423 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.531 - actor/pg_clipfrac:0.436 - actor/ppo_kl:1.375 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.102 - actor/grad_norm:1.961 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.274 - actor/lr:0.000 - critic/score/mean:-0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:4.156 - critic/advantages/max:8.628 - critic/advantages/min:-0.955 - critic/returns/mean:-0.059 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.084 - critic/values/max:0.328 - critic/values/min:0.000 - critic/vf_explained_var:-3.153 - response_length/mean:287.859 - response_length/max:337.000 - response_length/min:236.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.673 - timing_s/old_log_prob:4.861 - timing_s/ref:7.370 - timing_s/values:4.091 - timing_s/adv:0.022 - timing_s/update_critic:19.002 - timing_s/update_actor:20.855 - timing_s/step:57.878 - timing_per_token_ms/ref:0.200 - timing_per_token_ms/update_actor:0.566 - timing_per_token_ms/values:0.111 - timing_per_token_ms/update_critic:0.516 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:36847.000 - perf/time_per_step:57.878 - perf/throughput:636.637 - timing_s/total:9626.240
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:167 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.750 - train/Bandit/action_is_effective:0.750 - train/Bandit/action_is_valid:0.750 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:48.406 - global_seqlen/min:32308.000 - global_seqlen/max:32308.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32308.000 - global_seqlen/balanced_max:32308.000 - global_seqlen/mean:32308.000 - critic/vf_loss:0.018 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.126 - critic/grad_norm:24.406 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.436 - actor/pg_clipfrac:0.116 - actor/ppo_kl:0.083 - actor/pg_clipfrac_lower:0.039 - actor/entropy_loss:0.030 - actor/grad_norm:8.784 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.280 - actor/lr:0.000 - critic/score/mean:0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:2.845 - critic/advantages/max:4.050 - critic/advantages/min:-1.324 - critic/returns/mean:0.040 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.054 - critic/values/max:0.307 - critic/values/min:0.000 - critic/vf_explained_var:-1.958 - response_length/mean:252.375 - response_length/max:305.000 - response_length/min:226.000 - response_length/clip_ratio:0.039 - prompt_length/mean:0.031 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.031 - timing_s/gen:1.509 - timing_s/old_log_prob:4.754 - timing_s/ref:7.312 - timing_s/values:4.110 - timing_s/adv:0.020 - timing_s/update_critic:19.028 - timing_s/update_actor:20.562 - timing_s/step:57.298 - timing_per_token_ms/ref:0.226 - timing_per_token_ms/update_actor:0.636 - timing_per_token_ms/values:0.127 - timing_per_token_ms/update_critic:0.589 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:32308.000 - perf/time_per_step:57.298 - perf/throughput:563.858 - timing_s/total:9683.542
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:168 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.250 - train/Bandit/action_is_effective:0.250 - train/Bandit/action_is_valid:0.250 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:78.695 - global_seqlen/min:36185.000 - global_seqlen/max:36185.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36185.000 - global_seqlen/balanced_max:36185.000 - global_seqlen/mean:36185.000 - critic/vf_loss:0.027 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.004 - critic/grad_norm:28.602 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.492 - actor/pg_clipfrac:0.461 - actor/ppo_kl:1.819 - actor/pg_clipfrac_lower:0.002 - actor/entropy_loss:0.066 - actor/grad_norm:43.595 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:386.289 - actor/lr:0.000 - critic/score/mean:-0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.363 - critic/advantages/max:3.242 - critic/advantages/min:-1.079 - critic/returns/mean:-0.058 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.001 - critic/values/max:0.037 - critic/values/min:-0.035 - critic/vf_explained_var:0.033 - response_length/mean:282.688 - response_length/max:313.000 - response_length/min:236.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.648 - timing_s/old_log_prob:4.828 - timing_s/ref:7.345 - timing_s/values:4.136 - timing_s/adv:0.020 - timing_s/update_critic:18.645 - timing_s/update_actor:20.556 - timing_s/step:57.182 - timing_per_token_ms/ref:0.203 - timing_per_token_ms/update_actor:0.568 - timing_per_token_ms/values:0.114 - timing_per_token_ms/update_critic:0.515 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:36185.000 - perf/time_per_step:57.182 - perf/throughput:632.802 - timing_s/total:9740.728
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:169 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.625 - train/Bandit/action_is_effective:0.625 - train/Bandit/action_is_valid:0.625 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:54.672 - global_seqlen/min:33110.000 - global_seqlen/max:33110.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33110.000 - global_seqlen/balanced_max:33110.000 - global_seqlen/mean:33110.000 - critic/vf_loss:0.005 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.013 - critic/grad_norm:13.689 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.564 - actor/pg_clipfrac:0.277 - actor/ppo_kl:0.895 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.037 - actor/grad_norm:0.197 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.214 - actor/lr:0.000 - critic/score/mean:0.025 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.025 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.555 - critic/advantages/max:1.602 - critic/advantages/min:-1.283 - critic/returns/mean:0.014 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.001 - critic/values/max:0.045 - critic/values/min:-0.039 - critic/vf_explained_var:0.037 - response_length/mean:258.656 - response_length/max:300.000 - response_length/min:235.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.538 - timing_s/old_log_prob:4.840 - timing_s/ref:7.354 - timing_s/values:4.175 - timing_s/adv:0.019 - timing_s/update_critic:19.096 - timing_s/update_actor:20.547 - timing_s/step:57.573 - timing_per_token_ms/ref:0.222 - timing_per_token_ms/update_actor:0.621 - timing_per_token_ms/values:0.126 - timing_per_token_ms/update_critic:0.577 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:33110.000 - perf/time_per_step:57.573 - perf/throughput:575.093 - timing_s/total:9798.305
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.454979181289673 seconds
[36m(TaskRunner pid=850907)[0m step:170 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.750 - train/Bandit/action_is_effective:0.750 - train/Bandit/action_is_valid:0.750 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:47.164 - global_seqlen/min:32149.000 - global_seqlen/max:32149.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32149.000 - global_seqlen/balanced_max:32149.000 - global_seqlen/mean:32149.000 - critic/vf_loss:0.002 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.053 - critic/grad_norm:7.020 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.389 - actor/pg_clipfrac:0.146 - actor/ppo_kl:0.209 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.016 - actor/grad_norm:0.065 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.128 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.562 - val-env/Bandit/action_is_effective:0.562 - val-env/Bandit/action_is_valid:0.562 - val-env/BanditTest/success:0.000 - val-env/BanditTest/num_actions:0.000 - val-env/Bandit/non-zero/num_actions:1.000 - val-env/Bandit/non-zero/action_is_effective:1.000 - val-env/Bandit/non-zero/action_is_valid:1.000 - val-env/response_length:75.182 - val-core/unknown/reward/mean@512:-0.044 - val-aux/unknown/reward/std@512:0.090 - val-aux/unknown/reward/best@2/mean:-0.006 - val-aux/unknown/reward/best@2/std:0.100 - val-aux/unknown/reward/worst@2/mean:-0.086 - val-aux/unknown/reward/worst@2/std:0.051 - val-aux/unknown/reward/best@4/mean:0.047 - val-aux/unknown/reward/best@4/std:0.088 - val-aux/unknown/reward/worst@4/mean:-0.099 - val-aux/unknown/reward/worst@4/std:0.013 - val-aux/unknown/reward/best@8/mean:0.088 - val-aux/unknown/reward/best@8/std:0.048 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:0.099 - val-aux/unknown/reward/best@16/std:0.013 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:0.100 - val-aux/unknown/reward/best@32/std:0.000 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:0.100 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:0.100 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:0.100 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:0.100 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:1.597 - critic/advantages/max:2.696 - critic/advantages/min:-2.556 - critic/returns/mean:0.041 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:0.016 - critic/values/max:0.160 - critic/values/min:-0.024 - critic/vf_explained_var:-0.167 - response_length/mean:251.000 - response_length/max:296.000 - response_length/min:236.000 - response_length/clip_ratio:0.250 - prompt_length/mean:0.164 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.164 - timing_s/gen:1.499 - timing_s/old_log_prob:4.658 - timing_s/ref:7.202 - timing_s/values:3.914 - timing_s/adv:0.019 - timing_s/update_critic:18.475 - timing_s/update_actor:20.226 - timing_s/testing:3.775 - timing_s/step:59.772 - timing_per_token_ms/ref:0.224 - timing_per_token_ms/update_actor:0.629 - timing_per_token_ms/values:0.122 - timing_per_token_ms/update_critic:0.575 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:32149.000 - perf/time_per_step:59.772 - perf/throughput:537.861 - timing_s/total:9858.079
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:171 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.750 - train/Bandit/action_is_effective:0.750 - train/Bandit/action_is_valid:0.750 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:47.000 - global_seqlen/min:32128.000 - global_seqlen/max:32128.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32128.000 - global_seqlen/balanced_max:32128.000 - global_seqlen/mean:32128.000 - critic/vf_loss:0.019 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.011 - critic/grad_norm:23.952 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.501 - actor/pg_clipfrac:0.135 - actor/ppo_kl:0.410 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.015 - actor/grad_norm:0.024 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.144 - actor/lr:0.000 - critic/score/mean:0.050 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:0.050 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:0.402 - critic/advantages/max:1.111 - critic/advantages/min:-1.546 - critic/returns/mean:0.041 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.001 - critic/values/max:0.036 - critic/values/min:-0.039 - critic/vf_explained_var:0.044 - response_length/mean:250.961 - response_length/max:296.000 - response_length/min:236.000 - response_length/clip_ratio:0.211 - prompt_length/mean:0.039 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.039 - timing_s/gen:1.312 - timing_s/old_log_prob:4.771 - timing_s/ref:7.313 - timing_s/values:4.175 - timing_s/adv:0.019 - timing_s/update_critic:18.602 - timing_s/update_actor:20.465 - timing_s/step:56.660 - timing_per_token_ms/ref:0.228 - timing_per_token_ms/update_actor:0.637 - timing_per_token_ms/values:0.130 - timing_per_token_ms/update_critic:0.579 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.041 - perf/total_num_tokens:32128.000 - perf/time_per_step:56.660 - perf/throughput:567.036 - timing_s/total:9914.742
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:172 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.375 - train/Bandit/action_is_effective:0.375 - train/Bandit/action_is_valid:0.375 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:68.102 - global_seqlen/min:34829.000 - global_seqlen/max:34829.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34829.000 - global_seqlen/balanced_max:34829.000 - global_seqlen/mean:34829.000 - critic/vf_loss:0.015 - critic/vf_clipfrac:0.000 - critic/vpred_mean:0.045 - critic/grad_norm:19.237 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.506 - actor/pg_clipfrac:0.387 - actor/ppo_kl:1.637 - actor/pg_clipfrac_lower:0.009 - actor/entropy_loss:0.041 - actor/grad_norm:2.172 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.154 - actor/lr:0.000 - critic/score/mean:-0.025 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.025 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-0.221 - critic/advantages/max:2.423 - critic/advantages/min:-1.416 - critic/returns/mean:-0.035 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.015 - critic/values/max:-0.000 - critic/values/min:-0.103 - critic/vf_explained_var:0.064 - response_length/mean:272.094 - response_length/max:296.000 - response_length/min:236.000 - response_length/clip_ratio:0.172 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.798 - timing_s/old_log_prob:4.810 - timing_s/ref:7.314 - timing_s/values:4.029 - timing_s/adv:0.019 - timing_s/update_critic:19.128 - timing_s/update_actor:20.762 - timing_s/step:57.864 - timing_per_token_ms/ref:0.210 - timing_per_token_ms/update_actor:0.596 - timing_per_token_ms/values:0.116 - timing_per_token_ms/update_critic:0.549 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.052 - perf/total_num_tokens:34829.000 - perf/time_per_step:57.864 - perf/throughput:601.911 - timing_s/total:9972.610
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:173 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.375 - train/Bandit/action_is_effective:0.375 - train/Bandit/action_is_valid:0.375 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:67.672 - global_seqlen/min:34774.000 - global_seqlen/max:34774.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34774.000 - global_seqlen/balanced_max:34774.000 - global_seqlen/mean:34774.000 - critic/vf_loss:0.028 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.100 - critic/grad_norm:30.609 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.420 - actor/pg_clipfrac:0.313 - actor/ppo_kl:0.596 - actor/pg_clipfrac_lower:0.137 - actor/entropy_loss:0.036 - actor/grad_norm:0.080 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.160 - actor/lr:0.000 - critic/score/mean:-0.025 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.025 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.106 - critic/advantages/max:2.416 - critic/advantages/min:-3.837 - critic/returns/mean:-0.035 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.061 - critic/values/max:-0.000 - critic/values/min:-0.273 - critic/vf_explained_var:-0.830 - response_length/mean:271.664 - response_length/max:294.000 - response_length/min:236.000 - response_length/clip_ratio:0.219 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.581 - timing_s/old_log_prob:4.806 - timing_s/ref:7.353 - timing_s/values:4.137 - timing_s/adv:0.008 - timing_s/update_critic:18.970 - timing_s/update_actor:20.688 - timing_s/step:57.548 - timing_per_token_ms/ref:0.211 - timing_per_token_ms/update_actor:0.595 - timing_per_token_ms/values:0.119 - timing_per_token_ms/update_critic:0.546 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:34774.000 - perf/time_per_step:57.548 - perf/throughput:604.261 - timing_s/total:10030.161
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:174 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.375 - train/Bandit/action_is_effective:0.375 - train/Bandit/action_is_valid:0.375 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:66.867 - global_seqlen/min:34671.000 - global_seqlen/max:34671.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34671.000 - global_seqlen/balanced_max:34671.000 - global_seqlen/mean:34671.000 - critic/vf_loss:0.028 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.004 - critic/grad_norm:30.081 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.518 - actor/pg_clipfrac:0.440 - actor/ppo_kl:1.690 - actor/pg_clipfrac_lower:0.011 - actor/entropy_loss:0.031 - actor/grad_norm:16.086 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.161 - actor/lr:0.000 - critic/score/mean:-0.025 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.025 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.229 - critic/advantages/max:2.369 - critic/advantages/min:-4.072 - critic/returns/mean:-0.035 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.059 - critic/values/max:-0.000 - critic/values/min:-0.275 - critic/vf_explained_var:-0.770 - response_length/mean:270.859 - response_length/max:293.000 - response_length/min:236.000 - response_length/clip_ratio:0.094 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.563 - timing_s/old_log_prob:4.757 - timing_s/ref:7.335 - timing_s/values:4.080 - timing_s/adv:0.008 - timing_s/update_critic:18.919 - timing_s/update_actor:20.301 - timing_s/step:56.966 - timing_per_token_ms/ref:0.212 - timing_per_token_ms/update_actor:0.586 - timing_per_token_ms/values:0.118 - timing_per_token_ms/update_critic:0.546 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.045 - perf/total_num_tokens:34671.000 - perf/time_per_step:56.966 - perf/throughput:608.625 - timing_s/total:10087.131
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:175 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.008 - train/Bandit/action_is_effective:0.008 - train/Bandit/action_is_valid:0.008 - train/Bandit/non-zero/num_actions:1.000 - train/Bandit/non-zero/action_is_effective:1.000 - train/Bandit/non-zero/action_is_valid:1.000 - train/response_length:86.109 - global_seqlen/min:37134.000 - global_seqlen/max:37134.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37134.000 - global_seqlen/balanced_max:37134.000 - global_seqlen/mean:37134.000 - critic/vf_loss:0.007 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.109 - critic/grad_norm:14.418 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:-0.072 - actor/pg_clipfrac:0.605 - actor/ppo_kl:-7.187 - actor/pg_clipfrac_lower:0.040 - actor/entropy_loss:0.057 - actor/grad_norm:5.597 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.169 - actor/lr:0.000 - critic/score/mean:-0.098 - critic/score/max:0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.098 - critic/rewards/max:0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-10.168 - critic/advantages/max:9.032 - critic/advantages/min:-14.536 - critic/returns/mean:-0.099 - critic/returns/max:0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.088 - critic/values/max:-0.000 - critic/values/min:-0.330 - critic/vf_explained_var:-69.590 - response_length/mean:290.086 - response_length/max:291.000 - response_length/min:236.000 - response_length/clip_ratio:0.555 - prompt_length/mean:0.023 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.023 - timing_s/gen:1.735 - timing_s/old_log_prob:4.752 - timing_s/ref:7.339 - timing_s/values:4.156 - timing_s/adv:0.019 - timing_s/update_critic:18.439 - timing_s/update_actor:20.373 - timing_s/step:56.816 - timing_per_token_ms/ref:0.198 - timing_per_token_ms/update_actor:0.549 - timing_per_token_ms/values:0.112 - timing_per_token_ms/update_critic:0.497 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:37134.000 - perf/time_per_step:56.816 - perf/throughput:653.580 - timing_s/total:10143.950
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:176 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:50.203 - global_seqlen/min:32538.000 - global_seqlen/max:32538.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:32538.000 - global_seqlen/balanced_max:32538.000 - global_seqlen/mean:32538.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.104 - critic/grad_norm:3.764 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.245 - actor/pg_clipfrac:0.240 - actor/ppo_kl:0.567 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.062 - actor/grad_norm:5.116 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.175 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-2.269 - critic/advantages/max:2.658 - critic/advantages/min:-2.923 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.007 - critic/values/max:0.001 - critic/values/min:-0.073 - critic/vf_explained_var:-24.768 - response_length/mean:254.195 - response_length/max:298.000 - response_length/min:239.000 - response_length/clip_ratio:0.117 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.514 - timing_s/old_log_prob:4.823 - timing_s/ref:7.358 - timing_s/values:4.154 - timing_s/adv:0.019 - timing_s/update_critic:19.078 - timing_s/update_actor:20.586 - timing_s/step:57.537 - timing_per_token_ms/ref:0.226 - timing_per_token_ms/update_actor:0.633 - timing_per_token_ms/values:0.128 - timing_per_token_ms/update_critic:0.586 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:32538.000 - perf/time_per_step:57.537 - perf/throughput:565.511 - timing_s/total:10201.491
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:177 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:107.078 - global_seqlen/min:39818.000 - global_seqlen/max:39818.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39818.000 - global_seqlen/balanced_max:39818.000 - global_seqlen/mean:39818.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.100 - critic/grad_norm:1.841 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.347 - actor/ppo_kl:-4.522 - actor/pg_clipfrac_lower:0.079 - actor/entropy_loss:0.117 - actor/grad_norm:5.376 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.183 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-9.022 - critic/advantages/max:3.243 - critic/advantages/min:-13.757 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.045 - critic/values/max:-0.000 - critic/values/min:-0.163 - critic/vf_explained_var:-395.342 - response_length/mean:311.070 - response_length/max:331.000 - response_length/min:257.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.679 - timing_s/old_log_prob:4.824 - timing_s/ref:7.337 - timing_s/values:4.037 - timing_s/adv:0.022 - timing_s/update_critic:18.842 - timing_s/update_actor:20.836 - timing_s/step:57.580 - timing_per_token_ms/ref:0.184 - timing_per_token_ms/update_actor:0.523 - timing_per_token_ms/values:0.101 - timing_per_token_ms/update_critic:0.473 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.042 - perf/total_num_tokens:39818.000 - perf/time_per_step:57.580 - perf/throughput:691.524 - timing_s/total:10259.073
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:178 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:105.508 - global_seqlen/min:39617.000 - global_seqlen/max:39617.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39617.000 - global_seqlen/balanced_max:39617.000 - global_seqlen/mean:39617.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.102 - critic/grad_norm:1.904 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.170 - actor/pg_clipfrac:0.260 - actor/ppo_kl:-1.354 - actor/pg_clipfrac_lower:0.096 - actor/entropy_loss:0.154 - actor/grad_norm:7.600 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.190 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-11.085 - critic/advantages/max:5.222 - critic/advantages/min:-16.818 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.042 - critic/values/max:-0.000 - critic/values/min:-0.162 - critic/vf_explained_var:-344.650 - response_length/mean:309.500 - response_length/max:349.000 - response_length/min:242.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.691 - timing_s/old_log_prob:4.920 - timing_s/ref:7.390 - timing_s/values:4.165 - timing_s/adv:0.022 - timing_s/update_critic:19.184 - timing_s/update_actor:21.027 - timing_s/step:58.403 - timing_per_token_ms/ref:0.187 - timing_per_token_ms/update_actor:0.531 - timing_per_token_ms/values:0.105 - timing_per_token_ms/update_critic:0.484 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.043 - perf/total_num_tokens:39617.000 - perf/time_per_step:58.403 - perf/throughput:678.337 - timing_s/total:10317.479
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:179 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:101.602 - global_seqlen/min:39117.000 - global_seqlen/max:39117.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39117.000 - global_seqlen/balanced_max:39117.000 - global_seqlen/mean:39117.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.102 - critic/grad_norm:2.594 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.109 - actor/pg_clipfrac:0.314 - actor/ppo_kl:-2.545 - actor/pg_clipfrac_lower:0.120 - actor/entropy_loss:0.148 - actor/grad_norm:15.641 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.199 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-11.080 - critic/advantages/max:3.520 - critic/advantages/min:-16.599 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.039 - critic/values/max:-0.000 - critic/values/min:-0.141 - critic/vf_explained_var:-299.385 - response_length/mean:305.594 - response_length/max:343.000 - response_length/min:290.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.725 - timing_s/old_log_prob:4.890 - timing_s/ref:7.369 - timing_s/values:4.156 - timing_s/adv:0.022 - timing_s/update_critic:18.748 - timing_s/update_actor:21.022 - timing_s/step:57.936 - timing_per_token_ms/ref:0.188 - timing_per_token_ms/update_actor:0.537 - timing_per_token_ms/values:0.106 - timing_per_token_ms/update_critic:0.479 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:39117.000 - perf/time_per_step:57.936 - perf/throughput:675.174 - timing_s/total:10375.419
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.9510750770568848 seconds
[36m(TaskRunner pid=850907)[0m step:180 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:105.078 - global_seqlen/min:39562.000 - global_seqlen/max:39562.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39562.000 - global_seqlen/balanced_max:39562.000 - global_seqlen/mean:39562.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.100 - critic/grad_norm:2.509 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.046 - actor/pg_clipfrac:0.290 - actor/ppo_kl:0.294 - actor/pg_clipfrac_lower:0.045 - actor/entropy_loss:0.164 - actor/grad_norm:16.072 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.205 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.000 - val-env/BanditTest/success:0.000 - val-env/BanditTest/num_actions:0.000 - val-env/response_length:90.141 - val-core/unknown/reward/mean@512:-0.100 - val-aux/unknown/reward/std@512:0.000 - val-aux/unknown/reward/best@2/mean:-0.100 - val-aux/unknown/reward/best@2/std:0.000 - val-aux/unknown/reward/worst@2/mean:-0.100 - val-aux/unknown/reward/worst@2/std:0.000 - val-aux/unknown/reward/best@4/mean:-0.100 - val-aux/unknown/reward/best@4/std:0.000 - val-aux/unknown/reward/worst@4/mean:-0.100 - val-aux/unknown/reward/worst@4/std:0.000 - val-aux/unknown/reward/best@8/mean:-0.100 - val-aux/unknown/reward/best@8/std:0.000 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:-0.100 - val-aux/unknown/reward/best@16/std:0.000 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:-0.100 - val-aux/unknown/reward/best@32/std:0.000 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:-0.100 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:-0.100 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:-0.100 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:-0.100 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-11.436 - critic/advantages/max:6.556 - critic/advantages/min:-17.327 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.038 - critic/values/max:-0.000 - critic/values/min:-0.155 - critic/vf_explained_var:-285.195 - response_length/mean:309.070 - response_length/max:337.000 - response_length/min:287.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.739 - timing_s/old_log_prob:4.843 - timing_s/ref:7.305 - timing_s/values:4.000 - timing_s/adv:0.022 - timing_s/update_critic:19.151 - timing_s/update_actor:20.682 - timing_s/testing:4.264 - timing_s/step:62.010 - timing_per_token_ms/ref:0.185 - timing_per_token_ms/update_actor:0.523 - timing_per_token_ms/values:0.101 - timing_per_token_ms/update_critic:0.484 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:39562.000 - perf/time_per_step:62.010 - perf/throughput:637.996 - timing_s/total:10437.431
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:181 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:92.594 - global_seqlen/min:37964.000 - global_seqlen/max:37964.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37964.000 - global_seqlen/balanced_max:37964.000 - global_seqlen/mean:37964.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.098 - critic/grad_norm:2.154 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.111 - actor/pg_clipfrac:0.300 - actor/ppo_kl:0.040 - actor/pg_clipfrac_lower:0.075 - actor/entropy_loss:0.183 - actor/grad_norm:22.470 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.209 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-11.550 - critic/advantages/max:3.756 - critic/advantages/min:-16.792 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.031 - critic/values/max:-0.000 - critic/values/min:-0.124 - critic/vf_explained_var:-218.991 - response_length/mean:296.586 - response_length/max:320.000 - response_length/min:239.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.541 - timing_s/old_log_prob:4.790 - timing_s/ref:7.337 - timing_s/values:4.046 - timing_s/adv:0.021 - timing_s/update_critic:18.533 - timing_s/update_actor:20.569 - timing_s/step:56.841 - timing_per_token_ms/ref:0.193 - timing_per_token_ms/update_actor:0.542 - timing_per_token_ms/values:0.107 - timing_per_token_ms/update_critic:0.488 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.041 - perf/total_num_tokens:37964.000 - perf/time_per_step:56.841 - perf/throughput:667.902 - timing_s/total:10494.274
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:182 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:107.711 - global_seqlen/min:39899.000 - global_seqlen/max:39899.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:39899.000 - global_seqlen/balanced_max:39899.000 - global_seqlen/mean:39899.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.102 - critic/grad_norm:1.682 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.147 - actor/ppo_kl:0.759 - actor/pg_clipfrac_lower:0.010 - actor/entropy_loss:0.076 - actor/grad_norm:82.993 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.215 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-10.232 - critic/advantages/max:3.524 - critic/advantages/min:-15.635 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.035 - critic/values/max:-0.000 - critic/values/min:-0.123 - critic/vf_explained_var:-228.478 - response_length/mean:311.656 - response_length/max:327.000 - response_length/min:233.000 - response_length/clip_ratio:0.102 - prompt_length/mean:0.055 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.055 - timing_s/gen:1.887 - timing_s/old_log_prob:4.757 - timing_s/ref:7.292 - timing_s/values:4.039 - timing_s/adv:0.021 - timing_s/update_critic:18.821 - timing_s/update_actor:20.592 - timing_s/step:57.414 - timing_per_token_ms/ref:0.183 - timing_per_token_ms/update_actor:0.516 - timing_per_token_ms/values:0.101 - timing_per_token_ms/update_critic:0.472 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:39899.000 - perf/time_per_step:57.414 - perf/throughput:694.933 - timing_s/total:10551.691
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:183 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:124.312 - global_seqlen/min:42024.000 - global_seqlen/max:42024.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42024.000 - global_seqlen/balanced_max:42024.000 - global_seqlen/mean:42024.000 - critic/vf_loss:0.000 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.101 - critic/grad_norm:0.737 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.077 - actor/ppo_kl:-0.117 - actor/pg_clipfrac_lower:0.024 - actor/entropy_loss:0.100 - actor/grad_norm:0.614 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.221 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-9.884 - critic/advantages/max:3.582 - critic/advantages/min:-15.910 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.036 - critic/values/max:-0.000 - critic/values/min:-0.118 - critic/vf_explained_var:-217.458 - response_length/mean:328.227 - response_length/max:336.000 - response_length/min:246.000 - response_length/clip_ratio:0.445 - prompt_length/mean:0.086 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.086 - timing_s/gen:1.710 - timing_s/old_log_prob:4.848 - timing_s/ref:7.306 - timing_s/values:3.943 - timing_s/adv:0.022 - timing_s/update_critic:18.696 - timing_s/update_actor:20.498 - timing_s/step:57.028 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/update_actor:0.488 - timing_per_token_ms/values:0.094 - timing_per_token_ms/update_critic:0.445 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.041 - perf/total_num_tokens:42024.000 - perf/time_per_step:57.028 - perf/throughput:736.904 - timing_s/total:10608.722
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:184 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:128.086 - global_seqlen/min:42507.000 - global_seqlen/max:42507.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:42507.000 - global_seqlen/balanced_max:42507.000 - global_seqlen/mean:42507.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.091 - critic/grad_norm:5.265 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.037 - actor/ppo_kl:0.062 - actor/pg_clipfrac_lower:0.008 - actor/entropy_loss:0.038 - actor/grad_norm:2.431 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.224 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-11.556 - critic/advantages/max:3.135 - critic/advantages/min:-18.812 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.041 - critic/values/max:-0.000 - critic/values/min:-0.125 - critic/vf_explained_var:-272.265 - response_length/mean:332.070 - response_length/max:338.000 - response_length/min:233.000 - response_length/clip_ratio:0.719 - prompt_length/mean:0.016 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:1.685 - timing_s/old_log_prob:4.821 - timing_s/ref:7.311 - timing_s/values:4.073 - timing_s/adv:0.022 - timing_s/update_critic:18.902 - timing_s/update_actor:20.586 - timing_s/step:57.403 - timing_per_token_ms/ref:0.172 - timing_per_token_ms/update_actor:0.484 - timing_per_token_ms/values:0.096 - timing_per_token_ms/update_critic:0.445 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.040 - perf/total_num_tokens:42507.000 - perf/time_per_step:57.403 - perf/throughput:740.496 - timing_s/total:10666.129
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:185 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:133.422 - global_seqlen/min:43190.000 - global_seqlen/max:43190.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:43190.000 - global_seqlen/balanced_max:43190.000 - global_seqlen/mean:43190.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.091 - critic/grad_norm:4.400 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.034 - actor/ppo_kl:-0.076 - actor/pg_clipfrac_lower:0.005 - actor/entropy_loss:0.052 - actor/grad_norm:0.044 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.233 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-6.943 - critic/advantages/max:2.889 - critic/advantages/min:-11.494 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.024 - critic/values/max:-0.000 - critic/values/min:-0.076 - critic/vf_explained_var:-88.727 - response_length/mean:337.000 - response_length/max:337.000 - response_length/min:337.000 - response_length/clip_ratio:1.000 - prompt_length/mean:0.422 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.422 - timing_s/gen:1.737 - timing_s/old_log_prob:4.569 - timing_s/ref:7.061 - timing_s/values:3.820 - timing_s/adv:0.022 - timing_s/update_critic:18.185 - timing_s/update_actor:19.772 - timing_s/step:55.171 - timing_per_token_ms/ref:0.163 - timing_per_token_ms/update_actor:0.458 - timing_per_token_ms/values:0.088 - timing_per_token_ms/update_critic:0.421 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.040 - perf/total_num_tokens:43190.000 - perf/time_per_step:55.171 - perf/throughput:782.841 - timing_s/total:10721.304
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:186 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:134.000 - global_seqlen/min:43264.000 - global_seqlen/max:43264.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:43264.000 - global_seqlen/balanced_max:43264.000 - global_seqlen/mean:43264.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.087 - critic/grad_norm:4.835 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.012 - actor/ppo_kl:-0.107 - actor/pg_clipfrac_lower:0.013 - actor/entropy_loss:0.033 - actor/grad_norm:0.014 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.157 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-6.637 - critic/advantages/max:3.133 - critic/advantages/min:-11.018 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.023 - critic/values/max:-0.000 - critic/values/min:-0.074 - critic/vf_explained_var:-80.077 - response_length/mean:337.000 - response_length/max:337.000 - response_length/min:337.000 - response_length/clip_ratio:1.000 - prompt_length/mean:1.000 - prompt_length/max:1.000 - prompt_length/min:1.000 - prompt_length/clip_ratio:1.000 - timing_s/gen:1.709 - timing_s/old_log_prob:4.136 - timing_s/ref:6.631 - timing_s/values:3.405 - timing_s/adv:0.022 - timing_s/update_critic:16.573 - timing_s/update_actor:18.646 - timing_s/step:51.126 - timing_per_token_ms/ref:0.153 - timing_per_token_ms/update_actor:0.431 - timing_per_token_ms/values:0.079 - timing_per_token_ms/update_critic:0.383 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.040 - perf/total_num_tokens:43264.000 - perf/time_per_step:51.126 - perf/throughput:846.221 - timing_s/total:10772.433
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:187 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:53.875 - global_seqlen/min:33008.000 - global_seqlen/max:33008.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:33008.000 - global_seqlen/balanced_max:33008.000 - global_seqlen/mean:33008.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.090 - critic/grad_norm:4.795 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.118 - actor/pg_clipfrac:0.072 - actor/ppo_kl:0.313 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.139 - actor/grad_norm:252.917 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.191 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-15.595 - critic/advantages/max:2.759 - critic/advantages/min:-19.718 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.028 - critic/values/max:-0.000 - critic/values/min:-0.152 - critic/vf_explained_var:-295.366 - response_length/mean:257.641 - response_length/max:338.000 - response_length/min:230.000 - response_length/clip_ratio:0.242 - prompt_length/mean:0.234 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.234 - timing_s/gen:1.448 - timing_s/old_log_prob:4.710 - timing_s/ref:7.185 - timing_s/values:3.931 - timing_s/adv:0.010 - timing_s/update_critic:18.376 - timing_s/update_actor:20.141 - timing_s/step:55.804 - timing_per_token_ms/ref:0.218 - timing_per_token_ms/update_actor:0.610 - timing_per_token_ms/values:0.119 - timing_per_token_ms/update_critic:0.557 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:33008.000 - perf/time_per_step:55.804 - perf/throughput:591.495 - timing_s/total:10828.241
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:188 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:82.328 - global_seqlen/min:36650.000 - global_seqlen/max:36650.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36650.000 - global_seqlen/balanced_max:36650.000 - global_seqlen/mean:36650.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.096 - critic/grad_norm:4.172 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.059 - actor/ppo_kl:0.070 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.135 - actor/grad_norm:0.210 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.205 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-8.336 - critic/advantages/max:2.764 - critic/advantages/min:-11.708 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.020 - critic/values/max:-0.000 - critic/values/min:-0.086 - critic/vf_explained_var:-99.147 - response_length/mean:285.828 - response_length/max:338.000 - response_length/min:232.000 - response_length/clip_ratio:0.508 - prompt_length/mean:0.500 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.500 - timing_s/gen:1.536 - timing_s/old_log_prob:4.522 - timing_s/ref:6.945 - timing_s/values:3.699 - timing_s/adv:0.022 - timing_s/update_critic:17.668 - timing_s/update_actor:19.713 - timing_s/step:54.109 - timing_per_token_ms/ref:0.190 - timing_per_token_ms/update_actor:0.538 - timing_per_token_ms/values:0.101 - timing_per_token_ms/update_critic:0.482 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.042 - perf/total_num_tokens:36650.000 - perf/time_per_step:54.109 - perf/throughput:677.335 - timing_s/total:10882.354
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:189 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:28.000 - global_seqlen/min:29696.000 - global_seqlen/max:29696.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:29696.000 - global_seqlen/balanced_max:29696.000 - global_seqlen/mean:29696.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.081 - critic/grad_norm:4.856 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.179 - actor/ppo_kl:0.195 - actor/pg_clipfrac_lower:0.009 - actor/entropy_loss:0.219 - actor/grad_norm:0.092 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.211 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-8.919 - critic/advantages/max:2.780 - critic/advantages/min:-10.150 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.007 - critic/values/max:-0.000 - critic/values/min:-0.071 - critic/vf_explained_var:-32.730 - response_length/mean:231.000 - response_length/max:231.000 - response_length/min:231.000 - response_length/clip_ratio:1.000 - prompt_length/mean:1.000 - prompt_length/max:1.000 - prompt_length/min:1.000 - prompt_length/clip_ratio:1.000 - timing_s/gen:0.711 - timing_s/old_log_prob:3.946 - timing_s/ref:6.596 - timing_s/values:3.307 - timing_s/adv:0.015 - timing_s/update_critic:16.208 - timing_s/update_actor:17.544 - timing_s/step:48.331 - timing_per_token_ms/ref:0.222 - timing_per_token_ms/update_actor:0.591 - timing_per_token_ms/values:0.111 - timing_per_token_ms/update_critic:0.546 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.024 - perf/total_num_tokens:29696.000 - perf/time_per_step:48.331 - perf/throughput:614.424 - timing_s/total:10930.689
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.9544270038604736 seconds
[36m(TaskRunner pid=850907)[0m step:190 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:66.922 - global_seqlen/min:34678.000 - global_seqlen/max:34678.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:34678.000 - global_seqlen/balanced_max:34678.000 - global_seqlen/mean:34678.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.091 - critic/grad_norm:4.685 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.450 - actor/pg_clipfrac:0.168 - actor/ppo_kl:0.854 - actor/pg_clipfrac_lower:0.000 - actor/entropy_loss:0.098 - actor/grad_norm:0.029 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.215 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.000 - val-env/BanditTest/success:0.000 - val-env/BanditTest/num_actions:0.000 - val-env/response_length:105.537 - val-core/unknown/reward/mean@512:-0.100 - val-aux/unknown/reward/std@512:0.000 - val-aux/unknown/reward/best@2/mean:-0.100 - val-aux/unknown/reward/best@2/std:0.000 - val-aux/unknown/reward/worst@2/mean:-0.100 - val-aux/unknown/reward/worst@2/std:0.000 - val-aux/unknown/reward/best@4/mean:-0.100 - val-aux/unknown/reward/best@4/std:0.000 - val-aux/unknown/reward/worst@4/mean:-0.100 - val-aux/unknown/reward/worst@4/std:0.000 - val-aux/unknown/reward/best@8/mean:-0.100 - val-aux/unknown/reward/best@8/std:0.000 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:-0.100 - val-aux/unknown/reward/best@16/std:0.000 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:-0.100 - val-aux/unknown/reward/best@32/std:0.000 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:-0.100 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:-0.100 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:-0.100 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:-0.100 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-11.088 - critic/advantages/max:2.051 - critic/advantages/min:-14.732 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.034 - critic/values/max:-0.000 - critic/values/min:-0.158 - critic/vf_explained_var:-360.240 - response_length/mean:270.555 - response_length/max:337.000 - response_length/min:232.000 - response_length/clip_ratio:0.367 - prompt_length/mean:0.367 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.367 - timing_s/gen:1.537 - timing_s/old_log_prob:4.657 - timing_s/ref:7.139 - timing_s/values:3.836 - timing_s/adv:0.022 - timing_s/update_critic:17.715 - timing_s/update_actor:19.621 - timing_s/testing:4.275 - timing_s/step:58.806 - timing_per_token_ms/ref:0.206 - timing_per_token_ms/update_actor:0.566 - timing_per_token_ms/values:0.111 - timing_per_token_ms/update_critic:0.511 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.044 - perf/total_num_tokens:34678.000 - perf/time_per_step:58.806 - perf/throughput:589.698 - timing_s/total:10989.498
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:191 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:116.664 - global_seqlen/min:41045.000 - global_seqlen/max:41045.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:41045.000 - global_seqlen/balanced_max:41045.000 - global_seqlen/mean:41045.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.104 - critic/grad_norm:4.496 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.215 - actor/ppo_kl:1.245 - actor/pg_clipfrac_lower:0.023 - actor/entropy_loss:0.181 - actor/grad_norm:16.263 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.226 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-6.583 - critic/advantages/max:3.451 - critic/advantages/min:-10.348 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.027 - critic/values/max:-0.000 - critic/values/min:-0.100 - critic/vf_explained_var:-130.053 - response_length/mean:320.625 - response_length/max:337.000 - response_length/min:211.000 - response_length/clip_ratio:0.570 - prompt_length/mean:0.039 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.039 - timing_s/gen:1.518 - timing_s/old_log_prob:4.775 - timing_s/ref:7.316 - timing_s/values:4.067 - timing_s/adv:0.010 - timing_s/update_critic:18.740 - timing_s/update_actor:20.625 - timing_s/step:57.053 - timing_per_token_ms/ref:0.178 - timing_per_token_ms/update_actor:0.502 - timing_per_token_ms/values:0.099 - timing_per_token_ms/update_critic:0.457 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.037 - perf/total_num_tokens:41045.000 - perf/time_per_step:57.053 - perf/throughput:719.415 - timing_s/total:11046.554
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:192 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:92.625 - global_seqlen/min:37968.000 - global_seqlen/max:37968.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:37968.000 - global_seqlen/balanced_max:37968.000 - global_seqlen/mean:37968.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.095 - critic/grad_norm:4.539 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.067 - actor/pg_clipfrac:0.658 - actor/ppo_kl:-1.552 - actor/pg_clipfrac_lower:0.103 - actor/entropy_loss:0.089 - actor/grad_norm:84.671 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.236 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-6.932 - critic/advantages/max:3.076 - critic/advantages/min:-10.093 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.021 - critic/values/max:-0.000 - critic/values/min:-0.089 - critic/vf_explained_var:-101.336 - response_length/mean:295.688 - response_length/max:296.000 - response_length/min:276.000 - response_length/clip_ratio:0.984 - prompt_length/mean:0.938 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.938 - timing_s/gen:1.735 - timing_s/old_log_prob:4.113 - timing_s/ref:6.672 - timing_s/values:3.413 - timing_s/adv:0.019 - timing_s/update_critic:16.750 - timing_s/update_actor:17.878 - timing_s/step:50.585 - timing_per_token_ms/ref:0.176 - timing_per_token_ms/update_actor:0.471 - timing_per_token_ms/values:0.090 - timing_per_token_ms/update_critic:0.441 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:37968.000 - perf/time_per_step:50.585 - perf/throughput:750.575 - timing_s/total:11097.142
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:193 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:84.406 - global_seqlen/min:36916.000 - global_seqlen/max:36916.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:36916.000 - global_seqlen/balanced_max:36916.000 - global_seqlen/mean:36916.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.096 - critic/grad_norm:4.631 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.066 - actor/pg_clipfrac:0.493 - actor/ppo_kl:-1.013 - actor/pg_clipfrac_lower:0.035 - actor/entropy_loss:0.208 - actor/grad_norm:61.836 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.241 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-16.018 - critic/advantages/max:3.012 - critic/advantages/min:-22.645 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.041 - critic/values/max:-0.000 - critic/values/min:-0.160 - critic/vf_explained_var:-413.783 - response_length/mean:288.398 - response_length/max:336.000 - response_length/min:275.000 - response_length/clip_ratio:0.016 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.727 - timing_s/old_log_prob:4.831 - timing_s/ref:7.284 - timing_s/values:4.108 - timing_s/adv:0.022 - timing_s/update_critic:18.952 - timing_s/update_actor:20.696 - timing_s/step:57.624 - timing_per_token_ms/ref:0.197 - timing_per_token_ms/update_actor:0.561 - timing_per_token_ms/values:0.111 - timing_per_token_ms/update_critic:0.513 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.047 - perf/total_num_tokens:36916.000 - perf/time_per_step:57.624 - perf/throughput:640.630 - timing_s/total:11154.771
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:194 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:92.992 - global_seqlen/min:38015.000 - global_seqlen/max:38015.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38015.000 - global_seqlen/balanced_max:38015.000 - global_seqlen/mean:38015.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.105 - critic/grad_norm:4.438 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.172 - actor/pg_clipfrac:0.369 - actor/ppo_kl:-6.287 - actor/pg_clipfrac_lower:0.159 - actor/entropy_loss:1.899 - actor/grad_norm:0.165 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.246 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-9.773 - critic/advantages/max:2.760 - critic/advantages/min:-14.249 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.025 - critic/values/max:-0.000 - critic/values/min:-0.093 - critic/vf_explained_var:-131.469 - response_length/mean:296.000 - response_length/max:296.000 - response_length/min:296.000 - response_length/clip_ratio:1.000 - prompt_length/mean:0.992 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.992 - timing_s/gen:1.756 - timing_s/old_log_prob:4.093 - timing_s/ref:6.641 - timing_s/values:3.305 - timing_s/adv:0.020 - timing_s/update_critic:16.630 - timing_s/update_actor:18.068 - timing_s/step:50.516 - timing_per_token_ms/ref:0.175 - timing_per_token_ms/update_actor:0.475 - timing_per_token_ms/values:0.087 - timing_per_token_ms/update_critic:0.437 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:38015.000 - perf/time_per_step:50.516 - perf/throughput:752.536 - timing_s/total:11205.290
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:195 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:112.070 - global_seqlen/min:40457.000 - global_seqlen/max:40457.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40457.000 - global_seqlen/balanced_max:40457.000 - global_seqlen/mean:40457.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.095 - critic/grad_norm:4.456 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.211 - actor/ppo_kl:-0.610 - actor/pg_clipfrac_lower:0.043 - actor/entropy_loss:1.328 - actor/grad_norm:17.606 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.254 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-6.861 - critic/advantages/max:9.113 - critic/advantages/min:-10.630 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.025 - critic/values/max:-0.000 - critic/values/min:-0.129 - critic/vf_explained_var:-110.749 - response_length/mean:316.062 - response_length/max:330.000 - response_length/min:296.000 - response_length/clip_ratio:0.023 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.712 - timing_s/old_log_prob:4.846 - timing_s/ref:7.332 - timing_s/values:4.098 - timing_s/adv:0.021 - timing_s/update_critic:19.127 - timing_s/update_actor:20.965 - timing_s/step:58.105 - timing_per_token_ms/ref:0.181 - timing_per_token_ms/update_actor:0.518 - timing_per_token_ms/values:0.101 - timing_per_token_ms/update_critic:0.473 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.042 - perf/total_num_tokens:40457.000 - perf/time_per_step:58.105 - perf/throughput:696.273 - timing_s/total:11263.399
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:196 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:112.703 - global_seqlen/min:40538.000 - global_seqlen/max:40538.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40538.000 - global_seqlen/balanced_max:40538.000 - global_seqlen/mean:40538.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.099 - critic/grad_norm:4.542 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.044 - actor/pg_clipfrac:0.207 - actor/ppo_kl:1.292 - actor/pg_clipfrac_lower:0.012 - actor/entropy_loss:0.948 - actor/grad_norm:24.548 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.257 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-14.191 - critic/advantages/max:5.570 - critic/advantages/min:-22.031 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.051 - critic/values/max:-0.000 - critic/values/min:-0.179 - critic/vf_explained_var:-466.936 - response_length/mean:316.695 - response_length/max:337.000 - response_length/min:285.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.722 - timing_s/old_log_prob:4.871 - timing_s/ref:7.313 - timing_s/values:4.037 - timing_s/adv:0.022 - timing_s/update_critic:18.921 - timing_s/update_actor:20.914 - timing_s/step:57.804 - timing_per_token_ms/ref:0.180 - timing_per_token_ms/update_actor:0.516 - timing_per_token_ms/values:0.100 - timing_per_token_ms/update_critic:0.467 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.042 - perf/total_num_tokens:40538.000 - perf/time_per_step:57.804 - perf/throughput:701.295 - timing_s/total:11321.207
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:197 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:93.078 - global_seqlen/min:38026.000 - global_seqlen/max:38026.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38026.000 - global_seqlen/balanced_max:38026.000 - global_seqlen/mean:38026.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.105 - critic/grad_norm:4.360 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.356 - actor/ppo_kl:1.725 - actor/pg_clipfrac_lower:0.009 - actor/entropy_loss:2.626 - actor/grad_norm:115.880 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.259 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-8.374 - critic/advantages/max:3.081 - critic/advantages/min:-12.194 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.025 - critic/values/max:-0.000 - critic/values/min:-0.098 - critic/vf_explained_var:-132.367 - response_length/mean:297.070 - response_length/max:305.000 - response_length/min:297.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.740 - timing_s/old_log_prob:4.803 - timing_s/ref:7.338 - timing_s/values:4.108 - timing_s/adv:0.020 - timing_s/update_critic:18.836 - timing_s/update_actor:20.674 - timing_s/step:57.524 - timing_per_token_ms/ref:0.193 - timing_per_token_ms/update_actor:0.544 - timing_per_token_ms/values:0.108 - timing_per_token_ms/update_critic:0.495 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:38026.000 - perf/time_per_step:57.524 - perf/throughput:661.041 - timing_s/total:11378.735
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:198 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:93.000 - global_seqlen/min:38016.000 - global_seqlen/max:38016.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38016.000 - global_seqlen/balanced_max:38016.000 - global_seqlen/mean:38016.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.095 - critic/grad_norm:4.501 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.158 - actor/pg_clipfrac:0.335 - actor/ppo_kl:-1.544 - actor/pg_clipfrac_lower:0.123 - actor/entropy_loss:2.526 - actor/grad_norm:31.116 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.262 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-8.549 - critic/advantages/max:2.241 - critic/advantages/min:-12.465 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.022 - critic/values/max:-0.000 - critic/values/min:-0.083 - critic/vf_explained_var:-105.412 - response_length/mean:296.000 - response_length/max:296.000 - response_length/min:296.000 - response_length/clip_ratio:1.000 - prompt_length/mean:1.000 - prompt_length/max:1.000 - prompt_length/min:1.000 - prompt_length/clip_ratio:1.000 - timing_s/gen:1.732 - timing_s/old_log_prob:4.091 - timing_s/ref:6.625 - timing_s/values:3.377 - timing_s/adv:0.019 - timing_s/update_critic:16.526 - timing_s/update_actor:18.331 - timing_s/step:50.704 - timing_per_token_ms/ref:0.174 - timing_per_token_ms/update_actor:0.482 - timing_per_token_ms/values:0.089 - timing_per_token_ms/update_critic:0.435 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:38016.000 - perf/time_per_step:50.704 - perf/throughput:749.761 - timing_s/total:11429.443
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m step:199 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:93.781 - global_seqlen/min:38116.000 - global_seqlen/max:38116.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:38116.000 - global_seqlen/balanced_max:38116.000 - global_seqlen/mean:38116.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.100 - critic/grad_norm:4.551 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.348 - actor/ppo_kl:1.530 - actor/pg_clipfrac_lower:0.029 - actor/entropy_loss:2.683 - actor/grad_norm:109.118 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.270 - actor/lr:0.000 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-16.492 - critic/advantages/max:3.837 - critic/advantages/min:-24.074 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.045 - critic/values/max:-0.000 - critic/values/min:-0.167 - critic/vf_explained_var:-447.738 - response_length/mean:297.773 - response_length/max:318.000 - response_length/min:297.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.735 - timing_s/old_log_prob:4.828 - timing_s/ref:7.353 - timing_s/values:4.143 - timing_s/adv:0.021 - timing_s/update_critic:18.805 - timing_s/update_actor:20.657 - timing_s/step:57.546 - timing_per_token_ms/ref:0.193 - timing_per_token_ms/update_actor:0.542 - timing_per_token_ms/values:0.109 - timing_per_token_ms/update_critic:0.493 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.046 - perf/total_num_tokens:38116.000 - perf/time_per_step:57.546 - perf/throughput:662.353 - timing_s/total:11486.993
[36m(TaskRunner pid=850907)[0m Error in reward_fn: 'reward_extra_info'
[36m(TaskRunner pid=850907)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=850907)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True}
[36m(TaskRunner pid=850907)[0m validation generation time: 3.958754777908325 seconds
[36m(TaskRunner pid=850907)[0m step:200 - train/Bandit/success:0.000 - train/Bandit/num_actions:0.000 - train/response_length:114.023 - global_seqlen/min:40707.000 - global_seqlen/max:40707.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:40707.000 - global_seqlen/balanced_max:40707.000 - global_seqlen/mean:40707.000 - critic/vf_loss:0.001 - critic/vf_clipfrac:0.000 - critic/vpred_mean:-0.106 - critic/grad_norm:4.400 - perf/mfu/critic:0.000 - critic/lr:0.000 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.215 - actor/ppo_kl:1.168 - actor/pg_clipfrac_lower:0.016 - actor/entropy_loss:1.088 - actor/grad_norm:26.557 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:27.036 - perf/max_memory_reserved_gb:32.439 - perf/cpu_memory_used_gb:387.270 - actor/lr:0.000 - val-env/Bandit/success:0.000 - val-env/Bandit/num_actions:0.000 - val-env/BanditTest/success:0.000 - val-env/BanditTest/num_actions:0.000 - val-env/response_length:95.352 - val-core/unknown/reward/mean@512:-0.100 - val-aux/unknown/reward/std@512:0.000 - val-aux/unknown/reward/best@2/mean:-0.100 - val-aux/unknown/reward/best@2/std:0.000 - val-aux/unknown/reward/worst@2/mean:-0.100 - val-aux/unknown/reward/worst@2/std:0.000 - val-aux/unknown/reward/best@4/mean:-0.100 - val-aux/unknown/reward/best@4/std:0.000 - val-aux/unknown/reward/worst@4/mean:-0.100 - val-aux/unknown/reward/worst@4/std:0.000 - val-aux/unknown/reward/best@8/mean:-0.100 - val-aux/unknown/reward/best@8/std:0.000 - val-aux/unknown/reward/worst@8/mean:-0.100 - val-aux/unknown/reward/worst@8/std:0.000 - val-aux/unknown/reward/best@16/mean:-0.100 - val-aux/unknown/reward/best@16/std:0.000 - val-aux/unknown/reward/worst@16/mean:-0.100 - val-aux/unknown/reward/worst@16/std:0.000 - val-aux/unknown/reward/best@32/mean:-0.100 - val-aux/unknown/reward/best@32/std:0.000 - val-aux/unknown/reward/worst@32/mean:-0.100 - val-aux/unknown/reward/worst@32/std:0.000 - val-aux/unknown/reward/best@64/mean:-0.100 - val-aux/unknown/reward/best@64/std:0.000 - val-aux/unknown/reward/worst@64/mean:-0.100 - val-aux/unknown/reward/worst@64/std:0.000 - val-aux/unknown/reward/best@128/mean:-0.100 - val-aux/unknown/reward/best@128/std:0.000 - val-aux/unknown/reward/worst@128/mean:-0.100 - val-aux/unknown/reward/worst@128/std:0.000 - val-aux/unknown/reward/best@256/mean:-0.100 - val-aux/unknown/reward/best@256/std:0.000 - val-aux/unknown/reward/worst@256/mean:-0.100 - val-aux/unknown/reward/worst@256/std:0.000 - val-core/unknown/reward/best@512/mean:-0.100 - val-aux/unknown/reward/worst@512/mean:-0.100 - critic/score/mean:-0.100 - critic/score/max:-0.100 - critic/score/min:-0.100 - critic/rewards/mean:-0.100 - critic/rewards/max:-0.100 - critic/rewards/min:-0.100 - critic/advantages/mean:-8.686 - critic/advantages/max:3.836 - critic/advantages/min:-13.541 - critic/returns/mean:-0.100 - critic/returns/max:-0.100 - critic/returns/min:-0.100 - critic/values/mean:-0.028 - critic/values/max:-0.000 - critic/values/min:-0.102 - critic/vf_explained_var:-144.282 - response_length/mean:318.016 - response_length/max:331.000 - response_length/min:253.000 - response_length/clip_ratio:0.008 - prompt_length/mean:0.008 - prompt_length/max:1.000 - prompt_length/min:0.000 - prompt_length/clip_ratio:0.008 - timing_s/gen:1.975 - timing_s/old_log_prob:4.821 - timing_s/ref:7.314 - timing_s/values:4.088 - timing_s/adv:0.021 - timing_s/update_critic:18.661 - timing_s/update_actor:20.840 - timing_s/testing:4.293 - timing_s/step:62.017 - timing_per_token_ms/ref:0.180 - timing_per_token_ms/update_actor:0.512 - timing_per_token_ms/values:0.100 - timing_per_token_ms/update_critic:0.458 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.049 - perf/total_num_tokens:40707.000 - perf/time_per_step:62.017 - perf/throughput:656.381 - timing_s/total:11549.013
[36m(TaskRunner pid=850907)[0m ("Final validation metrics: {'val-env/Bandit/success': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/Bandit/num_actions': 0.0, 'val-env/BanditTest/success': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-env/BanditTest/num_actions': 0.0, 'val-env/response_length': "
[36m(TaskRunner pid=850907)[0m  "95.3515625, 'val-core/unknown/reward/mean@512': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/std@512': 0.0, 'val-aux/unknown/reward/best@2/mean': "
[36m(TaskRunner pid=850907)[0m  "-0.10000000149011612, 'val-aux/unknown/reward/best@2/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@2/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@2/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@4/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@4/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@4/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@4/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@8/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@8/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@8/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@8/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@16/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@16/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@16/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@16/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@32/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@32/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@32/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@32/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@64/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@64/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@64/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@64/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@128/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@128/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@128/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@128/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@256/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/best@256/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@256/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@256/std': 0.0, "
[36m(TaskRunner pid=850907)[0m  "'val-core/unknown/reward/best@512/mean': -0.10000000149011612, "
[36m(TaskRunner pid=850907)[0m  "'val-aux/unknown/reward/worst@512/mean': -0.10000000149011612}")
